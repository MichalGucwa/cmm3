<!doctype html public "-//w3c//dtd html 3.2//en">
<html>
<head>
<title>dbCCP4i Tcl Client API Documentation</title>
<link rel="stylesheet" type="text/css" href="../../ccp4idocs.css" title="dbCCP4i" />
<meta name="GENERATOR" content="Mozilla/3.0Gold (X11; I; IRIX 6.2 IP22) [Netscape]" />
</head>
<body>
<H2>dbCCP4i  Tcl Client API Documentation</H2>
<H3>Contents</H3>

</dl><dl><dt><strong>Database Handler Client API (ClientAPI/dbClientAPI.tcl)</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Functions_for_applications_interacting_with_the_DB_server">Functions for applications interacting with the DB server</a></dt>
</dl><dl><dt><strong>Interacting With The Database Handler</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Interacting_With_The_Database_Handler">Interacting With The Database Handler</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbStartHandler"><strong>::dbClientAPI::DbStartHandler</a></strong>    Start a database handler, or connect to one already running</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbHandlerConnect"><strong>::dbClientAPI::DbHandlerConnect</a></strong>    Open socket and connect to (register with) database handler</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbHandlerDisconnect"><strong>::dbClientAPI::DbHandlerDisconnect</a></strong>    Disconnect socket from the database handler</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbHandlerPort"><strong>::dbClientAPI::DbHandlerPort</a></strong>    Return the port number that the handler is using</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbVerifyConnection"><strong>::dbClientAPI::DbVerifyConnection</a></strong>    Check whether the connection to the handler is active</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbInfo"><strong>::dbClientAPI::DbInfo</a></strong>    Get version and other info about the handler</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbSupported"><strong>::dbClientAPI::DbSupported</a></strong>    Check whether a particular database backend is supported</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbShutdown"><strong>::dbClientAPI::DbShutdown</a></strong>    Issue shutdown request to the handler</dd>
</dl><dl><dt><strong>Cache project and update cache</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Cache_project_and_update_cache">Cache project and update cache</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::cacheProject"><strong>::dbClientAPI::cacheProject</a></strong>    store project data in a database array</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::updateCachedJob"><strong>::dbClientAPI::updateCachedJob</a></strong>    update the database array</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::deleteCachedJob"><strong>::dbClientAPI::deleteCachedJob</a></strong>    delete a job in the database array</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::getCachedData"><strong>::dbClientAPI::getCachedData</a></strong>    get the data from cached project</dd>
</dl><dl><dt><strong>Projects and Directories</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Projects_and_Directories">Projects and Directories</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ListProjects"><strong>::dbClientAPI::ListProjects</a></strong>    Fetch a list of project names from the database handler</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetNProjects"><strong>::dbClientAPI::GetNProjects</a></strong>    Request the number of projects</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ListDataDirs"><strong>::dbClientAPI::ListDataDirs</a></strong>    Ask the database handler to list user's default directories</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DeleteProject"><strong>::dbClientAPI::DeleteProject</a></strong>    Ask the database handler to delete a project reference</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ImportProject"><strong>::dbClientAPI::ImportProject</a></strong>    Ask the database handler to add a reference to an existing project</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::AddDataDirRef"><strong>::dbClientAPI::AddDataDirRef</a></strong>    Ask the database handler to add default directory reference</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DeleteDataDirRef"><strong>::dbClientAPI::DeleteDataDirRef</a></strong>    Ask the database handler to delete default directory reference</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetProjectDir"><strong>::dbClientAPI::GetProjectDir</a></strong>    Ask the database handler to get a project's directory name</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetProjectDBDir"><strong>::dbClientAPI::GetProjectDBDir</a></strong>    Fetch the database directory for the specified project</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::IsProjectDir"><strong>::dbClientAPI::IsProjectDir</a></strong>    Fetch the project name that matches the supplied directory</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::IsDataDir"><strong>::dbClientAPI::IsDataDir</a></strong>    Fetch the data dir name that matches the supplied directory</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetDataDir"><strong>::dbClientAPI::GetDataDir</a></strong>    Ask the database handler to get the directory corresponding to a default directory name</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetDirectoriesData"><strong>::dbClientAPI::GetDirectoriesData</a></strong>    Fetch multiple directories data items in one request</dd>
</dl><dl><dt><strong>Creating, Opening and Closing Projects</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Creating__Opening_and_Closing_Projects">Creating, Opening and Closing Projects</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::OpenProject"><strong>::dbClientAPI::OpenProject</a></strong>    Ask the database handler to open a project database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::CreateProject"><strong>::dbClientAPI::CreateProject</a></strong>    Ask the database handler to create a project database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::CloseProject"><strong>::dbClientAPI::CloseProject</a></strong>    Close a currently open project database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ProjectWriteable"><strong>::dbClientAPI::ProjectWriteable</a></strong>    Check if is possible to write to the database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ProjectReadable"><strong>::dbClientAPI::ProjectReadable</a></strong>    Check if it is possible to read from the database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ReacquireProject"><strong>::dbClientAPI::ReacquireProject</a></strong>    Reload the job database to regain read and write access</dd>
</dl><dl><dt><strong>Job History</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Job_History">Job History</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetAllFileLinks"><strong>::dbClientAPI::GetAllFileLinks</a></strong>    Ask the database handler to get a project's history link between jobs</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetFileLinks"><strong>::dbClientAPI::GetFileLinks</a></strong>    Ask the database handler to get a project's history link between jobs</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetNextJobList"><strong>::dbClientAPI::GetNextJobList</a></strong>    Ask the database handler to a job's next job list of a given project</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetAllChildren"><strong>::dbClientAPI::GetAllChildren</a></strong>    Return all the jobs which are decendent of this job.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetChildren"><strong>::dbClientAPI::GetChildren</a></strong>    Return a job's next job list</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetAllParents"><strong>::dbClientAPI::GetAllParents</a></strong>    Return all the anscendent of a job.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetParents"><strong>::dbClientAPI::GetParents</a></strong>    Return a job's previous job list</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetAllParentsChildren"><strong>::dbClientAPI::GetAllParentsChildren</a></strong>    Return all the jobs that related to the given job.</dd>
</dl><dl><dt><strong>Requesting and Manipulating Job Data</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Requesting_and_Manipulating_Job_Data">Requesting and Manipulating Job Data</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetNJOB"><strong>::dbClientAPI::GetNJOB</a></strong>    Ask the database handler to get the NJOB of the database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ListJobs"><strong>::dbClientAPI::ListJobs</a></strong>    Request a list of job ids in a project, or subjobs in a job</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetDbItems"><strong>::dbClientAPI::GetDbItems</a></strong>    Ask the database handler to list items store in database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::NewJob"><strong>::dbClientAPI::NewJob</a></strong>    Create a new record in a CCP4i project database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DeleteJob"><strong>::dbClientAPI::DeleteJob</a></strong>    Delete a record (job) from a CCP4i project database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::Updatetime"><strong>::dbClientAPI::Updatetime</a></strong>    update a record(job) time.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ItemExists"><strong>::dbClientAPI::ItemExists</a></strong>    Test for the existence of a data item</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::SetData"><strong>::dbClientAPI::SetData</a></strong>    Set the values of one or more data items</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetData"><strong>::dbClientAPI::GetData</a></strong>    Return the values of one or more data items</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::SelectJobs"><strong>::dbClientAPI::SelectJobs</a></strong>    Return a list of jobs matching a regular expression</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetDescription"><strong>::dbClientAPI::GetDescription</a></strong>    Return a formatted list of jobs in report format</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetNotebook"><strong>::dbClientAPI::GetNotebook</a></strong>    Return notebook path </dd>
</dl><dl><dt><strong>Input and Output Files For Jobs</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Input_and_Output_Files_For_Jobs">Input and Output Files For Jobs</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::AddInputFile"><strong>::dbClientAPI::AddInputFile</a></strong>    Add a file to the list of input files for a job</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::AddOutputFile"><strong>::dbClientAPI::AddOutputFile</a></strong>    Add a file to the list of output files for a job</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetListofRecords"><strong>::dbClientAPI::GetListofRecords</a></strong>    Return a list of records</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetFileList"><strong>::dbClientAPI::GetFileList</a></strong>    Return a list of files associated with a job. type can be 'INPUT' or 'OUTPUT'</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ListInputFiles"><strong>::dbClientAPI::ListInputFiles</a></strong>    Return a list of input files for a given job.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ListOutputFiles"><strong>::dbClientAPI::ListOutputFiles</a></strong>    Return a list of output files for a given job.</dd>
</dl><dl><dt><strong>Storing and retrieving subjobs</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Storing_and_retrieving_subjobs">Storing and retrieving subjobs</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::AddSubJob"><strong>::dbClientAPI::AddSubJob</a></strong>    Add a subjob to an existing job in the project</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::SelectSubJobs"><strong>::dbClientAPI::SelectSubJobs</a></strong>    Return a list of jobs matching a regular expression.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::HasSubJobs"><strong>::dbClientAPI::HasSubJobs</a></strong>    Check if a job has sub jobs.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ListJobswithsubjobs"><strong>::dbClientAPI::ListJobswithsubjobs</a></strong>    Return a list of jobs which have subjobs</dd>
</dl><dl><dt><strong>Generic commands for interacting with a SQL Database for a particular project</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Generic_commands_for_interacting_with_a_SQL_Database_for_a_particular_project">Generic commands for interacting with a SQL Database for a particular project</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::NewTableRecord"><strong>::dbClientAPI::NewTableRecord</a></strong>    Insert a new record in a table</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DeleteTableRecord"><strong>::dbClientAPI::DeleteTableRecord</a></strong>    Insert a new record in a table</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DeleteTableRecords"><strong>::dbClientAPI::DeleteTableRecords</a></strong>    Insert a new record in a table</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::SetTableData"><strong>::dbClientAPI::SetTableData</a></strong>    Update a record in a table</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetTableData"><strong>::dbClientAPI::GetTableData</a></strong>    Get value of an attribute in a table</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetAllTableRecords"><strong>::dbClientAPI::GetAllTableRecords</a></strong>    Get value of an attribute in a table</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetTableRecords"><strong>::dbClientAPI::GetTableRecords</a></strong>    Get value of an attribute in a table</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetTablePrimaryKey"><strong>::dbClientAPI::GetTablePrimaryKey</a></strong>    Get the primary key of a record in a table</dd>
</dl><dl><dt><strong> commands for Knowledge base</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#commands_for_Knowledge_base"> commands for Knowledge base</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DefineDataset"><strong>::dbClientAPI::DefineDataset</a></strong>    Make a new dataset record with values set for each data item.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ListDatasets"><strong>::dbClientAPI::ListDatasets</a></strong>    Return a list of the DatasetNames in the knowledge base</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetDatasetId"><strong>::dbClientAPI::GetDatasetId</a></strong>    get the dataset id </dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DeleteDataset"><strong>::dbClientAPI::DeleteDataset</a></strong>    Remove a dataset </dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetDatasetAttribute"><strong>::dbClientAPI::GetDatasetAttribute</a></strong>    Return the value of a specified data item in the Dataset table for a particular dataset, or of the current HA substructure associated with the dataset.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetHAAttribute"><strong>::dbClientAPI::GetHAAttribute</a></strong>    Return the value of a specified data item in the HA table    </dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::NewHASubstructure"><strong>::dbClientAPI::NewHASubstructure</a></strong>    Defines a new HA substructure, with values set for each data item</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::ListDatasetHASubstructures"><strong>::dbClientAPI::ListDatasetHASubstructures</a></strong>    Return a list of the HA substructure ids associated with a particular dataset.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::UpdateHAForDataset"><strong>::dbClientAPI::UpdateHAForDataset</a></strong>    Update current HA for a specified dataset </dd>
</dl><dl><dt><strong>Interacting with an SQL Database for a particular project</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Interacting_with_an_SQL_Database_for_a_particular_project">Interacting with an SQL Database for a particular project</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::SetJobQuality"><strong>::dbClientAPI::SetJobQuality</a></strong>    Set Job quality data</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetJobQuality"><strong>::dbClientAPI::GetJobQuality</a></strong>    Get Job quality data</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::HasSQLdb"><strong>::dbClientAPI::HasSQLdb</a></strong>    Check if a project has an associated SQL database</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetAllSQLdbData"><strong>::dbClientAPI::GetAllSQLdbData</a></strong>    Get all data from sql db</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetSQLdbData"><strong>::dbClientAPI::GetSQLdbData</a></strong>    Get all data from sql db</dd>
</dl><dl><dt><strong>Interacting with a central SQL Database</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Interacting_with_a_central_SQL_Database">Interacting with a central SQL Database</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::OpenDBsql"><strong>::dbClientAPI::OpenDBsql</a></strong>    Set the values of one or more data items</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::SetJobDatasql"><strong>::dbClientAPI::SetJobDatasql</a></strong>    Set the values of one or more data items</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::NewProjectsql"><strong>::dbClientAPI::NewProjectsql</a></strong>    Set the values of one or more data items</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::NewJobsql"><strong>::dbClientAPI::NewJobsql</a></strong>    Set the values of one or more data items</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::GetJobDatasql"><strong>::dbClientAPI::GetJobDatasql</a></strong>    Set the values of one or more data items</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::CloseDBsql"><strong>::dbClientAPI::CloseDBsql</a></strong>    Set the values of one or more data items</dd>
</dl><dl><dt><strong>Client API Configuration</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Client_API_Configuration">Client API Configuration</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbGetTimeout"><strong>::dbClientAPI::DbGetTimeout</a></strong>    Returns the timeout used in db_handler_request</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::DbSetTimeout"><strong>::dbClientAPI::DbSetTimeout</a></strong>    Set the timeout used in db_handler_request</dd>
</dl><dl><dt><strong>Internal Procedures</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Internal_Procedures">Internal Procedures</a></dt>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::close_db_connection"><strong>::dbClientAPI::close_db_connection</a></strong>    Internal procedure</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::db_handler_request"><strong>::dbClientAPI::db_handler_request</a></strong>    Send a request to the database handler and return the response.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::db_handler_processResponse"><strong>::dbClientAPI::db_handler_processResponse</a></strong>    Handler for messages recieved from the database server.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::db_client_requestsPending"><strong>::dbClientAPI::db_client_requestsPending</a></strong>    Returns the number of pending requests within the client API</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::db_client_error"><strong>::dbClientAPI::db_client_error</a></strong>    Return the last error message from inside the client API</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::db_client_response_data"><strong>::dbClientAPI::db_client_response_data</a></strong>    Return the results from the last handler response.</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::db_get_handler_port"><strong>::dbClientAPI::db_get_handler_port</a></strong>    Return the port number for the active database handler process</dd>
<dd><a href="./dbClientAPI_tcl.html#::dbClientAPI::db_client_report"><strong>::dbClientAPI::db_client_report</a></strong>    Report an error or message from the API layer</dd>
</dl><dl><dt><strong>Handling dbCCP4i pseudo-XML (ClientAPI/dbxml.tcl)</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Internal_Commands_for_Wrapping___Unwrapping_pseudo-XML">Internal Commands for Wrapping & Unwrapping pseudo-XML</a></dt>
<dd><a href="./dbClientAPI_tcl.html#DbXMLSetDebug"><strong>DbXMLSetDebug</a></strong>    Query and optionally set the debug flag for DbXML</dd>
<dd><a href="./dbClientAPI_tcl.html#DbXMLVersion"><strong>DbXMLVersion</a></strong>     Returns the version of the XML functions</dd>
<dd><a href="./dbClientAPI_tcl.html#WrapDbRequest"><strong>WrapDbRequest</a></strong>    Wrap a db_request in pseudo-XML to send to the handler</dd>
<dd><a href="./dbClientAPI_tcl.html#UnwrapDbRequest"><strong>UnwrapDbRequest</a></strong>    Break a db_request pseudo-XML command into components</dd>
<dd><a href="./dbClientAPI_tcl.html#WrapDbResponse"><strong>WrapDbResponse</a></strong>    Wrap a db_response in pseudo-XML to send to the handler</dd>
<dd><a href="./dbClientAPI_tcl.html#UnwrapDbResponse"><strong>UnwrapDbResponse</a></strong>    Break a db_response pseudo-XML command into components</dd>
<dd><a href="./dbClientAPI_tcl.html#WrapDbBroadcast"><strong>WrapDbBroadcast</a></strong>    Wrap a broadcast message in pseudo-XML</dd>
<dd><a href="./dbClientAPI_tcl.html#UnwrapDbBroadcast"><strong>UnwrapDbBroadcast</a></strong>    Break a db_broadcast pseudo-XML message into components</dd>
<dd><a href="./dbClientAPI_tcl.html#EscapeXmlChars"><strong>EscapeXmlChars</a></strong>    Convert special XML characters to their escaped form</dd>
<dd><a href="./dbClientAPI_tcl.html#UnescapeXmlChars"><strong>UnescapeXmlChars</a></strong>    Convert escaped special XML characters to their original form</dd>
</dl><dl><dt><strong>CCP4i Functions (ClientAPI/ccp4ilite.tcl)</strong></dt>
<dt><a href="./dbClientAPI_tcl.html#Duplicates_of_CCP4i_functions_that_can_be_used_without_CCP4i">Duplicates of CCP4i functions that can be used without CCP4i</a></dt>
<dd><a href="./dbClientAPI_tcl.html#GetUserId"><strong>GetUserId</a></strong>    Return the user's id. </dd>
<dd><a href="./dbClientAPI_tcl.html#GetDotCCP4"><strong>GetDotCCP4</a></strong>    Return the location of the .CCP4 directory</dd>
<dd><a href="./dbClientAPI_tcl.html#GetOPSYS"><strong>GetOPSYS</a></strong>    Return the operating system type</dd>
<dd><a href="./dbClientAPI_tcl.html#GetEnvPath"><strong>GetEnvPath</a></strong>    Get operating system environment variable</dd>
<dd><a href="./dbClientAPI_tcl.html#WarningMessage"><strong>WarningMessage</a></strong>    Report a warning or display a message</dd>


<hr />
<h3>Database Handler Client API (ClientAPI/dbClientAPI.tcl)</h3>
<a name="Functions_for_applications_interacting_with_the_DB_server"><h3> Functions for applications interacting with the DB server </h3> 
<p>These are the commands that can be invoked by a client of the database server in order to communicate with it. The commands map onto the commands provided in the database server.<p>
<p>The commands are provided with a Tcl namespace called "dbClientAPI" in order to avoid potential name clashes with procedures that might be defined within the client application using the API. In order to use the client API functions, either:<p>
<p>1) specify the fully-qualified names e.g. ::dbClientAPI::DbStartHandler, or<p>
<p>2) use the "namespace import" command in order to make the API functions available without the leading ::dbClientAPI:: qualification - e.g. namespace import ::dbClientAPI::DbStartHandler will enable the client application to invoke "DbStartHandler" directly.<p>
<p>It is possible to use namespace import ::dbClientAPI::* in order to import all the procedures in the client API. However it is possible in this case that you may encounter a clash of names.<p>
<h3>Interacting With The Database Handler</h3>
<a name="Interacting_With_The_Database_Handler"><h3> Interacting With The Database Handler </h3> 
<p>These commands are for initiating, interrogating and stopping the database handler process, and for setting up a connection from the application to the process in order to add, fetch and manipulate the stored data.<p>
<a name="::dbClientAPI::DbStartHandler" ><h4><font color="#CC3333">::dbClientAPI::DbStartHandler</font> <em>Start a database handler, or connect to one already running</em></h4> 
<p><em>Argument list:  &lt;directories&gt; &lt;&gt;</em></p>
<p>This command opens a server socket and starts a new handler process in background. The handler process sends back a port number for the client application to use when connecting to the handler.<p>
<p>As this command is now called from within DbHandlerConnection it is not necessary to call it explicitly.<p>
<a name="::dbClientAPI::DbHandlerConnect" ><h4><font color="#CC3333">::dbClientAPI::DbHandlerConnect</font> <em>Open socket and connect to (register with) database handler</em></h4> 
<p><em>Argument list:  &lt;userAgent&gt; &lt;args&gt;</em></p>
<p>This command should only be invoked by the client application after DbStartHandler, which establishes the correct port number to use to communicate with the database server process.<p>
<p>It sets up a client socket with a callback procedure (db_handler_processResponse) which is invoked whenever the socket becomes readable (corresponding to data being sent from the handler). This command then connects to the handler, allowing the other database requests to be made via the appropriate API commands.<p>
<p>Optionally the calling process can specify its own callback procedure which will be invoked each time a broadcast message is received from the handler. The callback function must be defined in the application.<p>
<p>By default the connection is made to a handler process on the local machine, and a new handler will automatically be started if necessary. However a connection can also be made to an existing handler process on a remote machine, provided that the name of the machine and the port number are explicitly specified.<p>
<p>Return 1 on success and 0 on failure<p>
<p><strong>useragent</strong>  The application name which connects to the handler<p>
<p><strong>-broadcastHandler</strong><p>
<p>Name of a callback function that will be invoked whenever a broadcast message is received from the handler.<p>
<p><strong>-host</strong><p>
<p>The name of the host that the handler process is running on. If the host is not specified then localhost is assumed.<p>
<p><strong>-port</strong><p>
<p>The port number to connect to the handler on. If the host is not set, or is set to localhost, then the command will try to acquire the port number automatically. For remote machines the port number must be specified explicitly.<p>
<p><strong>-directories</strong><p>
<p>Name of a file containing the directories data which will be used instead of the default directories.def file.<p>
<a name="::dbClientAPI::DbHandlerDisconnect" ><h4><font color="#CC3333">::dbClientAPI::DbHandlerDisconnect</font> <em>Disconnect socket from the database handler</em></h4> 
<p><em>Argument list: None</em></p>
<a name="::dbClientAPI::DbHandlerPort" ><h4><font color="#CC3333">::dbClientAPI::DbHandlerPort</font> <em>Return the port number that the handler is using</em></h4> 
<p><em>Argument list:  &lt;args&gt;</em></p>
<p>This returns the port number, or -1 if a port number cannot be acquired.<p>
<p>It is a wrapper for db_get_handler_port and takes the same arguments as that command.<p>
<a name="::dbClientAPI::DbVerifyConnection" ><h4><font color="#CC3333">::dbClientAPI::DbVerifyConnection</font> <em>Check whether the connection to the handler is active</em></h4> 
<p><em>Argument list: None</em></p>
<p>Return 1 if the connection exists and is working, return 0 otherwise.<p>
<p>Wrapper for DbRequestStatus command in the handler.<p>
<a name="::dbClientAPI::DbInfo" ><h4><font color="#CC3333">::dbClientAPI::DbInfo</font> <em>Get version and other info about the handler</em></h4> 
<p><em>Argument list: None</em></p>
<p>This should return a list of key-value pairs as a simple list of strings.<p>
<p>e.g. "Version 1.3-dev" indicates the handler version number.<p>
<a name="::dbClientAPI::DbSupported" ><h4><font color="#CC3333">::dbClientAPI::DbSupported</font> <em>Check whether a particular database backend is supported</em></h4> 
<p><em>Argument list:  &lt;DB&gt;</em></p>
<p>For a particular database backend type, this function returns 1 if that backend is supported in the handler, and 0 if not.<p>
<p>The backends can be "def" and "SQLite".<p>
<p><strong>DB</strong>  The database backend type being checked for<p>
<a name="::dbClientAPI::DbShutdown" ><h4><font color="#CC3333">::dbClientAPI::DbShutdown</font> <em>Issue shutdown request to the handler</em></h4> 
<p><em>Argument list: None</em></p>
<h3>Cache project and update cache</h3>
<a name="Cache_project_and_update_cache"><h3> Cache project and update cache </h3> 
<p>These commands are used for cache a project, update the cache and get data from cache.<p>
<a name="::dbClientAPI::cacheProject" ><h4><font color="#CC3333">::dbClientAPI::cacheProject</font> <em>store project data in a database array</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<a name="::dbClientAPI::updateCachedJob" ><h4><font color="#CC3333">::dbClientAPI::updateCachedJob</font> <em>update the database array</em></h4> 
<p><em>Argument list:  &lt;id&gt;</em></p>
<a name="::dbClientAPI::deleteCachedJob" ><h4><font color="#CC3333">::dbClientAPI::deleteCachedJob</font> <em>delete a job in the database array</em></h4> 
<p><em>Argument list:  &lt;id&gt;</em></p>
<a name="::dbClientAPI::getCachedData" ><h4><font color="#CC3333">::dbClientAPI::getCachedData</font> <em>get the data from cached project</em></h4> 
<p><em>Argument list:  &lt;id&gt; &lt;item&gt;</em></p>
<h3>Projects and Directories</h3>
<a name="Projects_and_Directories"><h3> Projects and Directories </h3> 
<p>These are commands for requesting information about the available projects and default directories.<p>
<a name="::dbClientAPI::ListProjects" ><h4><font color="#CC3333">::dbClientAPI::ListProjects</font> <em>Fetch a list of project names from the database handler</em></h4> 
<p><em>Argument list: None</em></p>
<a name="::dbClientAPI::GetNProjects" ><h4><font color="#CC3333">::dbClientAPI::GetNProjects</font> <em>Request the number of projects</em></h4> 
<p><em>Argument list: None</em></p>
<p>This returns the number of projects currently defined in the user's database.<p>
<a name="::dbClientAPI::ListDataDirs" ><h4><font color="#CC3333">::dbClientAPI::ListDataDirs</font> <em>Ask the database handler to list user's default directories</em></h4> 
<p><em>Argument list: None</em></p>
<p>Returns a list of aliases for the user's data directories.<p>
<a name="::dbClientAPI::DeleteProject" ><h4><font color="#CC3333">::dbClientAPI::DeleteProject</font> <em>Ask the database handler to delete a project reference</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p>This removes the project reference from the user's database, but the project directory, files and job database are not removed. The project can be restored using the ImportProject command.<p>
<p><strong>project</strong>  Alias for the project being deleted<p>
<a name="::dbClientAPI::ImportProject" ><h4><font color="#CC3333">::dbClientAPI::ImportProject</font> <em>Ask the database handler to add a reference to an existing project</em></h4> 
<p><em>Argument list:  &lt;alias&gt; &lt;path&gt;</em></p>
<p>This adds a reference to the specified project to the user's database. The project directory and job database must already exist.<p>
<p><strong>Alias</strong>  the project being added<p>
<p><strong>path</strong>  the project directory<p>
<a name="::dbClientAPI::AddDataDirRef" ><h4><font color="#CC3333">::dbClientAPI::AddDataDirRef</font> <em>Ask the database handler to add default directory reference</em></h4> 
<p><em>Argument list:  &lt;def_dir&gt; &lt;path&gt;</em></p>
<p><strong>def_dir</strong>  the default directory name<p>
<p><strong>path</strong>  the full path of the default directory<p>
<a name="::dbClientAPI::DeleteDataDirRef" ><h4><font color="#CC3333">::dbClientAPI::DeleteDataDirRef</font> <em>Ask the database handler to delete default directory reference</em></h4> 
<p><em>Argument list:  &lt;def_dir&gt;</em></p>
<p><strong>def_dir</strong>  the default directory name<p>
<a name="::dbClientAPI::GetProjectDir" ><h4><font color="#CC3333">::dbClientAPI::GetProjectDir</font> <em>Ask the database handler to get a project's directory name</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p><strong>project</strong>  Alias for the project which the directory contains<p>
<a name="::dbClientAPI::GetProjectDBDir" ><h4><font color="#CC3333">::dbClientAPI::GetProjectDBDir</font> <em>Fetch the database directory for the specified project</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p><strong>project</strong>  Alias for the project which the directory contains<p>
<a name="::dbClientAPI::IsProjectDir" ><h4><font color="#CC3333">::dbClientAPI::IsProjectDir</font> <em>Fetch the project name that matches the supplied directory</em></h4> 
<p><em>Argument list:  &lt;dirn&gt;</em></p>
<p>Return the name of the project for which the supplied directory path corresponds to the project directory, or an empty string if no match is found.<p>
<p><strong>dirn</strong>  Path to the directory that is being looked up<p>
<a name="::dbClientAPI::IsDataDir" ><h4><font color="#CC3333">::dbClientAPI::IsDataDir</font> <em>Fetch the data dir name that matches the supplied directory</em></h4> 
<p><em>Argument list:  &lt;dirn&gt;</em></p>
<p>Return the name of the data dir for which the supplied directory path corresponds to the data directory, or an empty string if no match is found.<p>
<p><strong>dirn</strong>  Path to the directory that is being looked up<p>
<a name="::dbClientAPI::GetDataDir" ><h4><font color="#CC3333">::dbClientAPI::GetDataDir</font> <em>Ask the database handler to get the directory corresponding to a default directory name</em></h4> 
<p><em>Argument list:  &lt;def_dir&gt;</em></p>
<p><strong>def_dir</strong>  the default directory name<p>
<a name="::dbClientAPI::GetDirectoriesData" ><h4><font color="#CC3333">::dbClientAPI::GetDirectoriesData</font> <em>Fetch multiple directories data items in one request</em></h4> 
<p><em>Argument list:  &lt;args&gt;</em></p>
<p>This command allows the client to retrieve many data items related to several different projects and data dirs in one call.<p>
<p>The syntax is GetDirectoriesData keyword alias [keyword alias ...]<p>
<p>Each pair of arguments consists of a project or data dir alias name following a keyword indicating the data that is to be fetched:<p>
<p>ProjectDir: the path to the directory corresponding to the alias, if it's a project<p>
<p>ProjectDBDir: the path to the database directory for the project<p>
<p>DataDir: the path to the directory corresponding to the alias if it's a data dir<p>
<p>Returns a list with one item resulting from each alias-keyword pair that was supplied.<p>
<p><strong>alias</strong><p>
<p>The name of a project or defdir<p>
<p><strong>keyword</strong><p>
<p>A keyword to indicate the data to retrieve (see above)<p>
<h3>Creating, Opening and Closing Projects</h3>
<a name="Creating__Opening_and_Closing_Projects"><h3> Creating, Opening and Closing Projects </h3> 
<p>These functions allow project databases to be created, opened for reading and writing, and closed again.<p>
<a name="::dbClientAPI::OpenProject" ><h4><font color="#CC3333">::dbClientAPI::OpenProject</font> <em>Ask the database handler to open a project database</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;args&gt;</em></p>
<p>If the first argument doesn't start with a hyphen then it's assumed to be the name of a variable in the calling procedure in which to report any message returned from the handler. All other options must come after this and must start with a hyphen.<p>
<p>Return 1 on success and 0 on failure.<p>
<p><strong>project</strong>  Alias for the project being opened<p>
<a name="::dbClientAPI::CreateProject" ><h4><font color="#CC3333">::dbClientAPI::CreateProject</font> <em>Ask the database handler to create a project database</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;db&gt; &lt;messageVar&gt; &lt;args&gt;</em></p>
<p><strong>project</strong>  Alias for the project being created<p>
<p><strong>db</strong>  The full directory path of the project database<p>
<p><strong>messageVar</strong>  Name of a variable to return any messages in<p>
<a name="::dbClientAPI::CloseProject" ><h4><font color="#CC3333">::dbClientAPI::CloseProject</font> <em>Close a currently open project database</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p>The client must previously have opened the project using the OpenProject command, otherwise an error will be returned.<p>
<p><strong>project</strong>  Alias for the project being closed<p>
<a name="::dbClientAPI::ProjectWriteable" ><h4><font color="#CC3333">::dbClientAPI::ProjectWriteable</font> <em>Check if is possible to write to the database</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p>Return 1 if the connection has write access to the job database for the project, zero otherwise.<p>
<p>-1 is returned in the event of an error.<p>
<p><strong>project</strong>  Name of the project<p>
<a name="::dbClientAPI::ProjectReadable" ><h4><font color="#CC3333">::dbClientAPI::ProjectReadable</font> <em>Check if it is possible to read from the database</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p>Return 1 if the connection has read access to the job database for the project, zero otherwise.<p>
<p>-1 is returned in the event of an error.<p>
<p><strong>project</strong>  Name of the project<p>
<a name="::dbClientAPI::ReacquireProject" ><h4><font color="#CC3333">::dbClientAPI::ReacquireProject</font> <em>Reload the job database to regain read and write access</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p>This command forces the handler to reacquire the lock on the job database for the specified project. This is useful in the case that the handler has lost write access to the project.<p>
<p>Return 1 if the reacquisition was successful, 0 in the case of failure, and -1 if there was an error.<p>
<p><strong>project</strong>  Name of the project<p>
<h3>Job History</h3>
<a name="Job_History"><h3> Job History </h3> 
<p>These are commands for requesting information about the links between the jobs in a project.<p>
<a name="::dbClientAPI::GetAllFileLinks" ><h4><font color="#CC3333">::dbClientAPI::GetAllFileLinks</font> <em>Ask the database handler to get a project's history link between jobs</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<a name="::dbClientAPI::GetFileLinks" ><h4><font color="#CC3333">::dbClientAPI::GetFileLinks</font> <em>Ask the database handler to get a project's history link between jobs</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobs&gt;</em></p>
<a name="::dbClientAPI::GetNextJobList" ><h4><font color="#CC3333">::dbClientAPI::GetNextJobList</font> <em>Ask the database handler to a job's next job list of a given project</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<a name="::dbClientAPI::GetAllChildren" ><h4><font color="#CC3333">::dbClientAPI::GetAllChildren</font> <em>Return all the jobs which are decendent of this job.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<a name="::dbClientAPI::GetChildren" ><h4><font color="#CC3333">::dbClientAPI::GetChildren</font> <em>Return a job's next job list</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<a name="::dbClientAPI::GetAllParents" ><h4><font color="#CC3333">::dbClientAPI::GetAllParents</font> <em>Return all the anscendent of a job.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<a name="::dbClientAPI::GetParents" ><h4><font color="#CC3333">::dbClientAPI::GetParents</font> <em>Return a job's previous job list</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<a name="::dbClientAPI::GetAllParentsChildren" ><h4><font color="#CC3333">::dbClientAPI::GetAllParentsChildren</font> <em>Return all the jobs that related to the given job.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<h3>Requesting and Manipulating Job Data</h3>
<a name="Requesting_and_Manipulating_Job_Data"><h3> Requesting and Manipulating Job Data </h3> 
<p>These commands provide functions for creating and deleting job records, and for setting and fetching data associated with the jobs.<p>
<a name="::dbClientAPI::GetNJOB" ><h4><font color="#CC3333">::dbClientAPI::GetNJOB</font> <em>Ask the database handler to get the NJOB of the database</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<a name="::dbClientAPI::ListJobs" ><h4><font color="#CC3333">::dbClientAPI::ListJobs</font> <em>Request a list of job ids in a project, or subjobs in a job</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt; &lt;&gt;</em></p>
<p>ListJobs invoked with just a project name returns a list of all "top-level" job ids in that project. If a job id is also specified then a list of the subjob ids associated with that job is returned instead.<p>
<p><strong>project</strong>  Name of the project<p>
<p><strong>jobid</strong>  (Optional) Job id for which subjobs should be returned<p>
<a name="::dbClientAPI::GetDbItems" ><h4><font color="#CC3333">::dbClientAPI::GetDbItems</font> <em>Ask the database handler to list items store in database</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<a name="::dbClientAPI::NewJob" ><h4><font color="#CC3333">::dbClientAPI::NewJob</font> <em>Create a new record in a CCP4i project database</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p>Creates a new job in the specified job database and returns the job id.<p>
<p><strong>project</strong>  Alias for the project in which the job is being created<p>
<a name="::dbClientAPI::DeleteJob" ><h4><font color="#CC3333">::dbClientAPI::DeleteJob</font> <em>Delete a record (job) from a CCP4i project database</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;job_id&gt;</em></p>
<p>Removes the specified job id and associated data from the specified project database.<p>
<p><strong>project</strong>  Alias for the project from which the job is being removed<p>
<p><strong>job_id</strong>  Number of the job being removed<p>
<a name="::dbClientAPI::Updatetime" ><h4><font color="#CC3333">::dbClientAPI::Updatetime</font> <em>update a record(job) time.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;job_id&gt;</em></p>
<p><strong>project</strong>  project name<p>
<a name="::dbClientAPI::ItemExists" ><h4><font color="#CC3333">::dbClientAPI::ItemExists</font> <em>Test for the existence of a data item</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;job_id&gt; &lt;item&gt;</em></p>
<p>Returns 1 if the specified data item exists for the named job and project database, and 0 if not.<p>
<p><strong>project</strong>  Alias of the project<p>
<p><strong>job_id</strong>  Number of the job being interrogated<p>
<p><strong>item</strong>  Name of the data item being queried<p>
<a name="::dbClientAPI::SetData" ><h4><font color="#CC3333">::dbClientAPI::SetData</font> <em>Set the values of one or more data items</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;job_id&gt; &lt;args&gt;</em></p>
<p>This sets the values of multiple data items for a particular job in the specified project database. The argument list should consist of key-value pairs.<p>
<p>Setting multiple data items in a single SetData command is recommended as this minimises the number of socket transactions required to send the data to the server.<p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>job_id</strong>  Number of the job for which the data is being set<p>
<p><strong>item1</strong>  Item name to set the value of<p>
<p><strong>value1</strong>  Corresponding value to set item1 to be<p>
<a name="::dbClientAPI::GetData" ><h4><font color="#CC3333">::dbClientAPI::GetData</font> <em>Return the values of one or more data items</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;job_id&gt; &lt;args&gt;</em></p>
<p>This returns the values of multiple data items for a particular job in the specified project database. The argument list should consist of keys. A list of the corresponding values will be returned.<p>
<p>Retrieving multiple data items in a single GetData command is recommended as this minimises the number of socket transactions required to fetch the data from the server.<p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>job_id</strong>  Number of the job for which the data is being fetched<p>
<p><strong>item1</strong>  Item name to get the value of<p>
<a name="::dbClientAPI::SelectJobs" ><h4><font color="#CC3333">::dbClientAPI::SelectJobs</font> <em>Return a list of jobs matching a regular expression</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;item&gt; &lt;pattern&gt;</em></p>
<p>This command returns a list of job numbers where the values of the specified item matches the supplied regular expression pattern.<p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>item</strong>  Item name being searched on<p>
<p><strong>pattern</strong>  Regular expression pattern to search on<p>
<a name="::dbClientAPI::GetDescription" ><h4><font color="#CC3333">::dbClientAPI::GetDescription</font> <em>Return a formatted list of jobs in report format</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;job_list&gt; &lt;db_display&gt; &lt;db_display_format&gt;</em></p>
<p>This command takes a list of job numbers, a list of item names and a format description, and returns a report as a Tcl list with one job description (generated according to the lists of items and formats) per item.<p>
<p>This can be used to append all database information into one string for display.<p>
<p><strong>project</strong>  The alias for the project to access<p>
<p><strong>job_list</strong>  List of job ids<p>
<p><strong>db_display</strong>  A list of the database parameters to be displayed<p>
<p><strong>db_display_format</strong>  A list of the field widths (as integers) to use for displaying the items in the db_display list.<p>
<a name="::dbClientAPI::GetNotebook" ><h4><font color="#CC3333">::dbClientAPI::GetNotebook</font> <em>Return notebook path </em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<h3>Input and Output Files For Jobs</h3>
<a name="Input_and_Output_Files_For_Jobs"><h3> Input and Output Files For Jobs </h3> 
<p>Commands for adding, listing and removing references to the input and output files for jobs.<p>
<a name="::dbClientAPI::AddInputFile" ><h4><font color="#CC3333">::dbClientAPI::AddInputFile</font> <em>Add a file to the list of input files for a job</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;job_id&gt; &lt;filen&gt; &lt;alias&gt; &lt;&gt;</em></p>
<p>This command wraps the AddFile command.<p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>job_id</strong>  Number of the job for which the data is being updated<p>
<p><strong>filen</strong>  Name of the file to add<p>
<p><strong>alias</strong>  (optional) Name of a project alias to associate with the file<p>
<a name="::dbClientAPI::AddOutputFile" ><h4><font color="#CC3333">::dbClientAPI::AddOutputFile</font> <em>Add a file to the list of output files for a job</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;job_id&gt; &lt;filen&gt; &lt;alias&gt; &lt;&gt;</em></p>
<p>This command wraps the AddFile command.<p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>job_id</strong>  Number of the job for which the data is being updated<p>
<p><strong>filen</strong>  Name of the file to add<p>
<p><strong>alias</strong>  (optional) Name of a project alias to associate with the file<p>
<a name="::dbClientAPI::GetListofRecords" ><h4><font color="#CC3333">::dbClientAPI::GetListofRecords</font> <em>Return a list of records</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;joblist&gt; &lt;itemlist&gt;</em></p>
<p>This returns the values of multiple data items for a list of given jobs in the specified project database. The argument list should consist of keys. A list of the corresponding values will be returned.<p>
<p>Retrieving multiple data items of multiple jobs in a single GetData command is recommended as this minimises the number of socket transactions required to fetch the data from the server.<p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>job_id</strong>  Number of the job for which the data is being fetched<p>
<p><strong>item1</strong>  Item name to get the value of<p>
<a name="::dbClientAPI::GetFileList" ><h4><font color="#CC3333">::dbClientAPI::GetFileList</font> <em>Return a list of files associated with a job. type can be 'INPUT' or 'OUTPUT'</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt; &lt;type&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>jobid</strong>  Number of the job<p>
<p><strong>type</strong>  'INPUT' or 'OUTPUT'<p>
<a name="::dbClientAPI::ListInputFiles" ><h4><font color="#CC3333">::dbClientAPI::ListInputFiles</font> <em>Return a list of input files for a given job.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>jobid</strong>  Number of the job<p>
<a name="::dbClientAPI::ListOutputFiles" ><h4><font color="#CC3333">::dbClientAPI::ListOutputFiles</font> <em>Return a list of output files for a given job.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>jobid</strong>  Number of the job<p>
<h3>Storing and retrieving subjobs</h3>
<a name="Storing_and_retrieving_subjobs"><h3> Storing and retrieving subjobs </h3> 
<p>These commands dealing with subjobs<p>
<a name="::dbClientAPI::AddSubJob" ><h4><font color="#CC3333">::dbClientAPI::AddSubJob</font> <em>Add a subjob to an existing job in the project</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt; &lt;taskname&gt; &lt;title&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>jobid</strong>  Number of the parent job<p>
<p><strong>taskname</strong>  Name of the task or application associated with the job<p>
<p><strong>title</strong>  User-readable title<p>
<a name="::dbClientAPI::SelectSubJobs" ><h4><font color="#CC3333">::dbClientAPI::SelectSubJobs</font> <em>Return a list of jobs matching a regular expression.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt; &lt;item&gt; &lt;pattern&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>jobid</strong>  Number of the job<p>
<p><strong>item</strong>  Item name being searched on<p>
<p><strong>pattern</strong>  Regular expression pattern to search on<p>
<a name="::dbClientAPI::HasSubJobs" ><h4><font color="#CC3333">::dbClientAPI::HasSubJobs</font> <em>Check if a job has sub jobs.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<p>This command returns 1 if the specified job has an associated subjob database, and 0 if there are no subjobs or if an error occurred.<p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>jobid</strong>  Number of the job<p>
<a name="::dbClientAPI::ListJobswithsubjobs" ><h4><font color="#CC3333">::dbClientAPI::ListJobswithsubjobs</font> <em>Return a list of jobs which have subjobs</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<h3>Generic commands for interacting with a SQL Database for a particular project</h3>
<a name="Generic_commands_for_interacting_with_a_SQL_Database_for_a_particular_project"><h3> Generic commands for interacting with a SQL Database for a particular project </h3> 
<p>These commands allow interactions with the SQLite database backend which stores knowledge base data.<p>
<a name="::dbClientAPI::NewTableRecord" ><h4><font color="#CC3333">::dbClientAPI::NewTableRecord</font> <em>Insert a new record in a table</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;table&gt; &lt;args&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>table</strong>  table name<p>
<p><strong>args</strong>  attribute-value pairs of the table<p>
<a name="::dbClientAPI::DeleteTableRecord" ><h4><font color="#CC3333">::dbClientAPI::DeleteTableRecord</font> <em>Insert a new record in a table</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;table&gt; &lt;recordid&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>table</strong>  table name<p>
<p><strong>args</strong>  attribute-value pairs of the table<p>
<a name="::dbClientAPI::DeleteTableRecords" ><h4><font color="#CC3333">::dbClientAPI::DeleteTableRecords</font> <em>Insert a new record in a table</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;table&gt; &lt;condition&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>table</strong>  table name<p>
<p><strong>args</strong>  attribute-value pairs of the table<p>
<a name="::dbClientAPI::SetTableData" ><h4><font color="#CC3333">::dbClientAPI::SetTableData</font> <em>Update a record in a table</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;table&gt; &lt;tableid&gt; &lt;attribute&gt; &lt;value&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>table</strong>  table name<p>
<p><strong>tableid</strong>  the id of the record in the table<p>
<p><strong>attribute</strong>  the attribute of the value<p>
<p><strong>value</strong>  <p>
<a name="::dbClientAPI::GetTableData" ><h4><font color="#CC3333">::dbClientAPI::GetTableData</font> <em>Get value of an attribute in a table</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;table&gt; &lt;tableid&gt; &lt;attribute&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>table</strong>  table name<p>
<p><strong>tableid</strong>  the id of the record in the table<p>
<p><strong>attribute</strong>  the attribute of the value<p>
<a name="::dbClientAPI::GetAllTableRecords" ><h4><font color="#CC3333">::dbClientAPI::GetAllTableRecords</font> <em>Get value of an attribute in a table</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;table&gt; &lt;attributes&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>table</strong>  table name<p>
<p><strong>attributes</strong>  list of attributes<p>
<a name="::dbClientAPI::GetTableRecords" ><h4><font color="#CC3333">::dbClientAPI::GetTableRecords</font> <em>Get value of an attribute in a table</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;table&gt; &lt;attributes&gt; &lt;condition&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>table</strong>  table name<p>
<p><strong>attributes</strong>  list of attributes<p>
<a name="::dbClientAPI::GetTablePrimaryKey" ><h4><font color="#CC3333">::dbClientAPI::GetTablePrimaryKey</font> <em>Get the primary key of a record in a table</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;table&gt; &lt;condition&gt;</em></p>
<p><strong>table</strong>  table name<p>
<p><strong>condition</strong>  the where clause of SQL<p>
<h3> commands for Knowledge base</h3>
<a name="commands_for_Knowledge_base"><h3>  commands for Knowledge base </h3> 
<p>These commands allow interactions with Knowledge base table backend which stores knowledge base data.<p>
<a name="::dbClientAPI::DefineDataset" ><h4><font color="#CC3333">::dbClientAPI::DefineDataset</font> <em>Make a new dataset record with values set for each data item.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;DatasetName&gt; &lt;MTZfile&gt; &lt;Fmean&gt; &lt;SigFmean&gt; &lt;args&gt;</em></p>
<p><strong>project</strong>  project alias<p>
<p><strong>DatasetName</strong>  An identifier for the dataset<p>
<p><strong>MTZfile</strong>  The name of the source MTZ file that holds the reflection data for the dataset<p>
<p><strong>Fmean</strong>  MTZ column label indicates the column that holds the mean structure factors<p>
<p><strong>SigFmean</strong>  MTZ column label indicates the column with sigmas corresponding to the Fmean values<p>
<a name="::dbClientAPI::ListDatasets" ><h4><font color="#CC3333">::dbClientAPI::ListDatasets</font> <em>Return a list of the DatasetNames in the knowledge base</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p><strong>project</strong>  alias of the project<p>
<a name="::dbClientAPI::GetDatasetId" ><h4><font color="#CC3333">::dbClientAPI::GetDatasetId</font> <em>get the dataset id </em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;DatasetName&gt;</em></p>
<p><strong>project</strong>  alias of project<p>
<p><strong>DatasetName</strong>  <p>
<a name="::dbClientAPI::DeleteDataset" ><h4><font color="#CC3333">::dbClientAPI::DeleteDataset</font> <em>Remove a dataset </em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;DatasetName&gt;</em></p>
<p><strong>project</strong>  alias of the project<p>
<p><strong>DatasetName</strong>  <p>
<a name="::dbClientAPI::GetDatasetAttribute" ><h4><font color="#CC3333">::dbClientAPI::GetDatasetAttribute</font> <em>Return the value of a specified data item in the Dataset table for a particular dataset, or of the current HA substructure associated with the dataset.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;DatasetName&gt; &lt;itemName&gt;</em></p>
<p><strong>project</strong>  alias of the project<p>
<p><strong>DatasetName</strong>  <p>
<p><strong>itemName</strong>  attribute of Dataset table<p>
<a name="::dbClientAPI::GetHAAttribute" ><h4><font color="#CC3333">::dbClientAPI::GetHAAttribute</font> <em>Return the value of a specified data item in the HA table    </em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;HAid&gt; &lt;itemName&gt;</em></p>
<p><strong>project</strong>  alias of project<p>
<p><strong>HAid</strong>  record id in HA table<p>
<p><strong>itemName</strong>  attribute of HA table<p>
<a name="::dbClientAPI::NewHASubstructure" ><h4><font color="#CC3333">::dbClientAPI::NewHASubstructure</font> <em>Defines a new HA substructure, with values set for each data item</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;HAfile&gt; &lt;DatasetName&gt; &lt;args&gt;</em></p>
<p><strong>HAfile</strong>  name of the file containing the data for the current heavy atom substructure in CCP4i's .ha format.<p>
<p><strong>DatasetName</strong>  <p>
<p><strong></strong>  <p>
<a name="::dbClientAPI::ListDatasetHASubstructures" ><h4><font color="#CC3333">::dbClientAPI::ListDatasetHASubstructures</font> <em>Return a list of the HA substructure ids associated with a particular dataset.</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;DatasetName&gt;</em></p>
<p><strong>project</strong>  alias of the project<p>
<p><strong>DatasetName</strong>  <p>
<a name="::dbClientAPI::UpdateHAForDataset" ><h4><font color="#CC3333">::dbClientAPI::UpdateHAForDataset</font> <em>Update current HA for a specified dataset </em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;DatasetName&gt; &lt;HAid&gt;</em></p>
<p><strong>project</strong>  alias of the project<p>
<p><strong>DatasetName</strong>  <p>
<p><strong>HAid</strong>  <p>
<h3>Interacting with an SQL Database for a particular project</h3>
<a name="Interacting_with_an_SQL_Database_for_a_particular_project"><h3> Interacting with an SQL Database for a particular project </h3> 
<p>These commands allow interactions with the SQLite database backend which store addional job data.<p>
<a name="::dbClientAPI::SetJobQuality" ><h4><font color="#CC3333">::dbClientAPI::SetJobQuality</font> <em>Set Job quality data</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt; &lt;quality&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>jobid</strong>  Number of the job<p>
<p><strong>quality</strong>  the value could be 1, 0 or -1 which indicates good, marginal and bad.<p>
<a name="::dbClientAPI::GetJobQuality" ><h4><font color="#CC3333">::dbClientAPI::GetJobQuality</font> <em>Get Job quality data</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>jobid</strong>  Number of the job<p>
<a name="::dbClientAPI::HasSQLdb" ><h4><font color="#CC3333">::dbClientAPI::HasSQLdb</font> <em>Check if a project has an associated SQL database</em></h4> 
<p><em>Argument list:  &lt;project&gt;</em></p>
<p>Query whether there is an SQLite database associated with the named project. Returns 1 if there is an associated SQLite db, and zero otherwise. Zero is also returned in the event that the request failed for some other reason (e.g. the project hasn't been opened yet).<p>
<p><strong>project</strong>  Alias of the project database<p>
<a name="::dbClientAPI::GetAllSQLdbData" ><h4><font color="#CC3333">::dbClientAPI::GetAllSQLdbData</font> <em>Get all data from sql db</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;itemlist&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>itemlist</strong>  the attributes of tables<p>
<a name="::dbClientAPI::GetSQLdbData" ><h4><font color="#CC3333">::dbClientAPI::GetSQLdbData</font> <em>Get all data from sql db</em></h4> 
<p><em>Argument list:  &lt;project&gt; &lt;jobid&gt; &lt;items&gt;</em></p>
<p><strong>project</strong>  Alias of the project database<p>
<p><strong>jobid</strong>  Number of the job<p>
<p><strong>items</strong>  item for the job<p>
<h3>Interacting with a central SQL Database</h3>
<a name="Interacting_with_a_central_SQL_Database"><h3> Interacting with a central SQL Database </h3> 
<p>These commands allow interactions with the SQLite database backend.<p>
<a name="::dbClientAPI::OpenDBsql" ><h4><font color="#CC3333">::dbClientAPI::OpenDBsql</font> <em>Set the values of one or more data items</em></h4> 
<p><em>Argument list:  &lt;dbname&gt; &lt;dir&gt;</em></p>
<p>This sets the values of multiple data items for a particular job in the specified project database. The argument list should consist of key-value pairs.<p>
<p>Setting multiple data items in a single SetData command is recommended as this minimises the number of socket transactions required to send the data to the serve<p>
<p><strong>job_id</strong>  Number of the job for which the data is being s<p>
<a name="::dbClientAPI::SetJobDatasql" ><h4><font color="#CC3333">::dbClientAPI::SetJobDatasql</font> <em>Set the values of one or more data items</em></h4> 
<p><em>Argument list:  &lt;job_id&gt; &lt;args&gt;</em></p>
<p>This sets the values of multiple data items for a particular job in the specified project database. The argument list should consist of key-value pairs.<p>
<p>Setting multiple data items in a single SetData command is recommended as this minimises the number of socket transactions required to send the data to the serve<p>
<p><strong>job_id</strong>  Number of the job for which the data is being s<p>
<a name="::dbClientAPI::NewProjectsql" ><h4><font color="#CC3333">::dbClientAPI::NewProjectsql</font> <em>Set the values of one or more data items</em></h4> 
<p><em>Argument list:  &lt;projectname&gt;</em></p>
<p>This sets the values of multiple data items for a particular job in the specified project database. The argument list should consist of key-value pairs.<p>
<p>Setting multiple data items in a single SetData command is recommended as this minimises the number of socket transactions required to send the data to the server.<p>
<p><strong>dbname</strong>  Alias of the project database<p>
<p><strong>dir</strong>  Number of the job for which the data is being set<p>
<a name="::dbClientAPI::NewJobsql" ><h4><font color="#CC3333">::dbClientAPI::NewJobsql</font> <em>Set the values of one or more data items</em></h4> 
<p><em>Argument list:  &lt;projectname&gt;</em></p>
<p>This sets the values of multiple data items for a particular job in the specified project database. The argument list should consist of key-value pairs.<p>
<p>Setting multiple data items in a single SetData command is recommended as this minimises the number of socket transactions required to send the data to the server.<p>
<p><strong>dbname</strong>  Alias of the project database<p>
<p><strong>dir</strong>  Number of the job for which the data is being set<p>
<a name="::dbClientAPI::GetJobDatasql" ><h4><font color="#CC3333">::dbClientAPI::GetJobDatasql</font> <em>Set the values of one or more data items</em></h4> 
<p><em>Argument list:  &lt;jobid&gt; &lt;args&gt;</em></p>
<p>This sets the values of multiple data items for a particular job in the specified project database. The argument list should consist of key-value pairs.<p>
<p>Setting multiple data items in a single SetData command is recommended as this minimises the number of socket transactions required to send the data to the server.<p>
<p><strong>dbname</strong>  Alias of the project database<p>
<p><strong>dir</strong>  Number of the job for which the data is being set<p>
<a name="::dbClientAPI::CloseDBsql" ><h4><font color="#CC3333">::dbClientAPI::CloseDBsql</font> <em>Set the values of one or more data items</em></h4> 
<p><em>Argument list: None</em></p>
<p>This sets the values of multiple data items for a particular job in the specified project database. The argument list should consist of key-value pairs.<p>
<p>Setting multiple data items in a single SetData command is recommended as this minimises the number of socket transactions required to send the data to the server.<p>
<p><strong>dbname</strong>  Alias of the project database<p>
<p><strong>dir</strong>  Number of the job for which the data is being set<p>
<h3>Client API Configuration</h3>
<a name="Client_API_Configuration"><h3> Client API Configuration </h3> 
<p>These are commands for configuring attributes of the client API.<p>
<a name="::dbClientAPI::DbGetTimeout" ><h4><font color="#CC3333">::dbClientAPI::DbGetTimeout</font> <em>Returns the timeout used in db_handler_request</em></h4> 
<p><em>Argument list: None</em></p>
<p>The timeout is the length of time that the client API will wait after sending a request to the handler, before giving up and returning control to the client application.<p>
<p>The timeout is a number of milliseconds, with a minimum value of zero.<p>
<a name="::dbClientAPI::DbSetTimeout" ><h4><font color="#CC3333">::dbClientAPI::DbSetTimeout</font> <em>Set the timeout used in db_handler_request</em></h4> 
<p><em>Argument list:  &lt;timeout&gt;</em></p>
<p><strong>timeout</strong>  Length of the timeout in milliseconds<p>
<h3>Internal Procedures</h3>
<a name="Internal_Procedures"><h3> Internal Procedures </h3> 
<p>Functions used internally to the client API.<p>
<a name="::dbClientAPI::close_db_connection" ><h4><font color="#CC3333">::dbClientAPI::close_db_connection</font> <em>Internal procedure</em></h4> 
<p><em>Argument list: None</em></p>
<p>Remove socket connection and reset internal parameters<p>
<a name="::dbClientAPI::db_handler_request" ><h4><font color="#CC3333">::dbClientAPI::db_handler_request</font> <em>Send a request to the database handler and return the response.</em></h4> 
<p><em>Argument list:  &lt;messageVar&gt; &lt;command&gt; &lt;args&gt;</em></p>
<p>The request consists of the all arguments in args, excluding the After the request is sent to the handler this procedure waits until a response is recieved i.e. it operates in a pseudo-synchronous manner.<p>
<p>Responses from the handler consist of Tcl lists - the first element in the list is the return value of this procedure, the remainder is returned in the variable named by the last argument in args.<p>
<p>In case of failure, ERROR will be returned.<p>
<p><strong>messageVar</strong>  Name of variable used to return output to the calling procedure<p>
<p><strong>command</strong>  Command to be sent to the handler<p>
<a name="::dbClientAPI::db_handler_processResponse" ><h4><font color="#CC3333">::dbClientAPI::db_handler_processResponse</font> <em>Handler for messages recieved from the database server.</em></h4> 
<p><em>Argument list:  &lt;client&gt;</em></p>
<p>This processes messages recieved from the handler process via the socket connection. Messages should fall into two catergories, either: 1. responses to requests sent via db_handler_request, or 2. unsolicited "broadcast" messages from the handler.<p>
<p><strong>client</strong>  Socket id<p>
<a name="::dbClientAPI::db_client_requestsPending" ><h4><font color="#CC3333">::dbClientAPI::db_client_requestsPending</font> <em>Returns the number of pending requests within the client API</em></h4> 
<p><em>Argument list: None</em></p>
<p>This procedure allows the wait status of the API to be determined by the calling application.<p>
<p>It returns the number of requests queued up and waiting for responses from the database server.<p>
<a name="::dbClientAPI::db_client_error" ><h4><font color="#CC3333">::dbClientAPI::db_client_error</font> <em>Return the last error message from inside the client API</em></h4> 
<p><em>Argument list: None</em></p>
<p>This returns the error message (blank if no error occurred since last time the error was read) and resets the message.<p>
<a name="::dbClientAPI::db_client_response_data" ><h4><font color="#CC3333">::dbClientAPI::db_client_response_data</font> <em>Return the results from the last handler response.</em></h4> 
<p><em>Argument list: None</em></p>
<p>This returns a list with two elements.<p>
<p>The first element is the status returned from the handler in response to the last request sent via the client API.<p>
<p>The second element is the result for that request.<p>
<a name="::dbClientAPI::db_get_handler_port" ><h4><font color="#CC3333">::dbClientAPI::db_get_handler_port</font> <em>Return the port number for the active database handler process</em></h4> 
<p><em>Argument list:  &lt;args&gt;</em></p>
<p>This is a fast and dirty way to acquire the port number for the database handler process - it looks at the handler lock file and tries to read the port number from it.<p>
<p>The lockfile is called dbccp4i.LOCK and has the following content:<p>
<p>port number is:4090<p>
<p>The procedure will try multiple attempts to get the port number unless the -nowait option is specified (in which case it will try just once). Multiple tries are used when the handler is starting up and the lock file is not immediately available.<p>
<p>The procedure returns the port number, or -1 if a port number cannot be acquired.<p>
<p><strong>-nowait</strong><p>
<p>Only try once to get the port number<p>
<p><strong>-directories</strong><p>
<p>Name of the (non-default) directories data file<p>
<a name="::dbClientAPI::db_client_report" ><h4><font color="#CC3333">::dbClientAPI::db_client_report</font> <em>Report an error or message from the API layer</em></h4> 
<p><em>Argument list:  &lt;code&gt; &lt;message&gt;</em></p>
<p>The reporting function resets the log file for each new invocation of the client API.<p>
<p><strong>code</strong>  A code number, not currently used<p>
<p><strong>message</strong>  The message to echo to the logfile<p>

<hr />
<h3>Handling dbCCP4i pseudo-XML (ClientAPI/dbxml.tcl)</h3>
<a name="Internal_Commands_for_Wrapping___Unwrapping_pseudo-XML"><h3> Internal Commands for Wrapping & Unwrapping pseudo-XML </h3> 
<p>These are<p>
<a name="DbXMLSetDebug" ><h4><font color="#CC3333">DbXMLSetDebug</font> <em>Query and optionally set the debug flag for DbXML</em></h4> 
<p><em>Argument list:  &lt;flag&gt; &lt;&gt;</em></p>
<p>The value of the debug flag determines whether diagnostic output is produced by the DbXML functions - if the flag is zero then no output is produced, otherwise diagnostics are printed to screen.<p>
<p>The function always returns the current status of the debugging flag.<p>
<p><strong>flag</strong>  (Optional) new value for the debug flag (0 or 1)<p>
<a name="DbXMLVersion" ><h4><font color="#CC3333">DbXMLVersion</font> <em> Returns the version of the XML functions</em></h4> 
<p><em>Argument list: None</em></p>
<p>Extract and return the version number from the RCS revision string (updated automatically by CVS) for this file.<p>
<a name="WrapDbRequest" ><h4><font color="#CC3333">WrapDbRequest</font> <em>Wrap a db_request in pseudo-XML to send to the handler</em></h4> 
<p><em>Argument list:  &lt;id&gt; &lt;command&gt; &lt;args&gt;</em></p>
<p>This command wraps the components of a request to the handler in the appropriate XML tags.<p>
<p>Each argument in "args" is wrapped in <argument>...</argument> tags. However: if the argument should be treated as a list then it must be preceeded by a "-list" argument.<p>
<p><strong>command</strong>  Handler command<p>
<p><strong>args</strong>  List of arguments for the command<p>
<p><strong>id</strong>  Request id string<p>
<a name="UnwrapDbRequest" ><h4><font color="#CC3333">UnwrapDbRequest</font> <em>Break a db_request pseudo-XML command into components</em></h4> 
<p><em>Argument list:  &lt;line&gt; &lt;commandVar&gt; &lt;arglistVar&gt; &lt;idVar&gt;</em></p>
<a name="WrapDbResponse" ><h4><font color="#CC3333">WrapDbResponse</font> <em>Wrap a db_response in pseudo-XML to send to the handler</em></h4> 
<p><em>Argument list:  &lt;args&gt;</em></p>
<a name="UnwrapDbResponse" ><h4><font color="#CC3333">UnwrapDbResponse</font> <em>Break a db_response pseudo-XML command into components</em></h4> 
<p><em>Argument list:  &lt;line&gt; &lt;statusVar&gt; &lt;resultVar&gt; &lt;idVar&gt;</em></p>
<p>Return 1 on success, 0 if there is an error<p>
<a name="WrapDbBroadcast" ><h4><font color="#CC3333">WrapDbBroadcast</font> <em>Wrap a broadcast message in pseudo-XML</em></h4> 
<p><em>Argument list:  &lt;message&gt;</em></p>
<a name="UnwrapDbBroadcast" ><h4><font color="#CC3333">UnwrapDbBroadcast</font> <em>Break a db_broadcast pseudo-XML message into components</em></h4> 
<p><em>Argument list:  &lt;line&gt; &lt;broadcastVar&gt;</em></p>
<p>Return 1 on success, 0 if there is an error<p>
<a name="EscapeXmlChars" ><h4><font color="#CC3333">EscapeXmlChars</font> <em>Convert special XML characters to their escaped form</em></h4> 
<p><em>Argument list:  &lt;cdata&gt;</em></p>
<p>This function returns the cdata string with any XML special characters (<,> and &) converted to their escaped form ("&lt;", "&gt;" and "&amp;" respectively).<p>
<p><strong>cdata</strong>  The character data to be converted<p>
<a name="UnescapeXmlChars" ><h4><font color="#CC3333">UnescapeXmlChars</font> <em>Convert escaped special XML characters to their original form</em></h4> 
<p><em>Argument list:  &lt;cdata&gt;</em></p>
<p>This function returns the cdata string with any escaped XML special characters ("&lt;", "&gt;" and "&amp;") converted to their original (unescaped) form ("&lt;", "&gt;" and "&amp;" respectively).<p>
<p>It turns out that the xml.tcl parser functions perform the unescaping functions automatically, so for now this function is not required. It is retained because it may be useful in future.<p>
<p><strong>cdata</strong>  The character data to be converted<p>

<hr />
<h3>CCP4i Functions (ClientAPI/ccp4ilite.tcl)</h3>
<a name="Duplicates_of_CCP4i_functions_that_can_be_used_without_CCP4i"><h3> Duplicates of CCP4i functions that can be used without CCP4i </h3> 
<p>Functions that replicate those found in the main CCP4i source code. There are made available here so that the full set of CCP4i source files do not need to be loaded, hopefully enabling the creation of lighter weight standalone Tcl applications.<p>
<a name="GetUserId" ><h4><font color="#CC3333">GetUserId</font> <em>Return the user's id. </em></h4> 
<p><em>Argument list: None</em></p>
<a name="GetDotCCP4" ><h4><font color="#CC3333">GetDotCCP4</font> <em>Return the location of the .CCP4 directory</em></h4> 
<p><em>Argument list: None</em></p>
<p>The .CCP4 directory is used to store user-specific CCP4 data.<p>
<p>This code was originally copied from ccp4i/src/system.tcl<p>
<a name="GetOPSYS" ><h4><font color="#CC3333">GetOPSYS</font> <em>Return the operating system type</em></h4> 
<p><em>Argument list: None</em></p>
<p>Returns the upper-cased platform type e.g. UNIX or WINDOWS.<p>
<a name="GetEnvPath" ><h4><font color="#CC3333">GetEnvPath</font> <em>Get operating system environment variable</em></h4> 
<p><em>Argument list:  &lt;var&gt; &lt;report&gt; &lt;1&gt;</em></p>
<p>Return a path name associated with an environment variable - in a Windows system the separators are converted to forward slash. Return an empty string if no environment variable found.<p>
<p>This procedure was copied from ccp4i/src/system.tcl but has been modified to use the GetOPSYS procedure<p>
<p><strong>var</strong>  Environment variable<p>
<p><strong>report</strong>  Optional - default 1. If true (1) then output warning message if environment variable not found.<p>
<a name="WarningMessage" ><h4><font color="#CC3333">WarningMessage</font> <em>Report a warning or display a message</em></h4> 
<p><em>Argument list:  &lt;message&gt;</em></p>
<p>This is a non-graphical placeholder for the WarningMessage function in the core CCP4i<p>

<hr />

</body>
</html>

