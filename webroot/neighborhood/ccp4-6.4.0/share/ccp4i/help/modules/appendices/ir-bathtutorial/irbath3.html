<!doctype html public "-//w3c//dtd html 3.2//en">
<html>
<head>
<title>CCP4 Interface: I. Tickle tutorial MIR (continuation 3)</title>
<link rel="stylesheet" type="text/css" href="../../../ccp4idocs.css" title="CCP4i" />
<link rev="made" href="mailto:mgwt@yorvic.york.ac.uk" />
<meta name="GENERATOR" content="Mozilla/3.0Gold (X11; I; IRIX 6.2 IP22) [Netscape]" />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="AUTHOR" content="Maria and Liz" />
</head>
<body>

<table border="0">
<tr><td rowspan="2"><img src="../../../images/weblogo175.gif" alt="CCP4 web logo" /></td>
<td class="logohead">CCP4i: Graphical User Interface</td></tr>
<tr><td class="logotitle">MIR Tutorial Bath - Patterson search</td></tr>
</table>

<table class="bathbuttons" width="100%">
<tr>
<td><a href="irbath2.html"><img src="back.gif" /></a></td>
<td align="center"><a href="irbath98.html">BACK TO INDEX</a></td>
<td align="right"><a href="irbath4.html"><img src="forward.gif" /></a></td>
</tr>
</table>

<h1>3. Patterson search for heavy-atom sites</h1>

<h3>3.1. Harker vectors and Harker sections</h3>

<p>Peaks in the Patterson function occur at the endpoints of vectors between all pairs of
heavy atom sites in a unit cell of the crystal.</p>

<p>Consider one site and its general equivalent positions (g.e.p.'s) related by space-group
symmetry. Vectors between symmetry-related atoms are <strong>Harker vectors</strong>.</p>

<p>For example, for space group P2<sub>1</sub> (2<sub>1</sub> axis along <strong>b</strong>) we have:<br>

<pre>g.e.p. 1 :    <em>x</em>,       <em>y</em>,   <em>z</em>
g.e.p. 2 :  -<em>x</em>, &#189;+<em>y</em>, -<em>z</em>
<em>u,v,w</em>    =  2<em>x</em>,   &#189; ,  2<em>z</em></pre>

<p>Here, (<em>x,y,z</em>) are the site coordinates and (<em>u,v,w</em>) are
Patterson coordinates. In P2<sub>1</sub> (unique <strong>b</strong>) the Harker
vector always occurs in the section defined by <em>v</em>=&#189;,
regardless of the site coordinates. The section <em>v</em>=&#189; in
the Patterson for P2<sub>1</sub> is a <strong>Harker section</strong>, generated by
the 2-fold screw axis along <strong>b</strong> (= [010]).</p>

<p>In general, N equivalent positions in a primitive (P) cell
give N-1 Harker vectors; for the purposes of the present
discussion, lattice centring C, I, R <em>etc.</em> may be ignored.</p>

<table class="bath2">
<tr>
<td>But in high symmetry space groups with 3, 4 or 6-fold axes,
some of the Harker vectors are related to each
other by the rotation symmetry of the Patterson.</td>
<td><img border="0" src="multi2tr.gif" alt="3, 4 and 6-fold axes" /></td>
</tr>
</table>

<p>Consequently, both a 2- and a 3-fold axis generate only
1 unique Harker vector; a 4-fold axis generates 2, and
a 6-fold 3 vectors. In high symmetry space groups, the
number of unique Harker vectors that need be checked
will therefore be less than N-1.</p>

<p>The relationship between the rotation or screw axis and
the corresponding Harker section(s) should be clear:</p>

<ol type="a">
<li><p>The Harker section(s) is/are always perpendicular to
the generating rotation or screw axis.</p></li>
<li><p>A rotation axis always generates all its Harker vectors in the same zero-level
Harker section. For example, a 2, 3, 4, or 6-fold axis along <strong>c</strong> (= [001]) generates a
single Harker section <em>w</em>=0. Similarly, 2-fold axes along the diagonals [110] and [-110]
generate zero-level Harker sections <em>u</em>+<em>v</em>=0 and <em>u</em>-<em>v</em>=0 respectively.</p></li>
<li><p>A 2<sub>1</sub> (or 4<sub>2</sub> or 6<sub>3</sub>) screw axis generates a Harker section at &#189;
of the unit cell length along the axis; a 3<sub>1</sub> or its enantiomorph 3<sub>2</sub>
(or 6<sub>2</sub>/6<sub>4</sub>) screw axis generates a Harker section at 1/3; a 4<sub>1</sub>/4<sub>3</sub>
screw generates 2 Harker sections at &#188; and &#189;; and a 6<sub>1</sub>/6<sub>5</sub>
screw generates 3 Harker sections at 1/6, 1/3 and &#189;. In some cases (<em>i.e.</em> 3<sub>1</sub>/3<sub>2</sub>,
6<sub>2</sub>/6<sub>4</sub>, 4<sub>1</sub>/4<sub>3</sub> and 6<sub>1</sub>/6<sub>5</sub>) other Harker sections
more than &#189; along the axis are also generated, but they are related by symmetry inversion to those given,
and need not be examined.</p></li>
</ol>

<p>Note that rotation and screw axis symmetry elements are the only ones that need be
considered for non-centrosymmetric space groups; these are the only space groups
in which &quot;handed&quot; molecules (<em></em><em>i.e.</em> the majority that are of biological origin) can
crystallise.</p>

<p>Taking another example, in space group P2<sub>1</sub>2<sub>1</sub>2 there are 3 Harker vectors, each on
a different section:</p>

<table class="bath1">
<tr><th>G.e.p.</th><th>Symmetry element</th><th>Harker vector</th><th>Harker section</th></tr>
<tr>
<td><em>x</em>,<em>y</em>,<em>z</em></td>
<td>1</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>-<em>x</em>,-<em>y</em>,<em>z</em></td>
<td>2 || <strong>c</strong></td>
<td>2<em>x</em>,2<em>y</em>,0</td>
<td><em>w</em> = 0</td>
</tr>
<tr>
<td>&#189;-<em>x</em>,&#189;+<em>y</em>,-<em>z</em></td>
<td>2<sub>1</sub> || <strong>b</strong></td>
<td>&#189;+2<em>x</em>,&#189;,2<em>z</em></td>
<td><em>v</em> = &#189;</td>
</tr>
<tr>
<td>&#189;+<em>x</em>,&#189;-<em>y</em>,-<em>z</em></td>
<td>2<sub>1</sub> || <strong>a</strong></td>
<td>&#189;,&#189;+2<em>y</em>,2<em>z</em></td>
<td><em>u</em> = &#189;</td>
</tr>
</table>

<h3>3.2. Deconvolution of the Patterson function.</h3>

<p>The Patterson function can be defined as the <strong>convolution</strong> of the electron density
function with a copy of itself symmetry inverted through the origin; alternatively the
Patterson function can be viewed as the <strong>autocorrelation</strong> of the electron density
function. The reverse process of extracting the electron density information from the
Patterson is therefore one of <strong>deconvolution</strong>.</p>

<p>The Patterson function has the same unit cell and lattice centring as the crystal; it also
has the same rotation axes, but each screw axis in the crystal becomes the
corresponding rotation axis in the Patterson (<em>e.g.</em> a 2<sub>1</sub> becomes a 2). Finally, the
Patterson has additional inversion centre symmetry. As a consequence, it is not
possible to derive unambiguously the site coordinates for all but the first site using
the Harker vector(s) alone.</p>

<p>Taking the example in P2<sub>1</sub> again:</p>

<table border="0">
<tr>
<td>( 2<em>x</em>, &#189;, 2<em>z</em> ) =</td>
<td></td>
<td>( <em>u</em>, <em>v</em>, <em>w</em> )</td>
<td>or</td>
<td>( -<em>u</em>, -<em>v</em>, -<em>w</em> )</td>
</tr>
<tr>
<td></td>
<td>or</td>
<td>( <em>u</em>+1, <em>v</em>, <em>w</em> )</td>
<td>or</td>
<td>( -<em>u</em>+1, -<em>v</em>, -<em>w</em> )</td>
</tr>
<tr>
<td></td>
<td>or</td>
<td>( <em>u</em> , <em>v</em>, <em>w</em>+1 )</td>
<td>or</td>
<td>( -<em>u</em> , -<em>v</em>, -<em>w</em>+1 )</td>
</tr>
<tr>
<td></td>
<td>or</td>
<td>( <em>u</em>+1, <em>v</em>, <em>w</em>+1 )</td>
<td>or</td>
<td>( -<em>u</em>+1, -<em>v</em>, -<em>w</em>+1 )</td>
</tr>
</table>

<p>Therefore:</p>

<table border="0">
<tr>
<td>( <em>x</em>, <em>y</em>, <em>z</em> ) =</td>
<td></td>
<td>( <em>u</em>/2 , ?, <em>w</em>/2 )</td>
<td>or</td>
<td>( -<em>u</em>/2 , ?, -<em>w</em>/2 )</td>
</tr>
<tr>
<td></td>
<td>or</td>
<td>( <em>u</em>/2+&#189;, ?, <em>w</em>/2 )</td>
<td>or</td>
<td>( -<em>u</em>/2+&#189;, ?, -<em>w</em>/2 )</td>
</tr>
<tr>
<td></td>
<td>or</td>
<td>...</td>
</tr>
</table>

<p>(The &quot;?&quot; indicates that for this space group the <em>y</em> coordinate is arbitrary.)</p>

<p>In the case where there are several Harker vectors per site, it is necessary to correlate
the information from all the Harker sections.</p>

<p>Note that the possible choices for (<em>x</em>, <em>y</em>, <em>z</em>) are all equally valid,
but are <strong>not</strong> related by
space group symmetry. In the general case two types of ambiguity arise:</p>

<ol type="a">
<li><p>There is an arbitrary possible <strong>origin shift</strong> for the site coordinates; this depends on
the point group of the crystal:</p>
<table border="0" width="100%">
<tr><th align="left">crystal system</th><th align="left">point group</th><th align="left">origin shift options</th></tr>
<tr>
<td>Triclinic</td>
<td>1</td>
<td><em>x</em>, <em>y</em> and <em>z</em> arbitrary.</td>
</tr>
<tr>
<td>Monoclinic (unique <strong>b</strong>)</td>
<td>2</td>
<td>&#189; in <em>x</em> and/or <em>z</em>; <em>y</em> arbitrary.</td>
</tr>
<tr>
<td>Orthorhombic</td>
<td>222</td>
<td>&#189; in <em>x</em> and/or <em>y</em> and/or <em>z</em>.</td>
</tr>
<tr>
<td>Trigonal</td>
<td>3</td>
<td>1/3 in <em>x</em> <strong>and</strong> 2/3 in <em>y</em>, or <em>vice versa</em>; <em>z</em> arbitrary.</td>
</tr>
<tr>
<td></td>
<td>312</td>
<td>1/3 in <em>x</em> <strong>and</strong> 2/3 in <em>y</em>, or <em>vice versa</em>, and/or &#189; in <em>z</em>.</td>
</tr>
<tr>
<td></td>
<td>321</td>
<td>(0,0,&#189;)</td>
</tr>
<tr>
<td>Tetragonal</td>
<td>4</td>
<td>&#189; in <em>x</em> <strong>and</strong> <em>y</em>; <em>z</em> arbitrary.</td>
</tr>
<tr>
<td></td>
<td>422</td>
<td>&#189; in <em>x</em> <strong>and</strong> <em>y</em>, and/or &#189; in <em>z</em>.</td>
</tr>
<tr>
<td>Hexagonal</td>
<td>6</td>
<td><em>z</em> arbitrary.</td>
</tr>
<tr>
<td></td>
<td>622</td>
<td>(0,0,&#189;)</td>
</tr>
<tr>
<td>Cubic</td>
<td>23</td>
<td>(&#189;,&#189;,&#189;)</td>
</tr>
<tr>
<td></td>
<td>432</td>
<td>(&#189;,&#189;,&#189;)</td>
</tr>
</table>

<p>Also for space groups F222 and F23 there is an additional possible shift of (&#188;,&#188;,&#188;).</p></li>
<li><p>The <strong>handedness</strong> of the site coordinates,
<em>i.e.</em> (-<em>x</em>, -<em>y</em>, -<em>z</em>) instead of (<em>x</em>, <em>y</em>, <em>z</em>), may be
chosen arbitrarily.</li>
</ol>

<h3>3.3. Symmetry Function</h3>

<p>The automatic Patterson search programs work in a different fashion from that
described above; basically they consider each grid point in the asymmetric unit of the
crystal to be a putative heavy-atom site, and compute a score based on the Harker
and/or cross vectors for that site. This score is placed at the grid point and a map
similar to an electron density map generated, that can then be searched for peaks.</p>

<p>To find the first heavy-atom site a <strong>symmetry function</strong> is calculated: using Harker
vectors only, for every point in the asymmetric unit of the crystal, the corresponding
Patterson density value(s) are obtained. If there is only 1 Harker vector, as in P2<sub>1</sub>,
then its density value is used as the score; otherwise the density values for all the
Harker vectors are combined into a single score. The method of combination is
critical; three possibilities are minimum, sum, or harmonic mean.</p>

<p>These are self-explanatory: <em>i.e.</em> the <strong>minimum function</strong> takes the minimum of all the
values as the score. The minimum function has the disadvantage that it is too
discriminating: if the Patterson is very noisy one of the Harker vectors may by chance
have a low peak density value, so the site may not appear in the map where it
should. Conversely the <strong>sum function</strong> tends to have low discriminatory power: if one
Harker vector accidentally has a high value, but the others are absent, the map may
show a site where there is none. The harmonic mean (reciprocal of the mean of the
reciprocals of the density values) seems to strike a happy medium between the two.</p>

<h3>3.4. Cross vectors and the Superposition Function</h3>

<p>Once the first site for a particular derivative is chosen either manually from the
Harker vectors, or automatically from the symmetry function, that site fixes the origin
for all the sites in that derivative. This means that second and subsequent sites for
the derivative cannot be obtained by application of the same method, because there
is then no guarantee that the subsequent sites will be chosen with the same origin.</p>

<p>The automatic Patterson search procedure works by obtaining the second and
subsequent sites one at a time in stepwise fashion. Both Harker vectors for the site
currently being searched for, and <strong>cross vectors</strong> (vectors between sites not related by
space-group symmetry) between the current site and all the previously determined
sites are used to calculate a <strong>superposition function</strong>. The name derives from a
manual method of deconvoluting the Patterson, by superposing shifted copies of
itself. As before, the Patterson densities corresponding to all the vectors, both Harker
and cross, are combined with a minimum, sum or harmonic mean function to
produce a score for each grid point in the asymmetric unit of the crystal in turn.</p>

<p>Consider the case of 2 sites in P2<sub>1</sub>:</p>

<table border="0">
<tr><th>Site 1</th><th>Site 2</th><th>Cross vector</th></tr>
<tr>
<td>( <em>x</em><sub>1</sub>, <em>y</em><sub>1</sub>, <em>z</em><sub>1</sub> )</td>
<td align="center">( <em>x</em><sub>2</sub>, <em>y</em><sub>2</sub>, <em>z</em><sub>2</sub> )</td>
<td align="center">( <em>x</em><sub>1</sub>-<em>x</em><sub>2</sub>, <em>y</em><sub>1</sub>-<em>y</em><sub>2</sub>,
<em>z</em><sub>1</sub>-<em>z</em><sub>2</sub> )</td>
</tr>
<tr>
<td></td>
<td>( -<em>x</em><sub>2</sub>, &#189;+<em>y</em><sub>2</sub>, -<em>z</em><sub>2</sub> )</td>
<td>( <em>x</em><sub>1</sub>+<em>x</em><sub>2</sub>, &#189;+<em>y</em><sub>1</sub>-<em>y</em><sub>2</sub>,
<em>z</em><sub>1</sub>+<em>z</em><sub>2</sub> )</td>
</tr>
</table>

<p>Provided the sites lie at completely general positions, there will always be exactly N
(the number of <em>g.e.p.</em>'s in the P cell) unique cross-vectors for every pair of unique
sites; all other cross vectors are related to these by the Patterson symmetry, and
therefore do not need to be checked.</p>

<p>Now there is no ambiguity about the co-ordinates of site 2, because if it were <em>e.g.</em>
(-<em>x</em><sub>2</sub>, -<em>y</em><sub>2</sub>, -<em>z</em><sub>2</sub> )
then the cross vector would be
( <em>x</em><sub>1</sub>+<em>x</em><sub>2</sub>, <em>y</em><sub>1</sub>+<em>y</em><sub>2</sub>,
<em>z</em><sub>1</sub>+<em>z</em><sub>2</sub> ) which is not related
by symmetry to the actual cross vectors. So the superposition function has only
space group symmetry; the relative origin and hand ambiguities are removed.</p>

<p>Note that there still remains the problem of ensuring that the sites in any derivatives
subsequently solved are on the same origin and hand as the first one, and also that
the absolute hand of the complete set of sites has been chosen correctly; these
problems are best dealt with later at the refinement stage.</p>

<h3>3.5. Software for automatic Patterson search</h3>

<h4>VECSUM (CCP4)</h4>

<p>Takes an isomorphous difference Patterson computed by FFT and computes either
a symmetry function map if no site coordinates are input, or a superposition function
map if one or more sites are input. There are options for minimum, sum or harmonic
mean function. A peak search program (<em>e.g.</em> <strong>PEAKMAX</strong>) should then be used to look
for possible sites in the map. The program also has an option to calculate all vectors
(Harker and cross) given a set of sites, and print a list of the corresponding Patterson
density values.</p>

<h4>RSPS (CCP4)</h4>

<p>An automated version of VECSUM with simpler input and with options for non-crystallographic symmetry.</p>

<h4>SHELXS-86</h4>

<p>More automated than VECSUM, and with simpler input, but less flexible (<em>e.g.</em>
restricted to the minimum function). <strong>Direct methods phasing</strong> can also be used to
locate the heavy atoms. SHELX is not part of CCP4 and must be obtained separately.</p>

<table class="bathbuttons" width="100%">
<tr>
<td><a href="irbath2.html"><img src="back.gif" /></a></td>
<td align="center"><a href="irbath98.html">BACK TO INDEX</a></td>
<td align="right"><a href="irbath4.html"><img src="forward.gif" /></a></td>
</tr>
</table>

</body></html>
