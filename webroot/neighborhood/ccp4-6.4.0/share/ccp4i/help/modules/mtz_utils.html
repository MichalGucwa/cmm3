<!DOCTYPE html
                     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                     "DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>CCP4 Interface: Reflection Data Utilities Module</title>
<link rel="stylesheet" type="text/css" href="../ccp4idocs.css" title="CCP4i" />
<link rev="made" href="mailto:mgwt@ysbl.york.ac.uk" />
<meta name="GENERATOR" content="Mozilla/3.0Gold (X11; I; IRIX 6.2 IP22) [Netscape]" />
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="AUTHOR" content="Maria and Liz" />
</head>
<body>

<table border="0">
<tr><td rowspan="2"><img src="../images/weblogo175.gif" alt="CCP4 web logo" /></td>
<td class="logohead">CCP4i: Graphical User Interface</td></tr>
<tr><td class="logotitle">Reflection Data Utilities Module</td></tr>
</table>
<br />

<table border="0">
<tr><td>
<a href="coord_utils.html" target="_self">
<img border="0" class="navbutton" src="../images/3Dnexttr.gif" alt="next button" /></a>
<a href="maputils.html" target="_self">
<img border="0" class="navbutton" src="../images/3Dprevtr.gif" alt="previous button" /></a>
<a href="../index.html" target="_top">
<img border="0" class="navbutton" src="../images/3Dtoptr.gif" alt="top button" /></a>
</td></tr>
</table>

<dl>
<dt><font color="#cc3333"><strong>Tasks in this module:</strong></font></dt>
</dl>

<dl>
<dt><a href="#truncate" target="_self">Analyse Data Quality (TRUNCATE)</a></dt>
</dl>
<dl>
<dt><a href="#sfall1" target="_self">Calculate Fs &amp; Phases (SFALL)</a></dt>
<dd><a href="#sfall_layout" target="_self">SFALL - Task Window Layout</a></dd>
</dl>
<dl>
<dt><a href="#import" target="_self">Convert to/modify/extend MTZ (Import)</a></dt>
<dd><a href="#import_data_harvesting_f2mtz" target="_self">Import - Project/Crystal/Dataset Names</a></dd>
<dd><a href="#import_data_harvesting_truncate" target="_self">Import - Data Harvesting in TRUNCATE</a></dd>
<dd><a href="#import_layout" target="_self">Import - Task Window Layout</a></dd>
<dd><a href="#import_task" target="_self">Import - The Import Task</a></dd>
<dd><a href="#import_file_format" target="_self">Import - The Import File Format</a></dd>
<dd><a href="#import_na4tomtz" target="_self">Import - NA4toMTZ</a></dd>
<dd><a href="#import_cif2mtz" target="_self">Import - CIF2MTZ</a></dd>
<dd><a href="#import_column_types" target="_self">Import - The MTZ Column Types</a></dd>
</dl>
<dl>
<dt><a href="#export" target="_self">Convert from MTZ (Export)</a></dt>
<dd><a href="#export_layout" target="_self">Export - Task Window Layout</a></dd>
</dl>
<dl>
<dt><a href="#sftools" target="_self">Edit MTZ File (SFTOOLS)</a></dt>
<dd><a href="#sftools_layout" target="_self">SFTOOLS - Task Window Layout</a></dd>
</dl>
<dl>
<dt><a href="#cad1" target="_self">Merge MTZ Files (CAD)</a></dt>
<dd><a href="#cad_layout" target="_self">CAD - Task Window Layout</a></dd>
</dl>
<p><a href="#edit_dname" target="_self">Edit MTZ Datasets</a></p>
<dl>
<dt><a href="#reindex" target="_self">Reindex Reflections - Reindex</a></dt>
</dl>
<dl>
<dt><a href="#sfanal" target="_self">SF File Analysis (SFTOOLS)</a></dt>
</dl>
<dl>
<dt><a href="#phistats" target="_self">Phase Analysis (Phistats)</a></dt>
</dl>
<dl>
<dt><a href="#sigmaa" target="_self">Sigma-A</a></dt>
</dl>
<dl>
<dt><a href="#hltofom" target="_self">Convert FoM to/from HL</a></dt>
</dl>
<dl>
<dt><a href="#phasematch1" target="_self">Phase Comparison</a></dt>
</dl>
<dl>
<dt><strong><em>Clipper Reflection Utilities</em></strong></dt>
<dd><a href="#ecalculate" target="_self">Calculate E's</a></dd>
<dd><a href="#phasecombine" target="_self">Combine Phases</a></dd>
<dd><a href="#sfcalcmap" target="_self">Map to Structure Factors</a></dd>
<dd><a href="#sfcalcmodel" target="_self">Model to Structure Factors</a></dd>
<dd><a href="#sfweight" target="_self">Calculate Sigma-A Weights</a></dd>
</dl>

<dl>
<dt><font color="#cc3333"><strong>Specialist Help</strong></font> is available on:</dt>
<dd><a href="appendices/freerunique.html" target="_APPENDIX">FreerUnique</a> - how to
create a complete unique list of reflections with your data</dd>
</dl>

<p>The layout of each task window, <em>i.e.</em> the number of folders present,
and whether these folders are open or closed by default, depends on the choices
made in the <strong>Protocol</strong> folder of the task (see
<a href="../general/intro.html#task_window_format" target="_self">Introduction</a>). Although
certain folders are closed by default, there are specific reasons why you should
or may want to look at them. These reasons are described in the Task Window
Layout sections below.</p>

<h3><a name="truncate"></a><a name="truncate1"></a>Analyse Data Quality - Truncate</h3>

<p>The program Truncate is used to obtain structure factor amplitudes from
intensities, however it can performs useful analyses on the reflection data,
including graphs of anisotropy, cumulative intensity statistics and indications
of twinning.</p>

<p>See program documentation:
<a href="../../../../html/ctruncate.html" target="_PROGDOC">CTruncate</a>,
<a href="../../../../html/truncate.html" target="_PROGDOC">Truncate</a></p>

<h3><a name="sfall"></a><a name="sfall1"></a>Calculate Fs &amp; Phases - SFALL</h3>

<p>This is an interface to the SFALL program which generates Fcalc and PHIcalc from either input
coordinates or a map. You must give the name of an input coordinate or map file and also an MTZ
file into which the calculated Fs and PHIs are added. You will need to identify the FP and SIGFP
in the MTZ file. If a FreeR column is also identified, the FreeR set of reflections will be
excluded from the calculation. By default the calculated Fs and PHIs will cover the same
resolution range as the one already in the MTZ file.</p>

<h4><a name="sfall_layout"></a>SFALL - Task Window Layout</h4>

<p>The Task Window for the SFALL Task is relatively simple. The <strong>Protocol</strong>
folder has the choice between generating structure factors from coordinates or a map (after
which the <strong>Files</strong> folder is adapted accordingly), and the option to scale the
input Fp to the Fcalc.</p>

<p>After the Protocol and Files folders, the 'Crystal Parameters' folder has the option of
adapting resolution range, space group and/or cell parameters. The 'Program
Parameters' folder allows the adaptation of <tt>Maximum atom radius used to build atom/residue mask</tt>
and the amount to <tt>add to atomic Bfactors</tt>.</p>

<p>See program documentation:
<a href="../../../../html/sfall.html" target="_PROGDOC">SFALL</a>.</p>

<h3><a name="import"></a>Convert to/modify/extend MTZ - Import</h3>

<p>Standard CCP4 programs deal with reflection files in so-called MTZ format.
Files in different formats, namely ascii MTZ ('na4'), X-PLOR/CNS, SHELX, MULTAN, TNT,
mmCIF and user defined ascii, may be converted to MTZ format. Additionally, MTZ files
may be extended to create a full unique set of reflections with various options
to deal with freeRflags. The default setting is to create this set.
At the start of a structure determination, it is advisable to always
create this full unique set of reflections, which contains (<tt>h, k, l, F, SIGF,
(I, SIGI), ..., FreeR_flag</tt>) for all observed reflections to the resolution
limit available, plus entries for any unobserved reflection, all with
freeRflags assigned. This never does
any harm, and it is much harder to do satisfactorily at a later stage. For
more information about a full unique set with freeRs, see also
<a href="appendices/freerunique.html" target="_self">FreerUnique</a>.</p>

<h4><a name="import_data_harvesting_f2mtz"></a>Import - Project/Crystal/Dataset Names</h4>

<p>When importing data with F2MTZ, and creating a new MTZ file, it is important
to set sensible names for the Crystal, Project and Dataset. These will
be used to set a data structure for reflection information, and also
to control Data Harvesting (see the Data Harvesting 
<a href="../general/harvesting.html">page</a> for background details).
The crystal name should identify the physical crystal used, and the
dataset should identify a dataset taken from a physical crystal (e.g. a
MAD experiment may take 3 datasets from a crystal at different wavelengths).
The project may correspond to the CCP4i project, but does not have to.
Input these in the 'MTZ Project, Crystal &amp; Dataset Names' folder directly 
beneath the <strong>Files</strong> folder.</p>

<h4><a name="import_data_harvesting_truncate"></a>Import - Data Harvesting in TRUNCATE</h4>

<p>TRUNCATE, part of the Import Task when SHELX or MULTAN data is imported, is needed to convert
intensities to structure factors. This is a genuine call for data harvesting, which is why the
first folder beneath the <strong>Protocol</strong> and <strong>Files</strong> folders is concerned
with 'Data Harvesting'. The user has the choice whether to allow data harvesting or not, but it is,
of course, recommended. The user should also set Crystal, Project and Dataset
Names, as above, which will also be used to control harvesting from Truncate.</p>

<p>See <a href="../general/harvesting.html" target="_self">Data Harvesting in CCP4i</a>
for implications for the Interface.</p>

<h4><a name="import_layout"></a>Import - Task Window Layout</h4>

<p>Features to look out for in the Convert to MTZ &amp; Standardise Task are:</p>
<table border="1">
<tr><th>Protocol option</th><th>Folder title</th><th>Importance</th>
<th>Comment</th></tr>
<tr><td><strong>all</strong></td>
<td><strong>Creating full/unique dataset</strong></td>
<td>freeR</td>
<td>see <a href="../../../../html/freerunique.html" target="_APPENDIX">FreerUnique</a></td></tr>
<tr><td></td>
<td></td>
<td>systematic absences</td>
<td>chance to include them in MTZ file</td></tr>
<tr><td></td>
<td></td>
<td>extend resolution</td>
<td>use artificially high resolution if more data is anticipated</td></tr>
<tr><td><strong>all (not MTZ, ascii MTZ, mmCIF)</strong></td>
<td><strong>Detailed specification of import file format</strong></td>
<td><strong>Fortran format</strong>, data type and labels</td>
<td>Essential for the successful running of the Task with user defined
option. See <a href="#import_file_format" target="_self">below</a></td></tr>
<tr><td><strong>SHELX and MULTAN</strong></td>
<td><strong>Convert Is to Fs</strong></td><td>TRUNCATE protocol to be followed</td>
<td>Conversion to structure factors either by truncation according 
to French&amp;Wilson, or by simply taking the square root of the intensities. See
<a href="../../../../html/truncate.html#truncate" target="_PROGDOC">TRUNCATE</a>
documentation.
</td></tr>
<tr><td></td>
<td><strong>Data Harvesting</strong> and <strong>Convert Is to Fs</strong></td>
<td>role of TRUNCATE in Data Harvesting</td>
<td>see <a href="#import_data_harvesting_truncate" target="_self">above</a></td></tr>
<tr><td><strong>all (not MTZ, ascii MTZ)</strong></td>
<td><strong>Extra information to be saved in MTZ file</strong></td>
<td>symmetry, cell</td>
<td>Add in symmetry and cell information if needed</td></tr>
</table>

<h4><a name="import_task"></a>Import - The Import Task</h4>

<p>The full &quot;import&quot; (<em>i.e.</em> Convert to MTZ &amp; Standardise) task contains
the following steps:</p>

<ol>
<li><p>F2MTZ - to convert any ASCII style reflection file to MTZ format.
If no full unique set of reflections with freeRflags is required, this will be
the only step (but this is not the default). For &quot;ascii MTZ&quot; and
mmCIF, the specialised programs NA4TOMTZ and CIF2MTZ are used instead.</p></li>
<li><p>unique - to create a full unique list of reflections (indices) with dummy
F and SIGF, to the required resolution. This file is then used as a template
list in the following steps.</p>
<p><em>Then, depending on whether there were freeRflags already in your data
or not, <em>i.e.</em> whether you chose to</em></p>
<ol type="a">
<li><strong><tt>keep existing FreeR data</tt></strong></li>
<li><strong><tt>import FreeR data from another MTZ file</tt></strong></li>
<li><strong><tt>generate FreeR data</tt></strong></li>
</ol>
<p><em>one of the following happens</em>:</p></li>
<li><p>If there were freeRflags already in your data set:</p>
<ul>
<li><p>CAD - to combine your data (from step 1, <em>i.e.</em> option a, or from an existing MTZ file,
<em>i.e.</em> option b) with
the unique template list (from step 2), sort it to standard order, and place it
in the CCP4 asymmetric unit. Reflections not featuring in your data set will
acquire a &quot;missing number flag&quot; (&quot;NaN&quot; by default), which
can be replaced with real data as and when it becomes available.</p>
<p><em>N.B. CAD can not deal with more than 29 columns.</em></p></li>
<li><p>freerflag - in COMPLETE mode, to add a random freeRflag to all reflections
which do not already have one.</p></li>
<li><p>mtzutils - to remove superfluous columns (created by step 2) from the file.</p></li>
</ul>
</li>
<li><p>If freeRflags are to be assigned from scratch for all reflections (<em>i.e.</em> option c):</p>
<ul>
<li><p>freerflag - to add a random freeRflag to all reflections in the file created
in step 2, according to the chosen fraction.</p></li>
<li><p>CAD - as in step 3, using all columns from your data, but using only the
freeRflag column from the unique file from step 2, so that the superfluous columns
are automatically removed at this stage.</p></li>
<li><p>freerflag - as in step 3, to ensure freeRflags are assigned to every
reflection.</p></li>
</ul>
</li>
</ol>

<h4><a name="import_file_format"></a>Import - The Import File Format</h4>

<p>Pay special attention to the folder <strong>Detailed specification of import
file format</strong>:</p>
<ul>
<li><font color="#ff3333">The program F2MTZ requires all values to be described
as <strong>real numbers</strong>, <em>i.e.</em> Fortran format type F</font>. The Interface
has the default <strong>Fortran format</strong> for all types of reflection
files, but this may have to be changed if a non-standard reflection file is
used or if more or fewer columns are to be included. This is an example of
a Fortran format as it should be entered:<br />
<pre>(5X,3F5.0,6X,2F10.0,7X,F10.0,/,10X,2F10.0,8X,F10.0,6X,F10.0)</pre>
This complicated statement describes the following reflection file format:<br />
<pre>
INDE     6    0    0 FOBS=  1259.884     0.000 SIGMA=    38.561
    FPART=     0.000     0.000 WEIGHT=     1.000 TEST=         0</pre>
<ul>
<li>For more information on Fortran formats, see a Fortran Manual.</li>
<li>TNT input is split into two files (working and test sets separately).
The Interface will automatically merge those files and insert freeRflags
but can only do so if you add F8.0 to the format statement.</li>
</ul>
</li>
<li>If there are header lines
in the reflection file not containing actual data, these lines should be
skipped. The program will not run if the <strong>SKIP value</strong> is incorrect.
<ul>
<li>If the input is from TNT, the merging of the files can only happen
successfully if the headers of the two input files contain the same number
of lines, <em>i.e.</em> the SKIP value is the same for both files.</li>
</ul>
</li>
<li>The <strong>output data type and label</strong> must be given correctly for every column
of data in the reflection file.
<ul>
<li>For X-PLOR input, the Interface is assuming freeRflags are already
assigned, and will initiate the necessary swap of the values (see
<a href="../../../../html/freerunique.html" target="_APPENDIX">FreerUnique</a>) by denoting
the column type X for the freeRflag column.</li>
<li>If the input is from SHELX, the Intensities have to be converted to
Fs. The column labels for the program Truncate, which is
to perform the
conversion, need to match those of the input file exactly.</li>
</ul>
</li>
</ul>

<h4><a name="import_na4tomtz"></a>Import - NA4toMTZ</h4>

<p>The CCP4 Suite of programs is released with a set of example files. MTZ files
are distributed in 'na4' format, which is a type of ASCII. In order to convert
these to the MTZ format needed to run the programs, the program NA4toMTZ is provided.
In the Interface, this is included within the 'F2MTZ' part of the 'Convert to MTZ &amp; Standardise'
task.</p>

<p>When browsing for an 'na4' file, do not forget to change the file extension to
'.na4'.</p>

<h4><a name="import_cif2mtz"></a>Import - CIF2MTZ</h4>

<p>Structure factor files obtained from the PDB will be in mmCIF format.
This option can be used to convert these files to MTZ format. With a
well-formed mmCIF file, you should not need to change the defaults or add
any information.</p>

<h4><a name="import_column_types"></a>Import - The MTZ Column Types</h4>

<dl compact="compact">
<dt>H</dt> <dd>index h,k,l</dd>
<dt>F</dt> <dd>structure amplitude, F</dd>
<dt>G</dt> <dd>structure amplitude associated with F(+) or F(-) </dd>
<dt>L</dt> <dd>standard deviation of column of type G</dd>
<dt>D</dt> <dd>anomalous difference</dd>
<dt>Q</dt> <dd>standard deviation of anything: J,F,D or other</dd>
<dt>P</dt> <dd>phase angle in degrees</dd>
<dt>W</dt> <dd>weight (of some sort)</dd>
<dt>A</dt> <dd>phase probability coefficients (Hendrickson/Lattman)</dd>
<dt>B</dt> <dd>BATCH number</dd>
</dl>
<p>These data types are not usually present, but are legal:</p>
<dl compact="compact">
<dt>S</dt> <dd>1/d**2 = 4 (sin theta/lambda)**2</dd>
<dt>J</dt> <dd>intensity</dd>
<dt>K</dt> <dd>intensity associated with I(+) or I(-)</dd>
<dt>M</dt> <dd>standard deviation of column of type K</dd>
<dt>E</dt> <dd>normalised structure factor</dd>
<dt>Y</dt> <dd>M/ISYM, packed partial/reject flag and symmetry number</dd>
<dt>I</dt> <dd>any other integer</dd>
<dt>R</dt> <dd>any other real</dd>
<dt>U</dt> <dd>partial FC (see <a href="#cad_uv" target="_self">CAD</a>)</dd>
<dt>V</dt> <dd>partial PHIC (see <a href="#cad_uv" target="_self">CAD</a>)</dd>
</dl>
<p>In addition, the program F2MTZ accepts the column type
X for freeRflags originating from X-PLOR/CNS, and will reset
the column type to I in the resulting MTZ file (see
<a href="../../../../html/freerunique.html" target="_APPENDIX">FreerUnique</a>).</p>
<p><font color="#ff3333"><em>N.B. The column types of structure amplitudes
and phases may not be any other than</em> F <em>and</em> P<em>,
respectively.</em></font> <em>It is also essential to have correct column types
for phases and anomalous differences, to distinguish:</em></p>
<ul>
<li>phases which will require changing if the
reflection is moved to a symmetry equivalent;</li>
<li>anomalous differences which require changing sign
if the reflection is changed to a Friedel partner.</li>
</ul>

<p>See program documentation:
<a href="../../../../html/f2mtz.html" target="_PROGDOC">F2MTZ</a>,
<a href="../../../../html/mtztona4.html" target="_PROGDOC">NA4toMTZ</a>,
<a href="../../../../html/cif2mtz.html" target="_PROGDOC">CIF2MTZ</a>,
<a href="../../../../html/unique.html" target="_PROGDOC">UNIQUE</a>,
<a href="../../../../html/freerflag.html" target="_PROGDOC">FREERFLAG</a>,
<a href="../../../../html/cad.html" target="_PROGDOC">CAD</a>,
<a href="../../../../html/mtzutils.html" target="_PROGDOC">MTZUTILS</a>,
<a href="../../../../html/mtzlib.html" target="_PROGDOC">MTZLIB</a></p>

<h3><a name="export"></a>Convert from MTZ - Export</h3>

<p>MTZ files may be converted to several other formats, <em>i.e.</em> X-PLOR/CNS,
MULTAN/RANTAN, SHELX, TNT, MAIN, SCALEPACK, USER and mmCIF. To output an mmCIF
file for deposition, use the task interface &quot;Structure Factors
for Deposition&quot; in the <a href="valdep.html#mtz2cif" target="_self">Validation &amp;
Deposition</a> module instead.</p>

<h4><a name="export_layout"></a>Export - Task Window Layout</h4>

<p>Features to look out for in the Convert from MTZ Task are:</p>
<table border="1">
<tr><th>Protocol option</th><th>Folder title</th><th>Importance</th>
<th>Comment</th></tr>
<tr><td><strong>CIF</strong></td><td><strong>CIF Format Details</strong></td><td>one data block per dataset</td>
<td>See <a href="../../../../html/mtz2various.html#cif" target="_PROGDOC">Notes
on CIF</a> in the MTZ2VARIOUS Program Documentation</td></tr>
<tr><td><strong>CIF</strong>, <strong>SHELX</strong> and <strong>XPLOR/CNS</strong></td>
<td><strong>MTZ File Labels</strong></td>
<td>anomalous data</td><td>Friedel pairs are output as separate reflections if the
anomalous difference is assigned. See also
<a href="../../../../html/mtz2various.html#output_anomalous_data" target="_PROGDOC">OUTPUT
anomalous data</a> in MTZ2VARIOUS Program Documentation</td></tr>
<tr><td><strong>SCALEPACK</strong></td>
<td><strong>MTZ File Labels</strong></td><td>I(+) and I(-)</td><td>pseudo-SCALEPACK output
useable as input to the <a href="http://www.solve.lanl.gov" target="_EXTERNAL">SOLVE</a>
package</td></tr>
<tr><td><strong>USER</strong></td><td><strong>User Defined Output Format</strong></td><td></td>
<td>See
<a href="../../../../html/mtz2various.html#output_user" target="_PROGDOC">OUTPUT options</a>
and
<a href="../../../../html/mtz2various.html#inputoutput" target="_PROGDOC">Notes on
INPUT and OUTPUT</a> in the MTZ2VARIOUS Program Documentation</td></tr>
<tr><td><strong>all</strong></td><td><strong>Infrequently Used Options</strong></td><td>output
modifications</td><td>get output in desired form</td></tr>
</table>

<p>See program documentation:
<a href="../../../../html/mtz2various.html" target="_PROGDOC">MTZ2VARIOUS</a>,
<a href="../../../../html/mtzdump.html" target="_PROGDOC">MTZDUMP,MTZDMP</a>,
<a href="../../../../html/mtztona4.html" target="_PROGDOC">MTZTONA4,NA4TOMTZ</a>,
<a href="../../../../html/mtzutils.html" target="_PROGDOC">MTZUTILS</a></p>

<p>For more information on mmCIF, see
<a href="http://www.iucr.ac.uk/iucr-top/cif/mmcif/ndb/" target="_EXTERNAL">The
mmCIF Home Page at the IUCr</a>.</p>

<h3><a name="sftools"></a>Edit MTZ File (SFTOOLS)</h3>

<p>Analyse, manipulate and convert structure factor files.</p>

<h4><a name="sftools_layout"></a>SFTOOLS - Task Window Layout</h4>

<p>Features to look out for in the Edit MTZ File Task are:</p>
<table border="1">
<tr><th>Protocol option</th><th>Folder title</th><th>Importance</th><th>Comment</th></tr>
<tr>
<td><strong>set or change header information</strong></td>
<td colspan="3" align="center">default option</td>
</tr>
<tr>
<td></td>
<td><strong>Change column labels and types</strong></td>
<td>Change column label to</td>
<td>chance to make column label names that mean something to you</td>
</tr>
<tr>
<td><a name="reduce_to_asu"></a><strong>reduce to asymmetric unit</strong></td>
<td></td><td></td>
<td>choose CCP4, BIOMOL, TNT or user-defined</td>
</tr>
<tr>
<td><strong>expand to lower symmetry</strong></td>
<td></td><td></td>
<td>specify spacegroup to expand into, and choose asymmetric unit as
<a href="#reduce_to_asu" target="_self">before</a>. Can also be done with
<a href="../../../../html/cad.html" target="_PROGDOC">CAD</a></td>
</tr>
<tr>
<td><strong>sort reflections</strong></td>
<td></td><td>sorting criteria</td>
<td><a name="sftools_sort"></a>sorting on index can also be done with
<a href="../../../../html/cad.html" target="_PROGDOC">CAD</a>, see
<a href="#cad_sort" target="_self">below</a></td>
</tr>
<tr>
<td><strong>reindex reflections</strong></td>
<td></td>
<td>transformation matrix</td>
<td>complicated transformations with translations
are better dealt with by redoing the data reduction</td>
</tr>
<tr>
<td><strong>merge reflections</strong></td>
<td></td><td></td>
<td>use only when you know why you have multiple reflections with
identical indices</td>
</tr>
<tr>
<td><strong>delete reflections</strong></td>
<td></td><td></td><td></td>
</tr>
<tr>
<td><strong>delete columns</strong></td>
</tr>
<tr>
<td><strong>generate Hendrickson-Lattman coeffs</strong></td>
<td></td><td></td><td></td>
</tr>
</table>

<!--on 22jan99 liz wrote about keep/delete and include/exclude in 'delete reflections':
Yes I know this may be a bit confusing. This stuff was tricky to do to make
sure I did not remove any of the options that sftools supports.

The Include/Exclude is part of a generic tool to  select a set of reflections
(the same thing will appear in other places - eg when you list an MTZ file and
then hit the 'More Info' button).  So the include/exclude refers to whether
they are in the set.  Once you have selected the set then you can keep or
delete that set.

I could just remove the keep/delete option and make it just 'Keep' but
sometimes it would be easier to define just the reflections that you want to
delete.

I could try to expand the wording somewhat to

Keep/delete the selected set of reflections

The selected set of reflections includes/excludes reflections ( the big menu )

Does this help.-->

<p>See program documentation:
<a href="../../../../html/sftools.html" target="_PROGDOC">SFTOOLS</a>,
<a href="../../../../html/mtzutils.html" target="_PROGDOC">MTZUTILS</a>,
<a href="../../../../html/reindex.html" target="_PROGDOC">REINDEX</a>,
<a href="../../../../html/cad.html" target="_PROGDOC">CAD</a></p>

<h3><a name="cad1"></a><a name="cad"></a>Merge MTZ Files (CAD)</h3>

<p>This task interfaces to the CAD program which can be used to:</p>
<ol type="a">
<li>Delete columns from an MTZ file</li>
<li>Merge data from two or more MTZ files</li>
<li>Reset the resolution range in the MTZ file(s)</li>
<li>Change the sort order or HKL limits or space group</li>
</ol>

<p>To input more than one MTZ file, click on the <tt>Add input MTZ file</tt> button.
By default all the data in the input MTZ file is put into the output file but you can
change the Input option from 'all columns' to 'selected columns' and then select the
columns using the <tt>Add column</tt> button. If you want to have the majority of the
columns in the file, then click on the <tt>List All Columns</tt> button and then delete
the columns you do not require using the <tt>Delete selected item</tt> option under the
<tt>Edit list</tt> menu button. You will then need to select the column by clicking on
one of the fields for that column with the right mouse button. See also
<a href="../general/intro.html#extending_frames" target="_self">Extending Frames and
Toggle Frames</a>.</p>

<p><em>CAD can not deal with more than 29 columns.</em></p>

<p><em>Do not include columns H, K and L in input. These are transferred
to output automatically, and only upset the program.</em></p>

<p><a name="cad_uv"></a>Two special data types are used to signal that
you are preparing data for translation functions of various types. They are:</p>
<dl compact="compact">
<dt>U</dt><dd>partial FC</dd>
<dt>V</dt><dd>partial PHIC</dd>
</dl>
<p>There must be only one FCpart PHICpart per input file, and they must be the last items specified for
LABIN. CAD generates equivalent reflections using only the ROTATIONAL part of the primitive
symmetry operator (<em>i.e.</em> if the spacegroup is P212121, these reflections are analysed as
though the spacegroup was P222). This is allowed for in the
<a href="../../../../html/tffc.html" target="_PROGDOC">TFFC</a> and
<a href="../../../../html/rsearch.html" target="_PROGDOC">RSEARCH</a> programs.</p>

<h4><a name="cad_layout"></a>CAD - Task Window Layout</h4>

<p>Features to look out for in the CAD Task are:</p>
<table border="1">
<tr><th>Folder title</th><th>Importance</th>
<th>Comment</th></tr>
<tr><td>Define MTZ Output</td><td>override space group,
cell dimensions, <a name="cad_sort"></a>sort order, hkl limits <em>etc.</em></td>
<td>can also be done with
<a href="../../../../html/sftools.html" target="_PROGDOC">SFTOOLS</a>, see
<a href="#sftools_sort" target="_self">above</a></td></tr>
</table>

<p>See program documentation:
<a href="../../../../html/cad.html" target="_PROGDOC">CAD</a>,
<a href="../../../../html/sftools.html" target="_PROGDOC">SFTOOLS</a></p>

<h3><a name="edit_dname"></a>Edit MTZ Datasets</h3>

<p>The columns of an MTZ file are divided between a number of datasets,
which are each identified by a Crystal name (XNAME) and a Dataset name (DNAME).
Crystals in turn belong to a Project (PNAME).
See the description of <a href="../../../../html/harvesting.html" target="_PROGDOC">
Data Harvesting</a> for background information. The program CAD can be used
to change the attributes of a dataset, and to change the assignment of columns
to datasets, and this functionality is accessible through the Edit MTZ 
Datasets interface.</p>

<p>The top half of the interface lists the current datasets and their attributes.
Any attribute can be edited, and datasets may be added or deleted. The lower
half provides a pull-down menu for each column allowing the user to select
a dataset from the current list. Note that the input to CAD is taken from the
list of columns, so that surplus datasets are ignored, and datasets deleted
from the dataset list but retained in the column list are kept.</p>

<p>In principle, dataset information should be generated and propagated
automatically, so this interface should only be needed to fix problems.</p>

<p>See <a href="../general/harvesting.html" target="_self">Data Harvesting in CCP4i</a>
for implications for the Interface.</p>

<p>See program documentation:
<a href="../../../../html/cad.html" target="_PROGDOC">CAD</a></p>

<h3><a name="reindex"></a>Reindex Reflections - Reindex</h3>

<p>This is the option to use for reindexing 'standard' MTZ files, <em>i.e.</em> non-multi-record MTZ.</p>

<p>See program documentation:
<a href="../../../../html/reindex.html" target="_PROGDOC">REINDEX</a></p>

<h3><a name="sfanal"></a>SF File Analysis (SFTOOLS)</h3>

<p>This is an interface to the data analysis tools of SFTOOLS which will perform several forms
of analysis of Structure Factor data. The user should select an MTZ file and the data columns to
analyse. The results are displayed automatically by
<a href="../general/loggraph.html" target="_self">The Loggraph Utility</a>.
The results are also saved in a .log file which can subsequently be viewed with the
<a href="../general/intro.html#view_files_from_job_menu_bar" target="_self">View Log Graphs</a> option
in the <strong>View Files from Job</strong> menu on the right hand side of the Main Window of CCP4i.</p>

<p>See program documentation:
<a href="../../../../html/sftools.html" target="_PROGDOC">SFTOOLS</a></p>

<h3><a name="phistats"></a>Phase Analysis (Phistats)</h3>

<p>This task will take an MTZ file with two phase sets and analyse the 
differences between them. </p>

<p>See program documentation:
<a href="../../../../html/phistats.html" target="_PROGDOC">PHISTATS</a></p>

<h3><a name="sigmaa"></a>Sigma-A</h3>

<p>See program documentation:
<a href="../../../../html/sigmaa.html" target="_PROGDOC">SIGMAA</a></p>

<h3><a name="hltofom"></a>Convert FoM to/from HL</h3>

<p>Run the Clipper utility HLTOFOM to convert between Hendrickson-Lattman (HL)
coefficients and phase/figure-of-merit (Phi/FoM) representations. This can
be useful if data is in one representation but a particular task requires that
data in the other.</p>

<h3><a name="phasematch"></a><a name="phasematch1"></a>Phase Comparison</h3>

<p>Perform analysis and comparison of two phase sets. This task allows
the comparison of phase sets in different representations: map coefficients
(amplitude and phase angles), Hendrickson-Lattman coefficients, or phase and
weight (phase angle plus figure-of-merit).</p>

<h3><a name="ecalculate"></a>Calculate E's</h3>

<p>Run the Clipper CECALC utility to generate normalised structure factor
amplitudes from reflection data in an MTZ file.</p>

<h3><a name="phasecombine"></a>Combine Phases</h3>

<p>Combine two phase sets both expressed as Hendrickson-Lattman coefficients.</p>

<h3><a name="sfcalcmap"></a>Map to Structure Factors</h3>

<p>Use the Clipper CINVFFT program to generate structure factors from
an existing map.</p>

<h3><a name="sfcalcmodel"></a>Model to Structure Factors</h3>

<p>Use the Clipper CSFCALC program to generate structure factors from
an existing model (set of atomic coordinates).</p>

<h3><a name="sfweight"></a>Calculate Sigma-A Weights</h3>

<p>Use the Clipper CSIGMAA program to generate sigma-A weights structure
factors calculated structure factors.</p>

<table border="0" width="100%">
<tr><td>
<a href="coord_utils.html" target="_self">
<img border="0" class="navbutton" src="../images/3Dnexttr.gif" alt="next button" /></a>
<a href="maputils.html" target="_self">
<img border="0" class="navbutton" src="../images/3Dprevtr.gif" alt="previous button" /></a>
<a href="../index.html" target="_top">
<img border="0" class="navbutton" src="../images/3Dtoptr.gif" alt="top button" /></a>
</td>
<td align="right"><a href="http://validator.w3.org/" target="_EXTERNAL">Valid XHTML 1.0!</a>
<a href="http://jigsaw.w3.org/css-validator/" target="_EXTERNAL">Valid CSS!</a></td></tr>
</table>

</body>
</html>
