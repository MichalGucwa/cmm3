from phaser import *
i = InputMR_DAT()
i.setHKLI("beta_blip.mtz")
i.setLABI("Fobs","Sigma")
i.setHIRES(6.0)
r = runMR_DAT(i)
print r.summary()
i = InputMR_AUTO()
i.setSPAC_HALL(r.getSpaceGroupHall())
i.setCELL6(r.getUnitCell())
i.setREFL(r.getMiller(),r.getFobs(),r.getSigFobs())
i.setROOT("beta_blip_auto")
i.addENSE_PDB_ID("beta","beta.pdb",1.0)
i.addENSE_PDB_ID("blip","blip.pdb",1.0)
i.addCOMP_PROT_MW_NUM(28853,1)
i.addCOMP_PROT_MW_NUM(17522,1)
i.addSEAR_ENSE_NUM("beta",1)
i.addSEAR_ENSE_NUM("blip",1)
del(r)
r = runMR_AUTO(i)
print r.summary()
if r.foundSolutions() :
  print "Phaser has found MR solutions"
  print "Top LLG = %f" % r.getTopLLG()
  print "Top PDB file = %s" % r.getTopPdbFile()
else:
  print "Phaser has not found any MR solutions"
