from phaser import *
i = InputEP_DAT()
HKLIN = "S-insulin.mtz"
xtalid = "insulin"
waveid = "cuka"
i.setHKLI(HKLIN)
i.addCRYS_ANOM_LABI(xtalid,waveid,"F(+)","SIGF(+)","F(-)","SIGF(-)")
i.setMUTE(True)
r = runEP_DAT(i)
if r.Success():
  hkl = r.getMiller()
  Fpos = r.getFpos(xtalid,waveid)
  Ppos = r.getPpos(xtalid,waveid)
  Fneg = r.getFneg(xtalid,waveid)
  Pneg = r.getPneg(xtalid,waveid)
  print "Data read from: " , HKLIN
  print "Spacegroup Name (Hall symbol) = %s (%s)" % \
   (r.getSpaceGroupName(), r.getSpaceGroupHall())
  print "Unitcell = " , r.getUnitCell()
  nrefl = min(10,hkl.size())
  print "First ", nrefl , " reflections with anomalous differences"
  print "%4s %4s %4s %10s %10s %10s" % ("H","K","L","F(+)","F(-)","D")
  i = 0
  r = 0
  while r < nrefl:
    if Ppos[i] and Pneg[i] :
      D = abs(Fpos[i]-Fneg[i])
      if D > 0:
        print "%4d %4d %4d %10.4f %10.4f %10.4f" % \
          (hkl[i][0],hkl[i][1],hkl[i][2],Fpos[i],Fneg[i],D)
        r=r+1
    i=i+1
else:
  print "Job exit status FAILURE"
  print r.ErrorName(), "ERROR :", r.ErrorMessage()

