<html>
<head><title>CCP4 Program Suite: harvlib</title></head>
<body>

<!-- ::INDEX_INFO::HARVLIB::Library::Data Harvesting and Datasets::Subroutine library for writing CIF harvest files:::::::: -->

<H1>HARVLIB (CCP4: Library)</H1>

<H2>NAME</H2>

<p>Harvlib - Subroutine library for writing CIF harvest files.



<H2>OVERVIEW</H2>

<p>The following subroutines are used by certain CCP4 programs when writing out harvest files. These subroutines call functions in the CCIF library.



<H2>DESCRIPTION OF ROUTINES</H2>
<dl>
<dt><h3>SUBROUTINE Hatom_type_scat(AtName,a1,a2,a3,a4,b1,b2,b3,b4,c)</h3>
<p><dt><b>Arguments:</b>
<dd><table noborder><tr valign="TOP"><td>Character <td>AtName*(*)
<dd><tr valign="TOP"><td>Real      <td>a1,a2,a3,a4,b1,b2,b3,b4,c
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>_atom_type.symbol    
<td>Element symbol of atom specie(s) representing this atom type.
<tr valign="TOP"><td>_atom_type.scat_Cromer_Mann_a1  
<td>The a1 Cromer-Mann scattering-factor coefficient used to calculate the scattering factors for this atom type.
<tr valign="TOP"><td>_atom_type.scat_Cromer_Mann_a2  
<td>The a2 Cromer-Mann scattering-factor coefficient used to calculate the scattering factors for this atom type.
<tr valign="TOP"><td>_atom_type.scat_Cromer_Mann_a3
<td>The a3 Cromer-Mann scattering-factor coefficient used to calculate the scattering factors for this atom type.
<tr valign="TOP"><td>_atom_type.scat_Cromer_Mann_a4
<td>The a4 Cromer-Mann scattering-factor coefficient used to calculate the scattering factors for this atom type.
<tr valign="TOP"><td>_atom_type.scat_Cromer_Mann_b1
<td>The b1 Cromer-Mann scattering-factor coefficient used to calculate the scattering factors for this atom type.
<tr valign="TOP"><td>_atom_type.scat_Cromer_Mann_b2
<td>The b2 Cromer-Mann scattering-factor coefficient used to calculate the scattering factors for this atom type.
<tr valign="TOP"><td>_atom_type.scat_Cromer_Mann_b3
<td>The b3 Cromer-Mann scattering-factor coefficient used to calculate the scattering factors for this atom type.
<tr valign="TOP"><td>_atom_type.scat_Cromer_Mann_b4
<td>The b4 Cromer-Mann scattering-factor coefficient used to calculate the scattering factors for this atom type.
<tr valign="TOP"><td>_atom_type.scat_Cromer_Mann_c
<td>The c Cromer-Mann scattering-factor coefficient used to calculate the scattering factors for this atom type.
</table>

<p><br>
<dt><h3>SUBROUTINE HCell(Cell)</h3>
<p><dt><b>Arguments:</b>
<dd><table noborder><tr valign="TOP"><td>Real  <td>Cell(6)
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _cell.length_a
<td>        Unit-cell length a corresponding to the structure reported.

<tr valign="TOP"><td>    _cell.length_b
<td>        Unit cell length b corresponding to the structure reported.

<tr valign="TOP"><td>    _cell.length_c
 <td>       Unit cell length c corresponding to the structure reported.

<tr valign="TOP"><td>    _cell.length_alpha
<td>        Unit cell angle alpha corresponding to the structure reported.

<tr valign="TOP"><td>    _cell.length_beta
<td>        Unit cell angle beta corresponding to the structure reported.

<tr valign="TOP"><td>    _cell.length_gamma
<td>        Unit cell angle gamma corresponding to the structure reported.
</table>


<p><br><dt><h3>SUBROUTINE Hcell_percent_solvent(Fraction)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real  <td>Fraction
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _exptl_crystal.percent_solvent
<td>        Writes the fraction of cell occupied by solvent calculated from crystal cell and contents, expressed as percent solvent.
</table>


<p><br><dt><h3>SUBROUTINE Hdata_reduction_method(Method,Nlines)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer    <td>Nlines
    <tr valign="TOP"><td>Character  <td>Method(Nlines)*80
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _reflns.data_reduction_method
<td>        The method used in reducing the data. Note that this is not the computer program used, which is described in the SOFTWARE category, but the method itself.
</table>


<p><br><dt><h3>SUBROUTINE Hdensity_Matthews(Fraction)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real  <td>Fraction
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _exptl_crystal.density_Matthews
<td>        The density of the crystal, expressed as the ratio of the volume of the asymmetric unit to the molecular mass of a monomer of the structure, in units of angstroms^3^ per dalton. Ref: Matthews, B. W. (1960). J. Mol. Biol., 33, 491-497
</table>


<p><br><dt><h3>SUBROUTINE Hinitialise(Pkage,ProgName,ProgVersion,ProjectName,DataSetName,UseCWD,Private, IVALND,VALND,RowLimit)</h3>
<p><dr><b>Arguments:</b>
<dd><table noborder><tr valign="TOP"><td>Real  <td>VALND
<tr valign="TOP"><td>Integer  <td>IVALND,RowLimit
<tr valign="TOP"><td>Logical  <td>Private,UseCWD
<tr valign="TOP"><td>Character  <td>DataSetName*(*),ProjectName*(*),ProgVersion*(*),ProgName*(*),Pkage*(*)
</table>
<p><dt><b>Does the following:</b>
<dd><tr valign="TOP"><td>Checks if $HARVESTHOME/DepositFiles directory exists and permissions; creates filename for deposit information; sets Project Name and Dataset Name; 


<p><br><dt><h3>SUBROUTINE Hmerge_reject_criterion(Rcriteria,Nlines)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer    <td>Nlines
    <tr valign="TOP"><td>Character  <td>Rcriteria(Nlines)*80
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _reflns.merge_reject_criterion
<td>        Criteria used in averaging equivalent Intensities during the data reduction stage to generate the set of reduced unique data. The description of the rejection criteria for outliers that was used may include the criteria for either the scaling and for the merging of a set of observations.
</table>


<p><br><dt><h3>SUBROUTINE Hoverall_observations(Ntotal,R1,R2)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer  <td>Ntotal
    <tr valign="TOP"><td>Real     <td>R1,R2
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _reflns.overall_d_resn_high
<td>        The highest resolution for the interplanar spacing for the number of reflections processed from the complete set of images collected. This is the smallest d value. Units (Angstroms or nanometres) should be specified.
<tr valign="TOP"><td>    _reflns.overall_d_res_low
<td>        The lowest resolution for the interplanar spacing for the number of reflections processed from the complete set of images collected. This is the largest d value. Units (Angstroms or nanometres) should be specified.
<tr valign="TOP"><td>    _reflns.overall_number_observations
<td>        The total number of observations of reflections processed from the complete set of images collected within the resolution limits _reflns.overall_d_res_low and _reflns.overall_d_res_high. This is a count of the number of experimental measurements of Bragg intensities made in the experiment, not the number of merged (unique) reflections. The value of _reflns.observed_criterion DOES NOT apply to this set of reflections.
</table>


<p><br><dt><h3>SUBROUTINE Hparse(line,Ibeg,Iend,Ityp,Fvalue,Cvalue,Idec,N)</h3>
<p><dt><b>Arguments:</b>
<dd><table noborder><tr valign="TOP"><td>Character  <td>line
    <tr valign="TOP"><td>Integer     <td>Ibeg(*),Idec(*),Iend(*),Ityp(*)
    <tr valign="TOP"><td>Character     <td>Cvalue(*)*4
</table>
<p><dt><b>Does the following:</b>
<dd>
<tr valign="TOP"><td>Free format read routine.  This is really a scanner, not a parser. It scans the line into N tokens which are separated by delimiters and updates the information arrays for each, as below.  The default delimiters are space, tab, comma and equals; they may be changed using PARSDL.  Adjacent commas delimit `null' fields (the same as empty strings).  strings may be unquoted or single- or double-quoted if they don't contain delimiters, but must be surrounded by delimiters to be recognised.  This allows literal quotes to be read, e.g. "ab"c" will be recognised as the token `ab"c'. An unquoted `!' or `#' in line introduces a trailing comment, which is ignored.


<p><br><dt><h3>SUBROUTINE Hphasing_mir_der_p2(Power,RCullis,Reflns)</h3>
<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real       <td>Resomin(2,*),Resoman(2,*),Criteria(*)
    <tr valign="TOP"><td>Integer    <td>NumSitesDer(*)
    <tr valign="TOP"><td>Character  <td>DerID(*)*80
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>_phasing_MIR_der.id<td>The value of _phasing_MIR_der.id must uniquely identify a record in the PHASING_MIR_DER list. Note that this item need not be a number; it can be any unique identifier.
<tr valign="TOP"><td>_phasing_MIR_der.number_of_sites<td>The number of heavy atom sites in this derivative.    
<tr valign="TOP"><td>_phasing_MIR_der.d_res_high   <td>The highest resolution for the interplanar spacing in the
               reflection data used for this derivative. This is the smallest
               d value. 
<tr valign="TOP"><td>_phasing_MIR_der.d_res_low    <td>The lowest resolution for the interplanar spacing in the
               reflection data used for this derivative. This is the highest
               d value.
<tr valign="TOP"><td>_phasing_MIR_der.ceflns_criteria <td>Criteria used to limit the reflections used in the phasing
               calculations.   
<tr valign="TOP"><td>_phasing_MIR_der.Power_centric   <td>The mean phasing power P for centric reflections in this
               derivative. 
<tr valign="TOP"><td>_phasing_MIR_der.Power_acentric  <td>The mean phasing power P for acentric reflections in this
               derivative.  
<tr valign="TOP"><td>_phasing_MIR_der.R_cullis_centric <td>Residual factor R~cullis~ for centric reflections in this
               derivative.   
<tr valign="TOP"><td>_phasing_MIR_der.R_cullis_acentric<td>Residual factor R~cullis,acen~ for acentric reflections in this
               derivative.    
<tr valign="TOP"><td>_phasing_MIR_der.R_cullis_anomalous<td>Residual factor R~cullis,ano~ for anomalous reflections in this
               derivative.    
<tr valign="TOP"><td>_phasing_MIR_der.Reflns_acentric <td>The number of acentric reflections used in phasing for this
               derivative.   
<tr valign="TOP"><td>_phasing_MIR_der.Reflns_anomalous <td>The number of anomalous reflections used in phasing for this               derivative.   
<tr valign="TOP"><td>_phasing_MIR_der.Reflns_centric  <td>The number of centric reflections used in phasing for this
               derivative.  
</table>


<p><br><dt><h3>SUBROUTINE Hphasing_mir_der_site(DerID,NumDerSites,B,Atype,X,Y,Z,Occ,OccEsd,anom,AnomEsd)</h3>
<p><dt><b>Arguments:</b>
<dd><table noborder><tr valign="TOP"><td>Real     <td>anom(*),AnomEsd(*),B(*),Occ(*),OccEsd(*),X(*),Y(*),Z(*)
    <tr valign="TOP"><td>Character  <td>Atype(*)*4
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>_phasing_MIR_der_site.der_id<td>This data item is a pointer to _phasing_MIR_der.id in the PHASING_MIR_DER category.
<tr valign="TOP"><td>_phasing_MIR_der_site.atom_type_symbol<td>This data item is a pointer to _atom_type.symbol in the ATOM_TYPE category. The scattering factors referenced via this data item should be those used in the refinement of the heavy atom data; in some cases this is the scattering factor to the single heavy atom, in others these are the scattering factors for an atomic cluster.
<tr valign="TOP"><td>_phasing_MIR_der_site.fract_x<td>The x coordinate of this heavy-atom position in this derivative
               specified as a fraction of _cell.length_a.
<tr valign="TOP"><td>_phasing_MIR_der_site.fract_y<td>The y coordinate of this heavy-atom position in this derivative
               specified as a fraction of _cell.length_b.
<tr valign="TOP"><td>_phasing_MIR_der_site.fract_z<td>The z coordinate of this heavy-atom position in this derivative
               specified as a fraction of _cell.length_c.
<tr valign="TOP"><td>_phasing_MIR_der_site.B_iso<td>Isotropic temperature factor for this heavy-atom site in this
               derivative.
<tr valign="TOP"><td>_phasing_MIR_der_site.Occupancy_iso<td>The relative real isotropic occupancy of the atom type
               present at this heavy-atom site in a given derivative.
               This atom occupancy will probably be on an arbitrary scale.
<tr valign="TOP"><td>_phasing_MIR_der_site.Occupancy_iso_su<td>The standard uncertainty (e.s.d.) of
               _phasing_MIR_der_site.occupancy_iso.
<tr valign="TOP"><td>_phasing_MIR_der_site.Occupancy_anom<td>The relative anomalous occupancy of the atom type
               present at this heavy-atom site in a given derivative.
               This atom occupancy will probably be on an arbitrary scale.
<tr valign="TOP"><td>_phasing_MIR_der_site.Occupancy_anom_su<td>The standard uncertainty (e.s.d.) of
               _phasing_MIR_der_site.occupancy_anom.
</table>


<p><br><dt><h3>SUBROUTINE Hphasing_mir_native(R1,R2,SigmaNat,fomT,fomC,fomA,Mt,Mc,Ma)</h3>
<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real     <td>R1,R2,fomT,fomC,fomA,SigmaNat
    <tr valign="TOP"><td>Integer  <td>Mt,Mc,Ma
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _phasing_MIR.entry_id
<td>        This data item is a pointer to _entry.id in the ENTRY category.
<tr valign="TOP"><td>    _phasing_MIR.d_res_high
<td>        The highest resolution in angstroms for the interplanar spacing in the reflection data used for the native data set. This is the smallest d value.
<tr valign="TOP"><td>    _phasing_MIR.d_res_low
<td>        The lowest resolution in angstroms for the interplanar spacing in the reflection data used for the native data set. This is the largest d value.
<tr valign="TOP"><td>    _phasing_MIR.FOM
<td>        The mean value of the figure of merit m for all reflections phased in the native data set.
<tr valign="TOP"><td>    _phasing_MIR.FOM_centric
 <td>       The mean value of the figure of merit m for the centric reflections phased in the native data set.
<tr valign="TOP"><td>    _phasing_MIR.FOM_acentric
<td>        The mean value of the figure of merit m for the acentric reflections phased in the native data set.
<tr valign="TOP"><td>    _phasing_MIR.reflns
<td>        The total number of reflections phased in the native data set.
<tr valign="TOP"><td>    _phasing_MIR.reflns_centric
<td>        The number of centric reflections phased in the native data set.
<tr valign="TOP"><td>    _phasing_MIR.reflns_acentric
 <td>       The number of acentric reflections phased in the native data set.
<tr valign="TOP"><td>    _phasing_MIR.reflns_criterion
 <td>       Criterion used to limit the reflections used in the phasing calculations.
</table>

<p><br><dt><h3>SUBROUTINE Hphasing_mir_native_shell(R1,R2,KRa,fomA,KRc,fomC,KRo,fomO)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real     <td>R1,R2,KRa,fomA,KRc,fomC,KRo,fomO
    <tr valign="TOP"><td>Integer  <td>KRa,KRc,KRo
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _phasing_MIR_shell.d_res_high
<td>        The highest resolution for the interplanar spacing in the reflection data in this shell. This is the smallest d value. Note that the resolution limits of shells in the items _phasing_MIT_Shell.d_res_high and _phasing_MIR_shell.d_res_low are independent of the resolution limits of shells in the items _reflns_shell.d_res_high and _reflns_shell.d_res_low.
<tr valign="TOP"><td>    _phasing_MIR_shell.d_res_low
 <td>       The lowest resolution for the interplanar spacing in the reflection data in this shell. This is the largest d value. Note that the resolution limits of shells in the items _phasing_MIT_Shell.d_res_high and _phasing_MIR_shell.d_res_low are independent of the resolution limits of shells in the items _reflns_shell.d_res_high and _reflns_shell.d_res_low.
<tr valign="TOP"><td>    _phasing_MIR_shell.FOM
<td>        The mean value of the figure of merit m for reflections in this shell.
<tr valign="TOP"><td>    _phasing_MIR_shell.FOM_centric
<td>        The mean value of the figure of merit m for centric reflections in this shell.
<tr valign="TOP"><td>    _phasing_MIR_shell.FOM_acentric
 <td>       The mean value of the figure of merit m for acentric reflections in this shell.
<tr valign="TOP"><td>    _phasing_MIR_shell.reflns
 <td>       The number of reflections in this shell.
<tr valign="TOP"><td>    _phasing_MIR_shell.reflns_centric
<td>        The number of centric reflections in this shell.
<tr valign="TOP"><td>    _phasing_MIR_shell.reflns_acentric
<td>        The number of acentric reflections in this shell.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_corr_esu(Corr,FreeCorr,DPI,FreeESU,Good,GoodFree,ESUml,bESU)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real     <td>Corr,FreeCorr,DPI,FreeESU,Good,GoodFree,ESUml,bESU
    <tr valign="TOP"><td>Integer  <td>Lenstr
</table>
<p><br><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.correlation_coeff_Fo_to_Fc
<td>        The correlation coefficient between the observed and calculated structure factors for reflections included in the refinement.
<tr valign="TOP"><td>    _refine.correlation_coeff_Fo_to_Fc_Free
<td>        The correlation coefficient between the observed and calculated structure factors for reflections not included in the refinement (free reflections).
<tr valign="TOP"><td>    _refine.goodness_of_fit_work
 <td>       NO DESCRIPTION
<tr valign="TOP"><td>    _refine.goodness_of_fit_FreeR
<td>        NO DESCRIPTION
<tr valign="TOP"><td>    _refine.overall_SU_ML
<td>        The overall standard uncertainty (e.s.d.) of the positional parameters based on a maximum likelihood residual.
<tr valign="TOP"><td>    _refine.overall_SU_B
<td>        The overall standard uncertainty (e.s.d.) of the thermal parameters based on a maximum likelihood residual.
<tr valign="TOP"><td>    _refine.overall_SU_R_Cruickshank_DPI
<td>        The overall standard uncertainty (e.s.d.) of the thermal parameters based on the crystallographic R value, expressed in a formalism known as the dispersion precision indicator (DPI).
<tr valign="TOP"><td>    _refine.overall_SU_R_free
<td>        The overall standard uncertainty (e.s.d.) of the thermal parameters based on the free R value.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_details(NHlines,Hlines)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer    <td>NHlines
    <tr valign="TOP"><td>Character  <td>Hlines(NHlines)*80
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.ls_weighting_details
<td>        A description of special aspects of the weighting scheme used in least-squares refinement. Used to describe the weighting when the value of _refine.ls_weighting_scheme is specified as 'calc'.
<tr valign="TOP"><td>   _refine.ls_weighting_scheme
<td>        The weighting scheme applied in the least-squares process. The standard code may be followed by a description of the weight (but see _refine_ls_weighting_details for a preferred approach).
<tr valign="TOP"><td>    _refine.details
<td>        Description of special aspects of the refinement process.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_fnmin(Nval,Nterms,Vterms,Cterms,Wterms)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real        <td>Vterms(*),Wterms(*)
    <tr valign="TOP"><td>Integer    <td> Nterms(*)
    <tr valign="TOP"><td>Character  <td> Cterms(Nval)*80
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine_funct_minimized.type
 <td>       The type of the function being minimized.
<tr valign="TOP"><td>    _refine_funct_minimized.number_terms
<td>        The number of observations in this term. For example, if the term is a residual of the X-ray intensities this item would contain the number of reflections used in the refinement.
<tr valign="TOP"><td>    _refine_funct_minimized.residual
<td>        The residual for this term of the function which was minimized in refinement.
<tr valign="TOP"><td>    _refine_funct_minimized.weight
<td>        The weight applied to this term of the function which was minimized in the refinement.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_fom(fom,Freefom)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real <td>fom,Freefom
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.overall_FOM_work_R_set
 <td>       Average figure of merit of phases of reflections not included in the refinement. This value is derived from the likelihood function.
<tr valign="TOP"><td>    _refine.overall_FOM_free_R_set
 <td>       Average figure of merit of phases of reflections included in the refinement. This value is derived from the likelihood function.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_ls_matrix_type(STRING)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Character <td>String*(*)
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.ls_matrix_type
 <td>       Type of matrix used to accumulate the least-squares derivatives.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_ls_overall_reso(R1,R2)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real  <td>R1,R2
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.ls_d_res_high
 <td>       The highest resolution in angstroms for the interplanar spacing in the reflection data used in refinement. This is the smallest d value.
<tr valign="TOP"><td>    _refine.ls_d_res_low
 <td>       The lowest resolution in angstroms for the interplanar spacing in the reflection data used in refinement. This is the largest d value.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_NparNrestNconstr(NPARMR,NRESTR,NCONSTR)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer  <td>NPARMR,NRESTR,NCONSTR
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.ls_number_parameters
<td>        The number of parameters refined in the least-squares process. If possible this number should include some contribution from the restrained parameters. The restrained parameters are distinct from the constrained parameters (where one or more parameters are linearly dependent on the refined value of another). Least-squares restraints often depend on geometry or energy considerations and this makes their direct contribution to this number, and to the goodness-of-fit calculation, difficult to assess.
<tr valign="TOP"><td>    _refine.ls_number_restraints
<td>        The number of restrained parameters. These are parameters which are not directly dependent on another refined parameter. Often restrained parameters involve geometry or energy dependencies. See also _atom_site.constraints and _atom_site_refinement_flags. A general description of refinement constraints may appear in _refine.details.
<tr valign="TOP"><td>    _refine.ls_number_constraints
 <td>       The number of constrained (non-refined or dependent) parameters in the least-squares process. These may be due to symmetry or any other constraint process (e.g. rigid-body refinement). See also _atom_site.constraints and _atom_site_refinement_flags. A general description of constraints may appear in _refine.details.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_obscriteria(Criteria)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real  <td>Criteria
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
 <tr valign="TOP"><td>   _reflns.observed_criterion
<td>        The criterion used to classify a reflection as 'observed'. This criterion is usually expressed in terms of a sigma(I) or sigma(F) threshold.
</table>


<p><br><dt><h3>SUBROUTINE Hrefine_restraints(Rtype,Num,rmsd,sigd,criteria,Nreject)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Character  <td>Rtype*(*),criteria*(*)
    <tr valign="TOP"><td>Integer    Num,Nreject
    <tr valign="TOP"><td>Real       rmsd,sigd
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine_ls_restr.type
 <td>       The type of the parameter being restrained. Explicit sets of data values are provided for the programs PROTIN/PROLSQ (beginning with p_) and RESTRAIN (beginning with RESTRAIN_). As computer programs will evolve, these data values are given as examples, and not as an enumeration list. Computer programs converting a data block to a refinement table will expect the exact form of the data values given here to be used.
<tr valign="TOP"><td>    _refine_ls_restr.number
<td>        The number of parameters of this type subjected to restraint in least-squares refinement.
<tr valign="TOP"><td>    _refine_ls_restr.dev_ideal
 <td>       For the given parameter type, the root-mean-square deviation between the ideal values used as restraints in the least-squares refinement and the values obtained by refinement. For instance, bond distances may deviate by 0.018 \%A (r.m.s.) from ideal values in current model.
<tr valign="TOP"><td>    _refine_ls_restr.dev_ideal_target
<td>        For the given parameter type, the target root-mean-square deviation between the ideal values used as restraints in the least-squares refinement and the values obtained by refinement.
 <tr valign="TOP"><td>   _refine_ls_restr.rejects
 <td>       The number of parameters of this type that deviate from ideal values by more than the amount defined in _refine_ls_restr.criterion in the model obtained by restrained least-squares refinement.
<tr valign="TOP"><td>    _refine_ls_restr.criterion
 <td>       A criterion used to define a parameter value that deviates significantly from its ideal value in the model obtained by restrained least-squares refinement.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_rfacts(Nall,Nobs,Nmiss,Nwork,Nfree,NfreeMiss,PercentObs,PercentFree,Rall,Robs,Rwork,Rfree, Wall,Wobs,Wwork,Wfree)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer   <td>Nall,Nobs,Nmiss,Nwork,Nfree,NfreeMiss
    <tr valign="TOP"><td>Real      <td>PercentObs,PercentFree,Rall,Robs,Rwork,Rfree,Wall,Wobs,Wwork,Wfree
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.ls_number_reflns_all
<td>        The number of reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low.
<tr valign="TOP"><td>    _refine.ls_number_reflns_obs
<td>        The number of reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion.
<tr valign="TOP"><td>    _refine.ls_number_reflns_R_work
<td>        The number of reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the working (i.e. included in refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
<tr valign="TOP"><td>    _refine.ls_number_reflns_R_free
<td>        The number of reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the test (i.e. excluded from refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
<tr valign="TOP"><td>    _refine.ls_percent_reflns_obs
<td>        The number of reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion, expressed as a percentage of the number of geometrically observable reflections that satisfy the resolution limits.
<tr valign="TOP"><td>    _refine.ls_percent_reflns_R_free
 <td>       The number of reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the test (i.e. excluded from refinement) reflections when refinement included calculation of a "free" R factor, espressed as a percentage of the number of geometrically observable reflections that satisfy the resolution limits.
<tr valign="TOP"><td>    _refine.ls_R_factor_all
 <td>       Residual factor R for all reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low.
<tr valign="TOP"><td>    _refine.ls_R_factor_obs
<td>         Residual factor R for reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion. _refine.ls_R_factor_obs should not be confused with _refine.ls_R_factor_R_work; the former reports the results of a refinement in which all observed reflections were used, the latter a refinement in which a subset of the observed reflections were excluded from refinement for the calculation of a "free" R factor. However, it would be meaningful to quote both values if a "free" R factor were calculated for most of the refinement, but all of the observed reflections were used in the final rounds of refinement; such a protocol should be explained in _refine.details.
<tr valign="TOP"><td>    _refine.ls_R_factor_R_work
 <td>       Residual factor R for reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the working (i.e., included in refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details. _refine.ls_R_factor_obs should not be confused with _refine.ls_R_factor_R_work; the former reports the results of a refinement in which all observed reflections were used, the latter a refinement in which a subset of the observed reflections were excluded from refinement for the calculation of a "free" R factor. However, it would be meaningful to quote both values if a "free" R factor were calculated for most of the refinement, but all of the observed reflections were used in the final rounds of refinement; such a protocol should be explained in _refine.details.
<tr valign="TOP"><td>    _refine.ls_R_factor_R_free
<td>        Residual factor R for reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the test (i.e., excluded from refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
<tr valign="TOP"><td>    _refine.ls_wR_factor_all
 <td>       Weighted residual factor wR for all reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low.
<tr valign="TOP"><td>    _refine.ls_wR_factor_obs
<td>        Weighted residual factor wR for reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the obervation limit established by _reflns.observed_criterion.
<tr valign="TOP"><td>    _refine.ls_wR_factor_R_work
<td>        Weighted residual factor wR for reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the working (i.e., included in refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
<tr valign="TOP"><td>    _refine.ls_wR_factor_R_free
<td>        Weighted residual factor wR for reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the test (i.e., excluded from refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
</table>


<p><br><dt><h3>SUBROUTINE Hrefine_rg(RDhigh,RDlow,RGall,RGwork,RGfree)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real  <td>RGall,RGwork,RGfree,RDhigh,RDlow
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine_analyze.RG_d_res_high
<td>        The value of the high-resolution cutoff in angstroms used in calculation of the Hamilton generalized R factor (RG) stored in refine_analyze.RG_work and _refine_analyze.RG_free.
<tr valign="TOP"><td>    _refine_analyze.RG_d_res_low
<td>        The value of the low-resolution cutoff in angstroms used in calculation of the Hamilton generalized R factor (RG) stored in refine_analyze.RG_work and _refine_analyze.RG_free.
<tr valign="TOP"><td>    _refine_analyze.RG_all
<td>        The Hamilton generalised R-factor (see W.C. Hamilton (1965) Acta Cryst., 18, 502-510. ) for all reflections that satisfy the resolution limits established by _refine.ls_d_res_high and _refine.ls_d_res_low.
<tr valign="TOP"><td>    _refine_analyze.RG_work
<td>        The Hamilton generalized R factor for all reflections that satisfy the resolution limits established by _refine_analyze.RG_d_res_high and _refine_analyze.RG_d_res_low  and for those reflections included in the working set when a free R set of reflections are omitted from the refinement.
<tr valign="TOP"><td>    _refine_analyze.RG_free
<td>        The Hamilton generalized R factor for all reflections that satisfy the resolution limits established by _refine_analyze.RG_d_res_high and _refine_analyze.RG_d_res_low for the free R set of reflections that were excluded from the refinement.
<tr valign="TOP"><td>    _refine_analyze.RG_free_work_ratio
 <td>       The observed ratio of RGfree to RGwork. The expected RG ratio is the value that should be achievable at the end of a structure refinement when only random uncorrelated errors exist in data and model provided that the observations are properly weighted. When compared with the observed RG ratio it may indicate that a structure has not reached convergence or a model has been over-refined with no corresponding improvement in the model.
</table>


<p><br><dt><h3>SUBROUTINE Hrefine_rmsobs2dict(Rtype,Clow,Chigh,Usigma)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Character  <td>Rtype*(*)
    <tr valign="TOP"><td>Real       <td>Clow,Chigh,Usigma
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine_ls_restr_type.type
 <td>       This data item is a pointer to _refine_ls_restr.type in the REFINE_LS_RESTR category.
<tr valign="TOP"><td>    _refine_ls_restr_type.distance_cutoff_low
<td>        The lower limit in angstroms of the distance range applied to the current restraint type.
<tr valign="TOP"><td>    _refine_ls_restr_type.distance_cutoff_high
<td>        The upper limit in angstroms of the distance range applied to the current restraint type.
<tr valign="TOP"><td>    _refine_ls_restr_type.U_sigma_weights
 <td>       _refine_ls_restr.U_sigma_weights is a coefficient used in the calculation of the weight for thermal parameter restraints in the program RESTRAIN. The equation used to calculate the actual weight from this coefficient depends upon the value of _refine_ls_restr.type - either "r.m.s. diffs for Uiso atoms at distance *" or "r.m.s. diffs for Uaniso atoms at distance *". A similarity restraint is applied to the thermal parameters of any pair of atoms which are subject to an interatomic distance restraint (i.e. 1-2 and 1-3 bonded atoms).  The thermal parameter restraints are categorized by the distance between the two affected atoms.  The expected r.m.s. differences in thermal parameter, either Uiso or Uaniso, are listed for each shell in  _refine_ls_restr.rmsdev_dictionary.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_shell(Rlow,Rhigh,NrefAll,NrefObs,Nmiss,NrefWork,PercentObs,RfacAll,RfacObs,Nfree,Rfree,Rwork,WgtRfac, WgtRobs,WgtRwork,WgtUsed,Wexpress)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real     <td>Rlow,Rhigh,PercentObs,RfacObs,RfacAll,Rfree,Rwork,WgtRfac,WgtRobs,WgtRwork,Wgtused,Wexpress
    <tr valign="TOP"><td>Integer  <td>NrefAll,NrefObs,Nmiss,NrefWork,Nfree
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine_ls_shell.d_res_high
<td>        The highest resolution for the interplanar spacing in the reflection data in this shell. This is the largest d value.
<tr valign="TOP"><td>    _refine_ls_shell.d_res_low
<td>        The lowest resolution for the interplanar spacing in the reflection data in this shell. This is the smallest d value.
<tr valign="TOP"><td>    _refine_ls_shell.number_reflns_all
<td>        The number of reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low.
<tr valign="TOP"><td>    _refine_ls_shell.number_reflns_obs
<td>        The number of reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low and the observation criterion established by _reflns.observed_criterion.
<tr valign="TOP"><td>    _refine_ls_shell.number_reflns_R_work
<td>        The number of reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the working (i.e., included in refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
<tr valign="TOP"><td>    _refine_ls_shell.percent_reflns_obs
 <td>       The number of reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low and the observation criterion established by _reflns.observed_criterion, expressed as a percentage of the number of geometrically observable reflections that satisfy the resolution limits.
<tr valign="TOP"><td>    _refine_ls_shell.R_factor_all
 <td>       Residual factor R for reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low.
<tr valign="TOP"><td>    _refine_ls_shell.R_factor_obs
<td>        Residual factor R for reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low and the observation criterion established by _reflns.observed_criterion.
<tr valign="TOP"><td>    _refine_ls_shell.number_reflns_R_free
<td>        The number of reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the test (i.e., excluded from refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
<tr valign="TOP"><td>    _refine_ls_shell.R_factor_R_free
<td>        Residual factor R for reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the test (i.e., excluded from refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
<tr valign="TOP"><td>    _refine_ls_shell.R_factor_R_work
<td>        Residual factor R for reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the working (i.e., included in refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
<tr valign="TOP"><td>    _refine_ls_shell.wR_factor_all
 <td>       Weighted residual factor wR for reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low.
<tr valign="TOP"><td>    _refine_ls_shell.wR_factor_obs
 <td>       Weighted residual factor wR for reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low and the observation criterion established by _reflns.observed_criterion.
<tr valign="TOP"><td>    _refine_ls_shell.wR_factor_R_work
 <td>       Weighted residual factor wR for reflections that satisfy the resolution limits established by _refine_ls_shell.d_res_high and _refine_ls_shell.d_res_low and the observation limit established by _reflns.observed_criterion, and that were used as the working (i.e., included in refinement) reflections when refinement included calculation of a "free" R factor. Details of how reflections were assigned to the working and test sets are given in _reflns.R_free_details.
<tr valign="TOP"><td>    _refine_ls_shell.weight_used
<td>        The mean weighting used for the reflections in the resolution limits for the shell. The weights used may for example include experimental sigmas in weighting; or by weighting using average diagonal term of Xray and geometry - same as PROLSQ where weighting equates wmat*average_diagonal_of_geometry  to average_diagonal_of_Xray terms; or Weighting equates wgrad*RMS_gradient_of_geometry to RMS_gradient_of_Xray terms; or The relative weighting for Xray and geom terms is governed by sigma. Wsigma  applied to Xray terms as  1/(Wsigma**2)
<tr valign="TOP"><td>    _refine_ls_shell.weight_exp
 <td>       NO DESCRIPTION IN CIF_MM.DIC
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_solvent_model(NHlines,Hlines)</h3>


<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer    <td>NHlines
    <tr valign="TOP"><td>Character  <td>Hlines(NHline)*80
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.solvent_model_details
<td>        Special aspects of the solvent model used in refinement.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_wght_details(NHlines,Hlines)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer    <td>NHlines
    <tr valign="TOP"><td>Character  <td>Hlines(NHlines)*80
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.ls_weighting_details
<td>        A description of special aspects of the weighting scheme used in least-squares refinement. Used to describe the weighting when the value of _refine.ls_weighting_scheme is specified as 'calc'.
</table>

<p><br><dt><h3>SUBROUTINE Hrefine_wghtScheme(WghtScheme)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Character  <td>WghtScheme*(*)
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refine.ls_weighting_scheme
<td>        The weighting scheme applied in the least-squares process. The standard code may be followed by a description of the weight (but see _refine_ls_weighting_details for a preferred approach).
</table>

<p><br><dt><h3>SUBROUTINE Hrefln_sys_abs(IH,IK,IL,F,SF)</h3>


<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real     <td>F,SF
    <tr valign="TOP"><td>Integer  <td>IH,IK,IL
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _refln_sys_abs.index_h
<td>        Miller index h of the reflection. The values of the Miller indices in the REFLN_SYS_ABS category must correspond to the cell defined by cell lengths and cell angles in the CELL category.
<tr valign="TOP"><td>    _refln_sys_abs.index_k
<td>        Miller index k of the reflection. The values of the Miller indices in the REFLN_SYS_ABS category must correspond to the cell defined by cell lengths and cell angles in the CELL category.
<tr valign="TOP"><td>    _refln_sys_abs.index_l
 <td>       Miller index l of the reflection. The values of the Miller indices in the REFLN_SYS_ABS category must correspond to the cell defined by cell lengths and cell angles in the CELL category.
<tr valign="TOP"><td>    _refln_sys_abs.I
<td>        The measured value of the intensity in arbitrary units.
<tr valign="TOP"><td>    _refln_sys_abs.sigmaI
<td>        The standard uncertainty (e.s.d.) of _refln_sys_abs.I, in arbitrary units.
<tr valign="TOP"><td>    _refln_sys_abs.I_over_sigmaI
<td>        The ratio of _refln_sys_abs.I to _refln_sys_abs.sigmaI.  Used to evaluate whether a reflection that should be systematically absent according to the designated space group is in fact absent.
</table>

<p><br><dt><h3>SUBROUTINE Hreflns(WilsonB,R1,R2,Criteria,AMI,AMF,Nref)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real      <td>WilsonB,R1,R1,AMI,AMF
    <tr valign="TOP"><td>Integer   <td>Nref
    <tr valign="TOP"><td>Character <td>Critera*(*)
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _reflns.B_iso_Wilson_estimate
 <td>       The value of the overall isotropic temperature factor estimated from the slope of the Wilson plot.
<tr valign="TOP"><td>    _reflns.entry_id
 <td>       This data item is a pointer to _entry.id in the ENTRY category.
<tr valign="TOP"><td>    _reflns.data_set_id
 <td>       The value of _reflns.data_set_id identifies the particular data set for which harvest information is presented in the data block.
<tr valign="TOP"><td>    _reflns.d_resolution_high
 <td>       The highest resolution for the interplanar spacings in the reflection data. This is the smallest d value.
<tr valign="TOP"><td>    _reflns.d_resolution_low
  <td>      The lowest resolution for the interplanar spacings in the reflection data. This is the largest d value.
<tr valign="TOP"><td>    _reflns.observed_criterion
 <td>       The criterion used to classify a reflection as 'observed'. This criterion is usually expressed in terms of a sigma(I) or sigma(F) threshold.
<tr valign="TOP"><td>    _reflns.mean&lt;I_over_sigI&gt;_obs_all
  <td>      Overall Mean &lt;I/sigma(I)&gt; for the total ensemble of reflections observed
<tr valign="TOP"><td>    _reflns.mean&lt;F_over_sigF&gt;_obs_all
  <td>      Overall Mean &lt;F/sigma(F)&gt; for the total ensemble of reflections observed
<tr valign="TOP"><td>    _reflns.number_obs
 <td>       The number of reflections in the REFLN list (not the DIFFRN_REFLN list) classified as observed (see _reflns.observed_criterion). This number may contain Friedel equivalent reflections according to the nature of the structure and the procedures used.
</table>

<p><br><dt><h3>SUBROUTINE Hreflns_intensity_shell(Z,ACT,ACO,CT,CO)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real  <td>Z,ACT,ACO,CT,CO
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _EBI_reflns_intensity_shell.Z
 <td>       Z is defined as I/&lt;I&gt; for the range of 4*((Sintheta/Lamda)**2)
<tr valign="TOP"><td>    _EBI_reflns_intensity_shell.NZ_acentric_theory
 <td>       The theoretical acentric wilson Distribution of Intensity magnitudes given in shells of N(Z)
<tr valign="TOP"><td>    _EBI_reflns_intensity_shell.NZ_acentric_observed
 <td>       The observed acentric wilson Distribution of Intensity magnitudes given in shells of N(Z)
<tr valign="TOP"><td>    _EBI_reflns_intensity_shell.NZ_centric_theory
  <td>      The theoretical centric wilson Distribution of Intensity magnitudes given in shells of N(Z)
<tr valign="TOP"><td>    _EBI_reflns_intensity_shell.NZ_centric_observed
 <td>       The observed centric wilson Distribution of Intensity magnitudes given in shells of N(Z)
</table>


<p><br><dt><h3>SUBROUTINE Hreflns_overall_merge_p1(R1,R2,nmeas,nuniq,ncent,nano,fsigi,Rfac,ranom,sdIsignal,fpbias,Ntb)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer  <td>nmeas,nuniq,ncent,nano,Ntb
    <tr valign="TOP"><td>Real     <td>R1,R2,fsigi,Rfac,ranom,sdIsignal,fpbias
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _diffrn_reflns.d_res_high
 <td>       The highest resolution in angstroms for the interplanar spacing for all the reflections merged. This is the smallest d value.
<tr valign="TOP"><td>    _diffrn_reflns.d_res_low
 <td>       The lowest resolution in angstroms for the interplanar spacing for all the reflections merged. This is the largest d value.
<tr valign="TOP"><td>    _diffrn_reflns.meanI_over_sigI_all
 <td>       The ratio of the mean of the intensities of all reflections merged within the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high to the mean of the standard uncertainties of the intensities of all reflections in the same resolution limits.
<tr valign="TOP"><td>    _diffrn_reflns.number_measured_all
 <td>       The total number of reflections measured and used in merging for the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.number_unique_all  
 <td>       The total number of reflections measured which are symmetrically unique after merging for the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.number_centric_all 
 <td>       The total number of reflections measured which are symmetrically unique after merging and classified as centric for the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.number_anomalous_all
 <td>       The total number of reflections measured which are symmetrically unique after merging and that an anomalous difference was present in the overall set of observations, for the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.Rmerge_I_all        
 <td>       The value of Rmerge(I) for all reflections in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.Rmerge_I_anomalous_all
  <td>      The value of Rmerge for anomalous data in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.meanI_over_sd_all     
 <td>       The ratio of the mean of the intensities of all reflections merged in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high, to the average standard deviation derived from experimental SDs, after application of SDFAC SDADD SDB
<tr valign="TOP"><td>    _diffrn_reflns.mean_fract_bias       
 <td>       The overall Mean Fractional partial bias in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high
<tr valign="TOP"><td>    _diffrn_reflns.num_fract_bias_in_mean
  <td>      The overall number of reflections used in the mean Fractional partial bias in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high
</table>


<p><br><dt><h3>SUBROUTINE Hreflns_overall_merge_p2(complt,Rmult,pcv,pcvo,rmeas,rmeaso,anomfrc)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real  <td>complt,Rmult,pcv,pcvo,rmeas,rmeaso,anomfrc
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _diffrn_reflns.percent_possible_all
 <td>       The percentage of geometrically possible reflections represented by all reflections measured in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.multiplicity         
 <td>       The mean number of redundancy for the intensities of all reflections measured in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.PCV                  
 <td>       The pooled standard deviation (the statistically valid measure of the noise level) is divided by the sum of the intensities (the signal level) in the resolution limits _diffrn_reflns.d_res_low and  _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.PCV_mean             
 <td>       The pooled standard deviation (the statistically valid measure of the noise level) is divided by the sum of the intensities (the signal level) in the resolution limits _diffrn_reflns.d_res_low and  _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.Rmeas                
 <td>       The multiplicity-weighted Rmerge relative to I+ or I- in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.Rmeas_mean           
 <td>       The multiplicity-weighted Rmerge relative to overall mean I in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.anom_diff_percent_meas
 <td>       AnomFrc is the % of measured acentric reflections for which an anomalous difference has been measured in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
</table>


<p><br><dt><h3>SUBROUTINE Hreflns_overall_merge_p3(aihmin,aihmax,t1f,nssf,t2f,t3f,t1p,nssp,t2p,t3p)</h3>


<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer <td>nssf, nssp
    <tr valign="TOP"><td>Real    <td>aihmin,aihmax,t1f,t2f,t3f,t1p,t2p,t3p
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _diffrn_reflns.min_intensity
 <td>       The minimum intensity for a reflection measured after scaling and merging in the resolution limits  _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.max_intensity
 <td>       The maximum intensity for a reflection measured after scaling and merging in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.Intensity_rms_fully_recorded
 <td>       The overall mean rms of intensity for all fully recorded reflections in the resolution limits  _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.num_fully_measured
 <td>       The total number of fully recorded reflections merged in the resolution limits  _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.mean_scatter_over_sd_full
  <td>      The mean (scatter/SD) for all fully recorded reflections scaled/merged in the resolution limits  _diffrn_reflns.d_res_low and  _diffrn_reflns.d_res_high by the normal probability analysis of deviations.
<tr valign="TOP"><td>    _diffrn_reflns.sigma_scatter_over_sd_full
 <td>       The sigma (scatter/SD) for all fully  recorded reflections scaled/merged in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high by the normal probability analysis of deviations.
<tr valign="TOP"><td>    _diffrn_reflns.Intensity_rms_partially_recorded
<td>        The overall mean rms of intensity for all partially recorded reflections in the resolution limits  _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.num_partials_measured
 <td>       The total number of partially recorded reflections merged in the resolution limits  _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high.
<tr valign="TOP"><td>    _diffrn_reflns.mean_scatter_over_sd_part
 <td>       The mean (scatter/SD) for all partially  recorded reflections scaled/merged in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high by the normal probability analysis of deviations.
<tr valign="TOP"><td>    _diffrn_reflns.sigma_scatter_over_sd_part
 <td>       The sigma (scatter/SD) for all partially  recorded reflections scaled/merged in the resolution limits _diffrn_reflns.d_res_low and _diffrn_reflns.d_res_high by the normal probability analysis of deviations.
</table>


<p><br><dt><h3>SUBROUTINE Hreflns_scaling_shell(R1,R2,Nref,AI,AF)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real    <td>R1,R2,AI,AF
    <tr valign="TOP"><td>Integer <td>Nref
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _EBI_tmp_reflns_scaling_shell.d_res_high
  <td>      The highest resolution for the interplanar spacing in the reflection data for the dataset in this shell. This is the smallest d value.
<tr valign="TOP"><td>    _EBI_tmp_reflns_scaling_shell.d_res_low
  <td>      The lowest resolution for the interplanar spacing in the reflection data for the dataset in this shell. This is the highest d value.
<tr valign="TOP"><td>    _EBI_tmp_reflns_scaling_shell.num_reflns_observed
  <td>      The total number of reflections in this shell.
<tr valign="TOP"><td>    _EBI_tmp_reflns_scaling_shell.mean&lt;I_over_sigI&gt;_obs
  <td>      Mean &lt;I/sigma(I)&gt; for the total number of reflections in this shell.
<tr valign="TOP"><td>    _EBI_tmp_reflns_scaling_shell.mean&lt;F_over_sigF&gt;_obs
   <td>     Mean &lt;F/sigma(F)&gt; for the total number of reflections in this shell.
</table>


<p><br><dt><h3>SUBROUTINE Hreflns_shell_p1(R1,R2,Nmeas,Nuniq,Ncent,Nanom,fsigi,Rfac,Rcum,Ranom,sdIsignal,fpbias,Npb)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer <td>Nmeas,Nuniq,Ncent,Nanom,Npb
    <tr valign="TOP"><td>Real    <td>R1,R2,fsigi,Rfac,Rcum,Ranom,sdIsignal,FPbias
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _reflns_shell.d_res_high              
 <td>       The highest resolution in angstroms for the interplanar spacing in the reflections in this shell. This is the smallest d value.
<tr valign="TOP"><td>    _reflns_shell.d_res_low
 <td>       The lowest resolution in angstroms for the interplanar spacing in the reflections in this shell. This is the largest d value.
<tr valign="TOP"><td>    _reflns_shell.number_measured_all     
 <td>       The total number of reflections measured for this resolution shell.
<tr valign="TOP"><td>    _reflns_shell.number_unique_all       
 <td>       The total number of measured reflections which are symmetrically unique after merging for this resolution shell.
<tr valign="TOP"><td>    _reflns_shell.number_centric_all      
 <td>       The total number of centric reflections measured for this resolution shell.
<tr valign="TOP"><td>    _reflns_shell.number_anomalous_all    
 <td>       The total number of anomalous reflections measured for this resolution shell.
<tr valign="TOP"><td>    _reflns_shell.Rmerge_I_all            
 <td>       The value of Rmerge(I) for all reflections in a given shell.
<tr valign="TOP"><td>    _reflns_shell.Rmerge_I_all_cumulative 
 <td>       The cumulative Rmerge up to this range of shells
<tr valign="TOP"><td>    _reflns_shell.Rmerge_I_anomalous_all  
 <td>       The value of Rmerge for anomalous data in a given shell.
<tr valign="TOP"><td>    _reflns_shell.meanI_over_sd_all       
 <td>       The ratio of the mean of the intensities of all reflections in this shell to the average standard deviation derived from experimental SDs, after application of SDFAC SDADD SDB
<tr valign="TOP"><td>    _reflns_shell.meanI_over_sigI_all     
  <td>      The ratio of the mean of the intensities of all reflections in this shell to the mean of the standard uncertainties of the intensities of all reflections in the resolution shell.
<tr valign="TOP"><td>    _reflns_shell.mean_fract_bias         
  <td>      The Mean Fractional partial bias in the resolution shell.
<tr valign="TOP"><td>    _reflns_shell.num_fract_bias_in_mean  
  <td>      The number of reflections used in the mean Fractional partial bias in the resolution shell.
</table>

<p><br><dt><h3>SUBROUTINE Hreflns_shell_p2(R1,R2,complt,ccmplt,amltpl,pcvo,pcv,rmeas,rmeaso,anomfrc)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Real   <td>complt,ccmplt,amltpl,pcvo,pcv,rmeas,rmeaso,anomfrc,R1,R2
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _reflns_shell.percent_possible_all     
  <td>      The percentage of geometrically possible reflections represented by all reflections measured for this resolution shell.
<tr valign="TOP"><td>    _reflns_shell.cum_percent_possible_all 
  <td>      The cumulative percentage of geometrically possible reflections up to this range of shells.
<tr valign="TOP"><td>    _reflns_shell.multiplicity             
  <td>      The mean number of redundancy for the intensities of all reflections in the resolution shell.
<tr valign="TOP"><td>    _reflns_shell.PCV_mean                 
 <td>       The pooled standard deviation (the statistically valid measure of the noise level) is divided by the sum of the intensities (the signal level) in the resolution shell.
<tr valign="TOP"><td>    _reflns_shell.PCV                      
 <td>       The pooled coefficient of variation relative to I+ or I-. The pooled standard deviation (the statistically valid measure of the noise level) is divided by the sum of the intensities (the signal level) in the resolution shell.
<tr valign="TOP"><td>    _reflns_shell.Rmeas                    
 <td>       The multiplicity-weighted Rmerge relative to I+ or I- in the resolution shell.
<tr valign="TOP"><td>    _reflns_shell.Rmeas_mean               
  <td>      The multiplicity-weighted Rmerge relative to overall mean I in the resolution shell.
<tr valign="TOP"><td>    _reflns_shell.anom_diff_percent_meas   
  <td>      AnomFrc is the % of measured acentric reflections for which an anomalous difference has been measured in the resolution shell, after merging and scaling of the data set. The rejection criteria and treatment of Bijvoet-related observations (I+ & I-) is covered by the _reflns.merge_reject_criterion definition, as are all observations of reflections.
</table>

<p><br><dt><h3>SUBROUTINE Hsoftware(SoftwareClass,SoftwareAuthor,SoftwareEmail,SoftwareDescr)</h3>


<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Character  <td>SoftwareAuthor* (*),SoftwareEmail* (*),SoftwareDescr* (*),SoftwareClass* (*)
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _software.classification
  <td>      The classification of the program according to its major function.
<tr valign="TOP"><td>    _software.contact_author
  <td>      The recognized contact author of the software. This could be the original author, modifier of the code, or maintainer, but should be the individual most commonly associated with the code.
<tr valign="TOP"><td>    _software.contact_author_email
  <td>      The email address of the _software.contact_author.
<tr valign="TOP"><td>    _software.description
  <td>      Description of the software.
</table>

<p><br><dt><h3>SUBROUTINE HSymmetry(IntTabNum,SpaceGrpNam,NumEquiv,RFsymm)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer   <td>IntTabNum,NumEquiv
    <tr valign="TOP"><td>Character <td>SpaceGrpNam*10
    <tr valign="TOP"><td>Real      <td>RFsymm(4,4,*)
</table>
<p><dt><b>Writes the following CIF items:</b>
<dd><table border=1>
<tr valign="TOP"><td>    _Symmetry.Int_Tables_number
  <td>      Space-group number from International Tables for Crystallography, Vol. A (1987).
<tr valign="TOP"><td>    _Symmetry.space_group_name_H-M
  <td>      Hermann-Mauguin space-group symbol. Note that the H-M symbol does not necessarily contain complete information about the symmetry and the space-group origin. If used always supply the FULL symbol from International Tables for Crystallography, Vol. A (1987) and indicate the origin and the setting if it is not implicit. If there is any doubt that the equivalent positions can be uniquely deduced from this symbol specify the _symmetry_equiv.pos_as_xyz or _symmetry.space_group_name_Hall data items as well. Leave spaces between symbols referring to different axes.
<tr valign="TOP"><td>    _Symmetry_equiv.id
  <td>      The value of _symmetry_equiv.id must uniquely identify a record in the SYMMETRY_EQUIV category. Note that this item need not be a number; it can be any unique identifier.
<tr valign="TOP"><td>    _Symmetry_equiv.pos_as_xyz
  <td>      Symmetry equivalent position in the 'xyz' representation. Except for the space group P1, these data are repeated in a loop. The format of the data item is as per International Tables for Crystallography, Vol. A. (1987). All equivalent positions should be entered, including those for lattice centring and a centre of symmetry, if present.
</table>

<p><br><dt><h3>SUBROUTINE HSymTrn(Nsym,Rsm,Symchs)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer   <td>Nsym
    <tr valign="TOP"><td>Real      <td>Rsm(4,4,*)
    <tr valign="TOP"><td>Character <td>Symchs(MaxSymmetry)*80
</table>
<p><dt><b>Does the following:</b>
<dd>
 <tr valign="TOP"><td>   Translates the Symmetry matrices into INT TAB character strings for each symmetry operation and prints the real and reciprocal space operators on standard output.

<p><br><dt><h3>SUBROUTINE HTrnSym(Nsym,Rsm,Symchs)</h3>

<p><dt><b>Arguments:</b>
    <dd><table noborder><tr valign="TOP"><td>Integer   <td>Nsym
    <tr valign="TOP"><td>Real      <td>Rsm(4,4,*)
    <tr valign="TOP"><td>Character <td>Symchs(MaxSymmetry)*80
</table>
<p><dt><b>Does the following:</b>
<dd>
<tr valign="TOP"><td>    Symmetry translation from matrix back to characters. This translates the Symmetry matrices into INT TAB character strings.

</dl>

SOURCE: <a href="http://ndbserver.rutgers.edu/mmcif/dictionaries/html/cif_mm.dic/Index/index.html">http://ndbserver.rutgers.edu/mmcif/dictionaries/html/cif_mm.dic/Index/index.html</a>
</pre>
</html>
