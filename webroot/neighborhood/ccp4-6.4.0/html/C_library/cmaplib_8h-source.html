<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>cmaplib.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.13.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>cmaplib.h</h1><a href="cmaplib_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">     cmaplib.h: C/C++ level API for accessing CCP4 map files</font>
00003 <font class="comment">     Copyright (C) 2001  CCLRC, Charles Ballard</font>
00004 <font class="comment"></font>
00005 <font class="comment">     This code is distributed under the terms and conditions of the</font>
00006 <font class="comment">     CCP4 Program Suite Licence Agreement as a CCP4 Library.</font>
00007 <font class="comment">     A copy of the CCP4 licence can be obtained by writing to the</font>
00008 <font class="comment">     CCP4 Secretary, Daresbury Laboratory, Warrington WA4 4AD, UK.</font>
00009 <font class="comment">*/</font>
00010 
00046 <font class="preprocessor">#ifndef __GUARD_MAPLIB</font>
00047 <font class="preprocessor"></font><font class="preprocessor">#define __GUARD_MAPLIB</font>
<a name="l00048"></a><a class="code" href="cmaplib_8h.html#a2">00048</a> <font class="preprocessor"></font>
00049 <font class="preprocessor">#include "<a class="code" href="ccp4__utils_8h.html">ccp4_utils.h</a>"</font>
00050 
00051 <font class="preprocessor">#ifdef __cplusplus</font>
00052 <font class="preprocessor"></font><font class="keyword">namespace </font>CMap_io {
00053 <font class="keyword">typedef</font> CCP4::CCP4File CCP4File;
00054 <font class="keyword">extern</font> <font class="stringliteral">"C"</font> {
00055 <font class="preprocessor">#endif</font>
<a name="l00056"></a><a class="code" href="cmaplib_8h.html#a1">00056</a> <font class="preprocessor"></font>
00057 <font class="keyword">typedef</font> <font class="keyword">struct </font>_CMMFile_Skew CMMFile_Skew;
00058 <font class="keyword">typedef</font> <font class="keyword">struct </font>_CMMFile_Labels CMMFile_Labels;
<a name="l00059"></a><a class="code" href="cmaplib_8h.html#a3">00059</a> <font class="keyword">typedef</font> <font class="keyword">struct </font>_CMMFile_Symop CMMFile_Symop;
00060 <font class="keyword">typedef</font> <font class="keyword">struct </font>_CMMFile_Data CMMFile_Data;
00061 <font class="keyword">typedef</font> <font class="keyword">struct </font>_CMMFile_Stats CMMFile_Stats;
00062 <font class="keyword">typedef</font> <font class="keyword">struct </font>_CMMFile CMMFile;
00063 
00064 <font class="keyword">struct </font>_CMMFile_Labels {
00065   <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> number;
<a name="l00066"></a><a class="code" href="cmaplib_8h.html#a1">00066</a>   <font class="keywordtype">char</font> *labels[10];
00067 };
00068 
00069 <font class="keyword">struct </font>_CMMFile_Skew {
00070   <font class="keywordtype">float</font> rotation[3][3];
<a name="l00071"></a><a class="code" href="cmaplib_8h.html#a4">00071</a>   <font class="keywordtype">float</font> translation[3];
<a name="l00072"></a><a class="code" href="cmaplib_8h.html#a3">00072</a> };
00073 
<a name="l00074"></a><a class="code" href="cmaplib_8h.html#a2">00074</a> <font class="keyword">struct </font>_CMMFile_Symop {
00075 <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> offset;
00076 <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> size;
00077 <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> number;
00078 };
<a name="l00079"></a><a class="code" href="cmaplib_8h.html#a2">00079</a> 
00080 <font class="keyword">struct </font>_CMMFile_Data {
00081   size_t offset;
<a name="l00082"></a><a class="code" href="cmaplib_8h.html#a5">00082</a>   size_t section_size;
00083   size_t header_size;
00084   size_t block_size;
00085   <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> number;
00086 };
00087 
00088 <font class="keyword">struct </font>_CMMFile_Stats {
00089   <font class="keywordtype">float</font> offset;                <font class="comment">/* pseudo zero value */</font>
00090   <font class="keywordtype">float</font> min;                   <font class="comment">/* minimum density value */</font>
00091   <font class="keywordtype">float</font> max;                   <font class="comment">/* maximum density value */</font>
00092   <font class="keywordtype">double</font> mean;               <font class="comment">/* sum of densities (less offset) */</font>
<a name="l00093"></a><a class="code" href="cmaplib_8h.html#a2">00093</a>   <font class="keywordtype">double</font> rms;              <font class="comment">/* sum of square of densities (less offset) */</font>
00094   <font class="keywordtype">int</font> total;                    <font class="comment">/* number of summed densities */</font>
<a name="l00095"></a><a class="code" href="cmaplib_8h.html#a6">00095</a> };
00096 
00097 <font class="keyword">struct </font>_CMMFile {
00098 CCP4File *stream;
00099 <font class="keywordtype">char</font> *file_name;
00100 <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> data_mode;
00101 <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> close_mode;
00102 <font class="keywordtype">float</font> cell[6];
00103 <font class="keywordtype">int</font> spacegroup;
00104 <font class="keywordtype">int</font> map_dim[3];
00105 <font class="keywordtype">int</font> origin[3];
00106 <font class="keywordtype">int</font> cell_grid[3];
<a name="l00107"></a><a class="code" href="cmaplib_8h.html#a7">00107</a> <font class="keywordtype">int</font> axes_order[3];
00108 CMMFile_Symop symop;
00109 CMMFile_Data data;
00110 CMMFile_Stats stats;
00111 CMMFile_Labels labels;
00112 CMMFile_Skew skew;
00113 <font class="keywordtype">int</font> reserved[8];
<a name="l00114"></a><a class="code" href="cmaplib_8h.html#a3">00114</a> <font class="keywordtype">char</font> user_access[24];
00115 };
00116 
00117 <font class="comment">/* open a file for read/write */</font>
00118 <font class="keywordtype">void</font> *<a class="code" href="cmap__open_8c.html#a3">ccp4_cmap_open</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *filename, <font class="keywordtype">int</font> mode);
<a name="l00119"></a><a class="code" href="cmaplib_8h.html#a8">00119</a> 
00120 <font class="comment">/* close a file for read/write (dumping the header if write) */</font>
00121 <font class="keywordtype">void</font> ccp4_cmap_close(CMMFile *mfile);
00122 
00123 <font class="comment">/* set the close mode (calculation of map statistics) */</font>
00124 <font class="keywordtype">void</font> ccp4_cmap_closemode(CMMFile *mfile, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> closemode);
00125 
<a name="l00126"></a><a class="code" href="cmaplib_8h.html#a3">00126</a> <font class="comment">/* seek to a section in the map (read mode only)*/</font>
00127 <font class="keywordtype">int</font> ccp4_cmap_seek_section(CMMFile *mfile, <font class="keywordtype">int</font> offset, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> seek_mode);
00128 
00129 <font class="comment">/* seek to a row in a section (read mode only)*/</font>
00130 <font class="keywordtype">int</font> ccp4_cmap_seek_row(CMMFile *, <font class="keywordtype">int</font> offset, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> seek_mode);
<a name="l00131"></a><a class="code" href="cmaplib_8h.html#a3">00131</a> 
<a name="l00132"></a><a class="code" href="cmaplib_8h.html#a9">00132</a> <font class="comment">/* raw seek (read mode only)*/</font>
00133 <font class="keywordtype">int</font> ccp4_cmap_seek_data(CMMFile *, <font class="keywordtype">int</font> offset, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> seek_mode);
00134 
00135 <font class="comment">/* read a map section from file to memory */</font>
00136 <font class="keywordtype">int</font> ccp4_cmap_read_section(CMMFile *mfile, <font class="keywordtype">void</font> *section);
00137 
00138 <font class="comment">/* read a row from file to memory */</font>
00139 <font class="keywordtype">int</font> ccp4_cmap_read_row(CMMFile *mfile, <font class="keywordtype">void</font> *row);
00140 
00141 <font class="comment">/* read n_items from file to memory (item determined by data mode) */</font>
00142 <font class="keywordtype">int</font> ccp4_cmap_read_data(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">void</font> *items, <font class="keywordtype">int</font> n_items);
00143 
00144 <font class="comment">/* write a map section from memory to file */</font>
<a name="l00145"></a><a class="code" href="cmaplib_8h.html#a4">00145</a> <font class="keywordtype">int</font> ccp4_cmap_write_section(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">void</font> *section);
00146 
00147 <font class="comment">/* write a map row from memory to file */</font>
<a name="l00148"></a><a class="code" href="cmaplib_8h.html#a10">00148</a> <font class="keywordtype">int</font> ccp4_cmap_write_row(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">void</font> *row);
00149 
00150 <font class="comment">/* write n_items from memory to file (item determined by data mode) */</font>
00151 <font class="keywordtype">int</font> ccp4_cmap_write_data(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">void</font> *items, <font class="keywordtype">int</font> n_items);
00152 
00153 <font class="comment">/* read the section header corresponding to the current section */</font>
<a name="l00154"></a><a class="code" href="cmaplib_8h.html#a5">00154</a> <font class="keywordtype">int</font> ccp4_cmap_read_section_header(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">char</font> *header);
00155 
00156 <font class="comment">/* write the section header corresponding to the current section */</font>
<a name="l00157"></a><a class="code" href="cmaplib_8h.html#a11">00157</a> <font class="keywordtype">int</font> ccp4_cmap_write_section_header(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">char</font> *header);
00158 
00159 <font class="comment">/* get the header parameters */</font>
00160 <font class="keywordtype">void</font> ccp4_cmap_get_cell(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">float</font> *cell);
00161 <font class="keywordtype">void</font> ccp4_cmap_get_grid(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">int</font> *grid);
00162 <font class="keywordtype">void</font> ccp4_cmap_get_origin(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">int</font> *origin);
00163 <font class="keywordtype">void</font> ccp4_cmap_get_order(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">int</font> *axes_order);
<a name="l00164"></a><a class="code" href="cmaplib_8h.html#a6">00164</a> <font class="keywordtype">void</font> ccp4_cmap_get_dim(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">int</font> *map_dim);
00165 <font class="keywordtype">int</font> ccp4_cmap_get_spacegroup(<font class="keyword">const</font> CMMFile *mfile);
<a name="l00166"></a><a class="code" href="cmaplib_8h.html#a12">00166</a> <font class="keywordtype">void</font> ccp4_cmap_get_mapstats(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">float</font> *min, <font class="keywordtype">float</font>* max, 
00167                            <font class="keywordtype">double</font> *mean, <font class="keywordtype">double</font> *rms);
00168 
00169 <font class="comment">/* set the header parameters */</font>
00170 <font class="keywordtype">void</font> ccp4_cmap_set_cell(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">float</font> *cell);
00171 <font class="keywordtype">void</font> ccp4_cmap_set_grid(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">int</font> *grid);
00172 <font class="keywordtype">void</font> ccp4_cmap_set_origin(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">int</font> *origin);
00173 <font class="keywordtype">void</font> ccp4_cmap_set_order(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">int</font> *axes_order);
00174 <font class="keywordtype">void</font> ccp4_cmap_set_dim(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">int</font> *map_dim);
00175 <font class="keywordtype">void</font> ccp4_cmap_set_spacegroup(CMMFile *mfile, <font class="keywordtype">int</font> spacegroup);
<a name="l00176"></a><a class="code" href="cmaplib_8h.html#a13">00176</a> <font class="keywordtype">void</font> ccp4_cmap_set_mapstats(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">float</font> min, <font class="keyword">const</font> <font class="keywordtype">float</font> max,
00177                            <font class="keyword">const</font> <font class="keywordtype">double</font> mean, <font class="keyword">const</font> <font class="keywordtype">double</font> rms);
00178 
00179 <font class="comment">/* get map file datamode */</font>
00180 <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> ccp4_cmap_get_datamode(<font class="keyword">const</font> CMMFile *mfile);
00181 
<a name="l00182"></a><a class="code" href="cmaplib_8h.html#a4">00182</a> <font class="comment">/* set map file datamode */</font>
00183 <font class="keywordtype">void</font> ccp4_cmap_set_datamode(CMMFile *mfile, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> datamode);
00184 
00185 <font class="comment">/* get the local header size */</font>
00186 size_t ccp4_cmap_get_local_header(CMMFile *mfile);
00187 
00188 <font class="comment">/* set the local header size (before data writing begins) */</font>
00189 <font class="keywordtype">void</font> ccp4_cmap_set_local_header(CMMFile *mfile, size_t size);
00190 
00191 <font class="comment">/* get the number of symops in the file */</font>
00192 <font class="keywordtype">int</font> ccp4_cmap_num_symop(<font class="keyword">const</font> CMMFile *mfile);
00193 
00194 <font class="comment">/* seek among the symops strings */</font>
00195 <font class="keywordtype">int</font> ccp4_cmap_seek_symop(CMMFile *mfile, <font class="keywordtype">int</font> isymop, <font class="keywordtype">unsigned</font> <font class="keywordtype">int</font> whence);
<a name="l00196"></a><a class="code" href="cmaplib_8h.html#a14">00196</a> 
00197 <font class="comment">/* read a symop string of 80 characters */</font>
00198 <font class="keywordtype">int</font> ccp4_cmap_get_symop(CMMFile *mfile, <font class="keywordtype">char</font> *buffer);
00199 
00200 <font class="comment">/* write a symop string of 80 characters */</font>
00201 <font class="keywordtype">int</font> ccp4_cmap_set_symop(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">char</font> *buffer);
00202 
00203 <font class="comment">/* get the mask */</font>
00204 <font class="keywordtype">int</font> ccp4_cmap_get_mask(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">float</font> *skew_mat, <font class="keywordtype">float</font> *skew_trans);
00205 
00206 <font class="comment">/* set the mask */</font>
00207 <font class="keywordtype">int</font> ccp4_cmap_set_mask(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">float</font> *skew_mat, <font class="keyword">const</font> <font class="keywordtype">float</font> *skew_trans);
00208 
00209 <font class="comment">/* the number of labels used */</font>
00210 <font class="keywordtype">int</font> ccp4_cmap_number_label(<font class="keyword">const</font> CMMFile *mfile);
00211 
00212 <font class="comment">/* set label at posn from C-string */</font>
00213 <font class="keywordtype">int</font> ccp4_cmap_set_label(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">char</font> *label, <font class="keywordtype">int</font> posn);
00214 
00215 <font class="comment">/* return label at posn as C-string */</font>
00216 <font class="keywordtype">char</font> *ccp4_cmap_get_label(<font class="keyword">const</font> CMMFile *mfile, <font class="keywordtype">int</font> posn);
00217 
00218 <font class="comment">/* set title (label=0) */</font>
00219 <font class="keywordtype">int</font> ccp4_cmap_set_title(CMMFile *mfile, <font class="keyword">const</font> <font class="keywordtype">char</font> *label);
00220 
00221 <font class="comment">/* get title (label=0) */</font>
<a name="l00222"></a><a class="code" href="cmaplib_8h.html#a15">00222</a> <font class="keywordtype">char</font> *ccp4_cmap_get_title(<font class="keyword">const</font> CMMFile *mfile);
00223 
00224 <font class="preprocessor">#ifdef __cplusplus</font>
00225 <font class="preprocessor"></font>}
00226 }
<a name="l00227"></a><a class="code" href="cmaplib_8h.html#a5">00227</a> <font class="preprocessor">#endif</font>
00228 <font class="preprocessor"></font>
00229 <font class="preprocessor">#endif  </font><font class="comment">/* __GUARD_MAPLIB */</font>
</pre></div>
</body>
</html>
