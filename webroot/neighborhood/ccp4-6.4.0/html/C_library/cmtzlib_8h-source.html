<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>cmtzlib.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.13.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>cmtzlib.h</h1><a href="cmtzlib_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">     cmtzlib.h: header file for cmtzlib.c</font>
00003 <font class="comment">     Copyright (C) 2001  CCLRC, Martyn Winn</font>
00004 <font class="comment"></font>
00005 <font class="comment">     This code is distributed under the terms and conditions of the</font>
00006 <font class="comment">     CCP4 Program Suite Licence Agreement as a CCP4 Library.</font>
00007 <font class="comment">     A copy of the CCP4 licence can be obtained by writing to the</font>
00008 <font class="comment">     CCP4 Secretary, Daresbury Laboratory, Warrington WA4 4AD, UK.</font>
00009 <font class="comment">*/</font>
00010 
00095 <font class="preprocessor">#ifndef __CMTZLib__</font>
00096 <font class="preprocessor"></font><font class="preprocessor">#define __CMTZLib__</font>
00097 <font class="preprocessor"></font>
00098 <font class="keyword">static</font> <font class="keywordtype">char</font> rcsidhm[100] = <font class="stringliteral">"$Id$"</font>;
<a name="l00099"></a><a class="code" href="cmtzlib_8h.html#a17">00099</a> 
00100 <font class="comment">/* defines CCP4::CCP4File */</font>
00101 <font class="preprocessor">#include "<a class="code" href="ccp4__utils_8h.html">ccp4_utils.h</a>"</font>
00102 
00103 <font class="preprocessor">#ifdef  __cplusplus</font>
00104 <font class="preprocessor"></font><font class="keyword">namespace </font>CMtz {
00105 <font class="keyword">extern</font> <font class="stringliteral">"C"</font> {
00106 <font class="keyword">typedef</font> CCP4::CCP4File CCP4File;
00107 <font class="preprocessor">#endif</font>
00108 <font class="preprocessor"></font>
00109 <font class="comment">/* needs to be here for C++ to use CCP4File typedef */</font>
00110 <font class="preprocessor">#include "<a class="code" href="mtzdata_8h.html">mtzdata.h</a>"</font>
00111 
00112 <font class="comment">/**** MTZ i/o ****/</font>
00113 
00120 <a class="code" href="structMTZ.html">MTZ</a> *MtzGet(<font class="keyword">const</font> <font class="keywordtype">char</font> *logname, <font class="keywordtype">int</font> read_refs);
00121 
00133 <a class="code" href="structMTZ.html">MTZ</a> *MtzGetUserCellTolerance(<font class="keyword">const</font> <font class="keywordtype">char</font> *logname, <font class="keywordtype">int</font> read_refs, <font class="keyword">const</font> <font class="keywordtype">double</font> cell_tolerance);
00134 
00141 <font class="keywordtype">int</font> MtzRrefl(CCP4File *filein, <font class="keywordtype">int</font> ncol, <font class="keywordtype">float</font> *refldata);
00142 
00149 <font class="keywordtype">int</font> MtzPut(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> *logname);
00150 
00158 CCP4File *MtzOpenForWrite(<font class="keyword">const</font> <font class="keywordtype">char</font> *logname);
00159 
00167 <font class="keywordtype">int</font> MtzWhdrLine(CCP4File *fileout, <font class="keywordtype">int</font> nitems, <font class="keywordtype">char</font> buffer[]);
00168 
00176 <font class="keywordtype">int</font> MtzWrefl(CCP4File *fileout, <font class="keywordtype">int</font> ncol, <font class="keywordtype">float</font> *refldata);
00177 
00184 <font class="keywordtype">int</font> MtzDeleteRefl(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> iref);
00185 
00186 <font class="comment">/**** Memory allocation ****/</font>
00187 
00199 <a class="code" href="structMTZ.html">MTZ</a> *MtzMalloc(<font class="keywordtype">int</font> nxtal, <font class="keywordtype">int</font> nset[]);
00200 
00205 <font class="keywordtype">int</font> MtzFree(<a class="code" href="structMTZ.html">MTZ</a> *mtz);
00206 
00213 <a class="code" href="structMTZCOL.html">MTZCOL</a> *MtzMallocCol(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> nref);
00214 
00219 <font class="keywordtype">int</font> MtzFreeCol(<a class="code" href="structMTZCOL.html">MTZCOL</a> *col);
00220 
00224 <a class="code" href="structbathead.html">MTZBAT</a> *MtzMallocBatch(<font class="keywordtype">void</font>);
00225 
00230 <font class="keywordtype">int</font> MtzFreeBatch(<a class="code" href="structbathead.html">MTZBAT</a> *batch);
00231   
00236 <font class="keywordtype">char</font> *MtzCallocHist(<font class="keywordtype">int</font> nhist);
00237 
00242 <font class="keywordtype">int</font> MtzFreeHist(<font class="keywordtype">char</font> *hist);
00243 
00249 <font class="keywordtype">void</font> <a class="code" href="cmtzlib__f_8c.html#a17">MtzMemTidy</a>(<font class="keywordtype">void</font>);
00250 
00251 <font class="comment">/**** Header operations ****/</font>
00252   
00257 <font class="keywordtype">int</font> MtzNbat(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00258 
00263 <font class="keywordtype">int</font> MtzNref(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00264 
00269 <font class="keywordtype">int</font> MtzSpacegroupNumber(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00270 
00278 <font class="keywordtype">int</font> MtzResLimits(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">float</font> *minres, <font class="keywordtype">float</font> *maxres);
00279 
00280 <font class="comment">/**** Crystal operations ****/</font>
00281 
00286 <font class="keywordtype">int</font> MtzNxtal(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00287 
00292 <font class="keywordtype">int</font> MtzNumActiveXtal(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00293 
00298 <a class="code" href="structMTZXTAL.html">MTZXTAL</a> **MtzXtals(<a class="code" href="structMTZ.html">MTZ</a> *mtz);
00299 
00305 <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *MtzIxtal(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">int</font> ixtal);
00306 
00313 <font class="keywordtype">char</font> *MtzXtalPath(<font class="keyword">const</font> <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *xtal);
00314 
00320 <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *MtzXtalLookup(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> *label);
00321 
00329 <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *MtzAddXtal(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> *xname, <font class="keyword">const</font> <font class="keywordtype">char</font> *pname,
00330                   <font class="keyword">const</font> <font class="keywordtype">float</font> cell[6]);
00331 
00336 <font class="keywordtype">int</font> MtzNsetsInXtal(<font class="keyword">const</font> <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *xtal);
00337 
00342 <font class="keywordtype">int</font> MtzNumActiveSetsInXtal(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *xtal);
00343 
00349 <a class="code" href="structMTZSET.html">MTZSET</a> **MtzSetsInXtal(<a class="code" href="structMTZXTAL.html">MTZXTAL</a> *xtal);
00350 
00357 <a class="code" href="structMTZSET.html">MTZSET</a> *MtzIsetInXtal(<font class="keyword">const</font> <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *xtal, <font class="keyword">const</font> <font class="keywordtype">int</font> iset);
00358 
00359 <font class="comment">/**** Dataset operations ****/</font>
00360 
00365 <font class="keywordtype">int</font> MtzNset(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00366 
00371 <font class="keywordtype">int</font> MtzNumActiveSet(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00372 
00380 <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *MtzSetXtal(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <a class="code" href="structMTZSET.html">MTZSET</a> *set);
00381 
00390 <font class="keywordtype">char</font> *MtzSetPath(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <a class="code" href="structMTZSET.html">MTZSET</a> *set);
00391 
00398 <a class="code" href="structMTZSET.html">MTZSET</a> *MtzSetLookup(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> *label);
00399 
00407 <a class="code" href="structMTZSET.html">MTZSET</a> *MtzAddDataset(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *xtl, <font class="keyword">const</font> <font class="keywordtype">char</font> *dname,
00408                     <font class="keyword">const</font> <font class="keywordtype">float</font> wavelength);
00409 
00416 <font class="keywordtype">int</font> MtzNcolsInSet(<font class="keyword">const</font> <a class="code" href="structMTZSET.html">MTZSET</a> *set);
00417 
00422 <font class="keywordtype">int</font> MtzNumActiveColsInSet(<font class="keyword">const</font> <a class="code" href="structMTZSET.html">MTZSET</a> *set);
00423 
00429 <font class="keywordtype">int</font> MtzNumSourceColsInSet(<font class="keyword">const</font> <a class="code" href="structMTZSET.html">MTZSET</a> *set);
00430 
00436 <font class="keywordtype">int</font> MtzNbatchesInSet(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <a class="code" href="structMTZSET.html">MTZSET</a> *set);
00437 
00443 <a class="code" href="structMTZCOL.html">MTZCOL</a> **MtzColsInSet(<a class="code" href="structMTZSET.html">MTZSET</a> *set);
00444 
00452 <a class="code" href="structMTZCOL.html">MTZCOL</a> *MtzIcolInSet(<font class="keyword">const</font> <a class="code" href="structMTZSET.html">MTZSET</a> *set, <font class="keyword">const</font> <font class="keywordtype">int</font> icol);
00453 
00454 <font class="comment">/**** Column operations ****/</font>
00455 
00463 <a class="code" href="structMTZCOL.html">MTZCOL</a> *MtzAddColumn(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <a class="code" href="structMTZSET.html">MTZSET</a> *set, <font class="keyword">const</font> <font class="keywordtype">char</font> *label,
00464                    <font class="keyword">const</font> <font class="keywordtype">char</font> *type);
00465 
00470 <font class="keywordtype">int</font> MtzAssignHKLtoBase(<a class="code" href="structMTZ.html">MTZ</a> *mtz);
00471 
00484 <font class="keywordtype">int</font> MtzAssignColumn(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <a class="code" href="structMTZCOL.html">MTZCOL</a> *col, <font class="keyword">const</font> <font class="keywordtype">char</font> crystal_name[],  
00485              <font class="keyword">const</font> <font class="keywordtype">char</font> dataset_name[]);
00486 
00493 <font class="keywordtype">int</font> MtzToggleColumn(<a class="code" href="structMTZCOL.html">MTZCOL</a> *col);
00494 
00501 <a class="code" href="structMTZSET.html">MTZSET</a>  *MtzColSet(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <a class="code" href="structMTZCOL.html">MTZCOL</a> *col);
00502 
00507 <font class="keywordtype">int</font> MtzNcol(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00508   
00513 <font class="keywordtype">int</font> MtzNumActiveCol(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00514   
00520 <font class="keywordtype">int</font> MtzNumSourceCol(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00521 
00529 <font class="keywordtype">char</font> *MtzColPath(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <a class="code" href="structMTZCOL.html">MTZCOL</a> *col);
00530 
00537 <font class="keywordtype">int</font> MtzRJustPath(<font class="keywordtype">char</font> *path, <font class="keyword">const</font> <font class="keywordtype">char</font> *partial, <font class="keyword">const</font> <font class="keywordtype">int</font> njust);
00538 
00544 <font class="keywordtype">int</font> MtzPathMatch(<font class="keyword">const</font> <font class="keywordtype">char</font> *path1, <font class="keyword">const</font> <font class="keywordtype">char</font> *path2);
00545 
00551 <a class="code" href="structMTZCOL.html">MTZCOL</a> *MtzColLookup(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> *label);
00552 
00557 <font class="keywordtype">char</font> *MtzColType(<a class="code" href="structMTZCOL.html">MTZCOL</a> *col);
00558 
00564 <font class="keywordtype">void</font> MtzDebugHierarchy(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz);
00565 
00573 <font class="keywordtype">int</font> MtzListColumn(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">char</font> clabs[][31], <font class="keywordtype">char</font> ctyps[][3], <font class="keywordtype">int</font> csetid[]);
00574 
00582 <font class="keywordtype">int</font> MtzListInputColumn(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">char</font> clabs[][31], <font class="keywordtype">char</font> ctyps[][3], <font class="keywordtype">int</font> csetid[]);
00583 
00584 <font class="comment">/**** helper functions ****/</font>
00585 
00594 <font class="keywordtype">int</font> MtzFindInd(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> *ind_xtal, <font class="keywordtype">int</font> *ind_set, <font class="keywordtype">int</font> ind_col[3]);
00595 
00602 <font class="keywordtype">float</font> MtzInd2reso(<font class="keyword">const</font> <font class="keywordtype">int</font> in[3], <font class="keyword">const</font> <font class="keywordtype">double</font> coefhkl[6]);
00603 
00609 <font class="keywordtype">int</font> MtzHklcoeffs(<font class="keyword">const</font> <font class="keywordtype">float</font> cell[6], <font class="keywordtype">double</font> coefhkl[6]);
00610 
00617 <font class="keywordtype">int</font> MtzArrayToBatch(<font class="keyword">const</font> <font class="keywordtype">int</font> *intbuf, <font class="keyword">const</font> <font class="keywordtype">float</font> *fltbuf, <a class="code" href="structbathead.html">MTZBAT</a> *batch);
00618 
00625 <font class="keywordtype">int</font> MtzBatchToArray(<a class="code" href="structbathead.html">MTZBAT</a> *batch, <font class="keywordtype">int</font> *intbuf, <font class="keywordtype">float</font> *fltbuf);
00626 
00635 <a class="code" href="structbathead.html">MTZBAT</a> *sort_batches(<a class="code" href="structbathead.html">MTZBAT</a> *batch, <font class="keywordtype">int</font> numbat);
00636 
00637 <font class="comment">/**** pseudo-mtzlib routines ****/</font>
00638 
00645 <font class="keywordtype">int</font> ccp4_lrtitl(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">char</font> *title);
00646 
00653 <font class="keywordtype">int</font> ccp4_lrhist(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">char</font> history[][<a class="code" href="mtzdata_8h.html#a4">MTZRECORDLENGTH</a>], <font class="keywordtype">int</font> nlines);
00654 
00660 <font class="keywordtype">int</font> ccp4_lrsort(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> isort[5]);
00661 
00668 <font class="keywordtype">int</font> ccp4_lrbats(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> *nbatx, <font class="keywordtype">int</font> batchx[]);
00669 
00675 <font class="keywordtype">int</font> ccp4_lrcell(<font class="keyword">const</font> <a class="code" href="structMTZXTAL.html">MTZXTAL</a> *xtl, <font class="keywordtype">float</font> cell[]);
00676 
00686 <font class="keywordtype">int</font> ccp4_lrsymi(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> *nsympx, <font class="keywordtype">char</font> *ltypex, <font class="keywordtype">int</font> *nspgrx, 
00687        <font class="keywordtype">char</font> *spgrnx, <font class="keywordtype">char</font> *pgnamx);
00688 
00698 <font class="keywordtype">int</font> ccp4_lrsymm(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> *nsymx, <font class="keywordtype">float</font> rsymx[192][4][4]);
00699 
00709 <font class="keywordtype">int</font> MtzParseLabin(<font class="keywordtype">char</font> *labin_line, <font class="keyword">const</font> <font class="keywordtype">char</font> prog_labels[][31], 
00710            <font class="keyword">const</font> <font class="keywordtype">int</font> nlprgi, <font class="keywordtype">char</font> user_labels[][2][31]);
00711 
00725 <a class="code" href="structMTZCOL.html">MTZCOL</a> **ccp4_lrassn(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> labels[][31], <font class="keyword">const</font> <font class="keywordtype">int</font> nlabels, 
00726                 <font class="keywordtype">char</font> types[][3]);
00727 
00741 <font class="keywordtype">int</font> ccp4_lridx(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <a class="code" href="structMTZSET.html">MTZSET</a> *set, <font class="keywordtype">char</font> crystal_name[64], 
00742             <font class="keywordtype">char</font> dataset_name[64], <font class="keywordtype">char</font> project_name[64], <font class="keywordtype">int</font> *isets, 
00743             <font class="keywordtype">float</font> datcell[6], <font class="keywordtype">float</font> *datwave);
00744 
00760 <font class="keywordtype">int</font> ccp4_lrrefl(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">float</font> *resol, <font class="keywordtype">float</font> adata[], <font class="keywordtype">int</font> logmss[], <font class="keywordtype">int</font> iref);
00761 
00778 <font class="keywordtype">int</font> ccp4_lrreff(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">float</font> *resol, <font class="keywordtype">float</font> adata[], <font class="keywordtype">int</font> logmss[],
00779                 <font class="keyword">const</font> <a class="code" href="structMTZCOL.html">MTZCOL</a> *lookup[], <font class="keyword">const</font> <font class="keywordtype">int</font> ncols, <font class="keyword">const</font> <font class="keywordtype">int</font> iref);
00780 
00788 <font class="keywordtype">int</font> ccp4_ismnf(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">float</font> datum);
00789 
00795 <font class="keywordtype">int</font> ccp4_lhprt(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> iprint);
00796 
00803 <font class="keywordtype">int</font> ccp4_lhprt_adv(<font class="keyword">const</font> <a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> iprint);
00804 
00812 <font class="keywordtype">int</font> ccp4_lrbat(<a class="code" href="structbathead.html">MTZBAT</a> *batch, <font class="keywordtype">float</font> *buf, <font class="keywordtype">char</font> *charbuf, <font class="keywordtype">int</font> iprint);
00813 
00818 <font class="keywordtype">int</font> MtzPrintBatchHeader(<font class="keyword">const</font> <a class="code" href="structbathead.html">MTZBAT</a> *batch);
00819 
00827 <font class="keywordtype">int</font> ccp4_lwtitl(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> *ftitle, <font class="keywordtype">int</font> flag);
00828 
00838 <font class="keywordtype">int</font> MtzSetSortOrder(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <a class="code" href="structMTZCOL.html">MTZCOL</a> *colsort[5]);
00839 
00846 <font class="keywordtype">int</font> MtzAddHistory(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> history[][<a class="code" href="mtzdata_8h.html#a4">MTZRECORDLENGTH</a>], <font class="keyword">const</font> <font class="keywordtype">int</font> nlines);
00847 
00862 <font class="keywordtype">int</font> ccp4_lwsymm(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keywordtype">int</font> nsymx, <font class="keywordtype">int</font> nsympx, <font class="keywordtype">float</font> rsymx[192][4][4], 
<a name="l00863"></a><a class="code" href="cmtzlib_8h.html#a31">00863</a>                 <font class="keywordtype">char</font> ltypex[], <font class="keywordtype">int</font> nspgrx, <font class="keywordtype">char</font> spgrnx[], <font class="keywordtype">char</font> pgnamx[]);
00864 
00865 <font class="comment">/* Assign columns for writing. Check to see if columns already exist,</font>
00866 <font class="comment"> * else create them. New columns are assigned to the base dataset if it </font>
00867 <font class="comment"> * exists, else the first dataset.</font>
00868 <font class="comment"> * @param mtz pointer to MTZ struct</font>
00869 <font class="comment"> * @param labels Input array of column labels to be assigned.</font>
00870 <font class="comment"> * @param nlabels Number of columns.</font>
00871 <font class="comment"> * @param types Input array of column types of columns.</font>
00872 <font class="comment"> * @param iappnd If iappnd = 0, then deactivate columns which are</font>
00873 <font class="comment"> *   not selected (allows one to write out a subset of columns). Else</font>
00874 <font class="comment"> *   if iappnd = 1, append these columns to existing ones.</font>
00875 <font class="comment"> * @return Array of pointers to columns in MTZ struct.</font>
00876 <font class="comment"> */</font>
00877 <a class="code" href="structMTZCOL.html">MTZCOL</a> **ccp4_lwassn(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> labels[][31], <font class="keyword">const</font> <font class="keywordtype">int</font> nlabels, 
00878              <font class="keyword">const</font> <font class="keywordtype">char</font> types[][3], <font class="keyword">const</font> <font class="keywordtype">int</font> iappnd);
00879 
<a name="l00880"></a><a class="code" href="cmtzlib_8h.html#a32">00880</a> <font class="comment">/* Add or update a dataset in the MTZ structure. If the crystal name is</font>
00881 <font class="comment"> * not recognised, then a new crystal is created containing a single</font>
00882 <font class="comment"> * dataset. If the crystal name is recognised, then the parameters of</font>
00883 <font class="comment"> * the crystal are updated. The child dataset is then created if necessary</font>
00884 <font class="comment"> * or an existing dataset updated.</font>
00885 <font class="comment"> * Note that this function is used to update crystal parameters, as well</font>
00886 <font class="comment"> * as add crystals. If a duplicate crystal name is used by mistake, then </font>
00887 <font class="comment"> * the old crystal parameters are lost.</font>
00888 <font class="comment"> * @param mtz pointer to MTZ struct</font>
00889 <font class="comment"> * @param crystal_name Crystal name</font>
00890 <font class="comment"> * @param dataset_name Dataset name</font>
00891 <font class="comment"> * @param project_name Project name</font>
00892 <font class="comment"> * @param datcell Cell dimensions of crystal that dataset belongs to.</font>
00893 <font class="comment"> * @param datwave X-ray wavelength associated with dataset.</font>
00894 <font class="comment"> * @return 1 on success, 0 on failure</font>
00895 <font class="comment"> */</font>
00896 <font class="keywordtype">int</font> ccp4_lwidx(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">char</font> crystal_name[],  <font class="keyword">const</font> <font class="keywordtype">char</font> dataset_name[],
00897         <font class="keyword">const</font> <font class="keywordtype">char</font> project_name[], <font class="keyword">const</font> <font class="keywordtype">float</font> datcell[6], <font class="keyword">const</font> <font class="keywordtype">float</font> *datwave);
00898 
00899 
00917 <font class="keywordtype">int</font> ccp4_lwrefl(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <font class="keyword">const</font> <font class="keywordtype">float</font> adata[], <a class="code" href="structMTZCOL.html">MTZCOL</a> *lookup[], 
00918                  <font class="keyword">const</font> <font class="keywordtype">int</font> ncol, <font class="keyword">const</font> <font class="keywordtype">int</font> iref);
00919 
00933 <font class="keywordtype">int</font> ccp4_lwbat(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <a class="code" href="structbathead.html">MTZBAT</a> *batch, <font class="keyword">const</font> <font class="keywordtype">int</font> batno, <font class="keyword">const</font> <font class="keywordtype">float</font> *buf, <font class="keyword">const</font> <font class="keywordtype">char</font> *charbuf);
<a name="l00934"></a><a class="code" href="cmtzlib_8h.html#a33">00934</a> 
00935 <font class="keywordtype">int</font> ccp4_lwbsetid(<a class="code" href="structMTZ.html">MTZ</a> *mtz, <a class="code" href="structbathead.html">MTZBAT</a> *batch, <font class="keyword">const</font> <font class="keywordtype">char</font> xname[], <font class="keyword">const</font> <font class="keywordtype">char</font> dname[]);
00936 
00937 <font class="comment">/* -- Below here there are no implementations -- */</font>
00938 
00939 <font class="comment">/* COMPLEX HLToSF(float hla, float hlb, float hlc, float hld, BOOLEAN centric); */</font>
00940 <font class="comment">/* Returns the mean structure factor as a complex number from a structure</font>
00941 <font class="comment">   factor probability distribution described by Hendrickson/Lattman</font>
00942 <font class="comment">   coefficients. If `centric == TRUE`, the coefficients describe a centric</font>
00943 <font class="comment">   distribution. */</font>
00944 
00945 <font class="comment">/* MTZ *MtzSort(MTZ *mtz, char *ident); */</font>
<a name="l00946"></a><a class="code" href="cmtzlib_8h.html#a34">00946</a> <font class="comment">/* Sorts `mtz` using the identifiers (separated by spaces) in `ident` as</font>
00947 <font class="comment">   keys. Sorting can be done on up to 200 columns. A pointer to `*mtz` is</font>
00948 <font class="comment">   returned. */</font>
00949 
00950 <font class="comment">/* MTZ *HLCombine (MTZ *to, float toscale, MTZ *frm, float frmscale); */</font>
00951 <font class="comment">/* Combines extra phase information for common reflections between 'frm'</font>
00952 <font class="comment">   and 'to' into the phase information of 'to'. The phase probabilities</font>
00953 <font class="comment">   are described by Hendrickson Lattman coefficients, with the identifiers</font>
00954 <font class="comment">   "HLA", "HLB", HLC", and "HLD", the indices are identified by "H", "K" </font>
00955 <font class="comment">   and "L". HL-coeffs from 'to' are scaled by 'toscale', the coeffs from</font>
00956 <font class="comment">   'frm' are scaled by 'frmscale'. A pointer to `to` is returned. */</font>
00957 
00958 <font class="comment">/* void MtzPhiFom(MTZ *mtz); */</font>
00959 <font class="comment">/* Calculates the best phase and the figure of from Hendrickson Lattman</font>
00960 <font class="comment">   coefficients. The following columns should be present in `mtz`:</font>
00961 <font class="comment">   "H", "K" &amp; "L" (indices); "PHIB" &amp; "FOM" (best phase (degrees) and figure of</font>
<a name="l00962"></a><a class="code" href="cmtzlib_8h.html#a35">00962</a> <font class="comment">   merit); "HLA", "HLB", "HLC" &amp; "HLD" (Hendrickson Lattman coefficients). */</font>
00963 
00964 <font class="comment">/* MTZ *MtzCopy(MTZ *frm); */</font>
00965 <font class="comment">/* Produces an exact copy of `frm` and returns a pointer to it. */</font>
00966 
00967 <font class="comment">/* MTZ *MtzColAppend(MTZ *mtz, char *ident, char type); */</font>
00968 <font class="comment">/* Appends a column to `*mtz` with identity `ident` and type `type`, provided</font>
00969 <font class="comment">   no column with identity `ident` exists. */</font>
00970 
00971 <font class="comment">/* MTZ *MtzColRemove(MTZ *mtz, char *ident); */</font>
00972 <font class="comment">/* Removes a column from `*mtz` with identity `ident`. */</font>
00973 
00974 <font class="comment">/* MTZ *MtzUpdateRanges(MTZ *mtz); */</font>
00975 <font class="comment">/* Updates ranges of all columns in `mtz` and returns `mtz`. */</font>
00976 
00977 <font class="comment">/* MTZCOL *MtzColNewRange(MTZCOL *col, int nref); */</font>
00978 <font class="comment">/* Updates the minimum &amp; maximum values in `col` and returns `col`. */</font>
00979 
00980 <font class="comment">/* int *MtzUnique(MTZ *mtz, char *ident); */</font>
00981 <font class="comment">/* Returns an array (k) of indices: k[j] returns the first occurrence of a set</font>
00982 <font class="comment">   of idents, eg. MtzUnique(mtz, "H K L") returns an array from which all the </font>
00983 <font class="comment">   unique reflections can be determined by indexing with k: k[i] is the index</font>
00984 <font class="comment">   of the last relection of a set which all have the same hkl indices. It is</font>
00985 <font class="comment">   assumed that `mtz` is sorted, using `ident` as keys. */</font>
00986 
<a name="l00987"></a><a class="code" href="cmtzlib_8h.html#a36">00987</a> <font class="comment">/* float PhaseProb(float phase, float hla, float hlb, float hlc, float hld,</font>
00988 <font class="comment">                BOOLEAN centric); */</font>
00989 <font class="comment">/* Returns the probability of `phase` (expressed in radians) as determined by</font>
00990 <font class="comment">   the Hendrickson-Lattman coefficients `hla`, `hlb`, `hlc` and `hld`. If</font>
00991 <font class="comment">   `centric == TRUE`, the coefficients describe a centric distribution. */</font>
00992 
00993 <font class="preprocessor">#ifdef __cplusplus</font>
00994 <font class="preprocessor"></font>} }
00995 <font class="preprocessor">#endif</font>
00996 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
</pre></div>
</body>
</html>
