<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head><title>CCP4 Program Suite : fsearch</title></head>
<body>

<!-- ::INDEX_INFO::FSEARCH::Supported::Molecular replacement::6-d molecular replacement (envelope) search:::::::: -->

<H1> FSEARCH (CCP4: Supported Program)</H1>
<H2> NAME</H2>
<b>fsearch </b>-&nbsp; A program to perform up to 6 dimensional molecular
(envelope) replacement search.

<h2>
SYNOPSIS</h2>
<b>fsearch hklin </b><i>foo_in.mtz </i>[<b>flmin</b><i> foo_in.txt</i>]
[<b>xyzin</b><i>foo_in.pdb</i>] [<b>mapin</b> <i>foo_in.map</i>]
<br>[<a href="#keywords">Key-worded input</a>]
<h2>
<a NAME="description"></a>DESCRIPTION</h2>
FSEARCH can be used for a molecular-replacement (up to 6 dimensional) solution&nbsp;
given a predetermined envelope from any source, provided that the envelope
can be converted to the standard CCP4 map format or expressed in terms
of spherical harmonics or generated from a pdb file.
<h2>
<a NAME="files"></a>INPUT AND OUTPUT FILES</h2>

<h3>
Input</h3>

<dl compact>
<dt>
HKLIN</dt>

<dd>
(compulsory)</dd>

<dd>
Input MTZ file. This should contain the conventional (CCP4) asymmetric
unit of data (must be *sorted* on H K L). See the LABIN keyword for columns
used.</dd>

<dd>
</dd>

<dt>
(Envelope input mode; ONLY one from the following three)</dt>

<dt>
FLMIN</dt>

<dd>
Spherical Harmonics File. Free format: L&nbsp; M&nbsp; Flm(re)&nbsp; Flm(im).</dd>

<dt>
XYZIN</dt>

<dd>
Coordinates File (Brookhaven format).</dd>

<dt>
MAPIN</dt>

<dd>
Map File - one asymmetric unit only (standard CCP4 map file format).</dd>
</dl>

<h3>
Output</h3>

<dl compact>
<dd>
Results (up to 200 solutions sorted by R-factor) are shown in the log
file.</dd>
</dl>

<h2>
<a NAME="keywords"></a>KEYWORDED INPUT</h2>
The various data control lines are identified by keywords. Only the first
4 characters of a keyword are significant. The cards can be in any order.
Numbers in [ ] are optional and can be left out. The only compulsory command
is <a href="#LABIN">LABIN</a>. The available keywords are:

<blockquote>
<A HREF="#TITLE"><B>TITLE</B></A>, <A HREF="#LABIN"><B>LABIN</B></A>,
<A HREF="#GRID"><B>GRID</B></A>, <A HREF="#RESOLUTION"><B>RESOLUTION</B></A>,
<A HREF="#SIGCUT"><B>SIGCUT</B></A>, <A HREF="#RFILTER"><B>RFILTER</B></A>,
<A HREF="#ORTH"><B>ORTH</B></A>, <A HREF="#CHKOVERLAP"><B>CHKOVERLAP</B></A>,
<A HREF="#ALPHA"><B>ALPHA</B></A>, <A HREF="#BETA"><B>BETA</B></A>,
<A HREF="#GAMMA"><B>GAMMA</B></A>, <A HREF="#XRANGE"><B>XRANGE</B></A>,
<A HREF="#YRANGE"><B>YRANGE</B></A>, <A HREF="#ZRANGE"><B>ZRANGE</B></A>
</blockquote>

<h3>
<a NAME="TITLE"></a>TITLE &lt;title string></h3>
Up to 80 character title.
<h3>
<a NAME="LABIN"></a>LABIN FP=...&nbsp; SIGFP=...</h3>
(Compulsory.)
<br>E.g.
<br>FP=F&nbsp; SIGFP=SIGF.
<h3>
<a NAME="GRID"></a>GRID &lt;nx> &lt;ny> &lt;nz></h3>
Number of sampling divisions along whole cell edge. For all space-groups,
NX,NY,NZ must be even and must have no prime factors greater than 19. Default
values: nx = a, ny = b and nz = c (nearest integer in Angstrom).
<h3>
<a NAME="RESOLUTION"></a>RESOLUTION &lt;rmin></h3>
High resolution cutoff in Angstrom (default value = 10).
<br>&nbsp;
<h3>
<a NAME="SIGCUT"></a>SIGCUT &lt;Nsig></h3>
Reflections will be excluded if F &lt; Nsig*SIGF. Default: no reflections
are excluded.
<h3>
<a NAME="RFILTER"></a>RFILTER &lt;rf></h3>
Solutions with R-factor &lt; rf will be written to the log file. Default:
rf = 0.60.
<h3>
<a NAME="ORTH"></a>ORTH &lt;code></h3>
Orthonormalization code.
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 1 orthogonal x y z along a, c*xa, c*
(Brookhaven, default)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 2 b, a*xb, a*
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 3 c, b*xc, b*
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 4 a+b, c*x(a+b), c*
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = 5 a*, cxa*, c&nbsp;&nbsp; (Rollett)
<h3>
<a NAME="CHKOVERLAP"></a>CHKOVERLAP</h3>
Check packing clashes (% of the whole unit cell). Note: this can be *very
time consuming*, therefore not recommended for the initial search. Default:
no checking.
<h3>
<a NAME="ALPHA"></a>ALPHA &lt;min> &lt;max> &lt;step></h3>
Search range and step on Eulerian angle alpha (in degrees). Default: 0&nbsp;
180&nbsp; 3.
<h3>
<a NAME="BETA"></a>BETA &lt;min> &lt;max> &lt;step></h3>
Search range and step on Eulerian angle beta (in degrees). Default: 0&nbsp;
180&nbsp; 3.
<h3>
<a NAME="GAMMA"></a>GAMMA &lt;min> &lt;max> &lt;step></h3>
Search range and step on Eulerian angle gamma (in degrees). Default: 0&nbsp;
180&nbsp; 3.
<h3>
<a NAME="XRANGE"></a>XRANGE &lt;min> &lt;max> &lt;step></h3>
Search range and step on X (in Angstroms). Default: 0&nbsp; a/2&nbsp; 1.
<h3>
<a NAME="YRANGE"></a>YRANGE &lt;min> &lt;max> &lt;step></h3>
Search range and step on Y (in Angstroms). Default: 0&nbsp; b/2&nbsp; 1.
<h3>
<a NAME="ZRANGE"></a>ZRANGE &lt;min> &lt;max> &lt;step></h3>
Search range and step on Z (in Angstroms). Default: 0&nbsp; c/2&nbsp; 1.

<h2>
<a NAME="output"></a>PRINTER OUTPUT</h2>
Results (up to 200 solutions sorted by R-factor) are shown in the log file.
<br>&nbsp;
<h2>
<a NAME="examples"></a>EXAMPLES</h2>
<p>
<h3>Unix examples script found in $CEXAM/unix/runnable/</h3>

          <li><a href="../examples/unix/runnable/fsearch.exam">fsearch.exam</a>

<h3>
Non-runnable example script</h3>

<pre>
fsearch hklin pfsodb.mtz xyzin sod3.pdb &lt;&lt;eof
  TITL SOD
 # GRID 48 52 150
  LABI FP=FP SIGFP=SIGFP
  ALPHA 0 0 1
  BETA 0 0 1
  GAMMA 0 30 3
  XRANGE 0 18 3
  YRANGE 0 25 1
  ZRANGE 0 58 1
  RESO 6
eof
</pre>

<h2>PARALLELISED VERSION</h2>

Code for an MPI-parallelised version of FSEARCH is distributed as
fsearch_mpi.f   This is not integrated into the CCP4 installation,
and needs to be built separately.  You will need:
<ul>
<li>An MPI compiler, such as <a href="http://www-unix.mcs.anl.gov/mpi/mpich/">
MPICH</a> or <a href="http://www.lam-mpi.org">LAM</a>.
<li>The link line will need to include to the MPI library as well as the
usual CCP4 libraries (possible names libmpich.a, libmpif.a, libfmpi.a)
<li>The source code fsearch_mpi.f includes the system file "mpif.h". This may
need to be adjusted.
</ul>
The program distributes the search over Eulerian angles alpha and beta
over the available processors (with one processor reserved as a master
node). By default, 3 processors are used for the beta search for each
trial alpha angle. The search over alpha is then split over how ever many
sets of 3 processors there are. If the total number of processors (not
including the master node) is not a multiple of 3, then the last 1 or 2
processors are not used. The number of processors for the beta search
can be changed from the default value of 3 by the keyword PBET (e.g. "PBET 5").

<h2>
REFERENCES</h2>

<ol><!-- KEEP startreferencelist -->
<li>Hao, Q. (2001), <i>Acta Cryst.</i> <b>D57</b> 1410-1414. "Phasing from an Envelope".
<li>Q. Liu, A. J. Weaver, T. Xiang, D. J. Thiel and Q. Hao, 
(2003) <i>Acta Cryst.</i> <b>D59</b> 1016-1019.
"Low-resolution molecular replacement using a six-dimensional search"
<!-- KEEP endreferencelist -->
</ol>

<h2>
AUTHOR</h2>
Quan Hao, Cornell University. 
<p>Email: <a href="mailto:qh22@cornell.edu">qh22@cornell.edu</a>.

</body>
</html>
