<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <title>CCP4 Program Suite : cprodrg</title>
</head>
<body>
<!-- ::INDEX_INFO::PRODRG::Supported::Density Fitting and Model Building::generation of small molecule coordinates:::::::: -->
<h1>PRODRG (CCP4: Supported Program)</h1>

<h2><a name="Sname">NAME</a></h2>
<b>cprodrg</b> - generation of small molecule coordinates and topologies for use in refinement and model building from a variety of descriptions, including PDB coordinates and SMILES.

<h2><a name="Ssynopsis">SYNOPSIS</a></h2>
<p><b>cprodrg</b> <b>XYZIN</b> <i>foo_in.pdb</i> <b>LIBOUT</b> <i>foo_out.cif</i> <b>XYZOUT</b> <i>foo_out.pdb</i> <b>MOLOUT</b> <i>foo_out.mol</i><br>
[<a href='#Skeywordedinput'>Keyworded input</a>]</p>

<h2><a name="Sdescription">DESCRIPTION</a></h2>
<p>Crystallographic refinement and automated model-building require detailed descriptions of the chemical entities being refined, including information about atom types and connectivity (topology) and chemical parameters (bond lengths, angles, etc.). The CCP4 monomer library includes such descriptions for standard amino acids, nucleic acids and a variety of common small molecules, but cannot cover all possible chemicals you might want to include in a structure. The main purpose of PRODRG is to automatically generate such topological/parameter information for arbitrary small molecules (with some <a href="#Slimitations">LIMITATIONS</a>) from user input.</p>

<p>In addition, PRODRG can also generate reasonable three-dimensional coordinates if none are available or optionally improve the input conformation if they are. The resulting coordinates are written out in PDB and/or MDL Molfile format. Please note that the PRODRG-generated topology <b>must</b> be used in conjunction with the PRODRG-generated PDB file rather than with the input file, even if that file is in PDB format and no modifications had been requested. The main reason for this is that PRODRG may rename atoms in your input, making it incompatible with the generated topology.</p>

<p>Thirdly, PRODRG can be used to create 'flattened' two-dimensional coordinates of a molecule, useful for showing its chemical structure (see <a href="#Kminimise">MINImise</a>).</p>

<p>Finally, PRODRG allows the alteration of given compounds by adding functional groups to them or removing/replacing parts of the molecule. This is described in more detail under <a href="#Smodifyingtheinput">MODIFYING THE INPUT</a>.</p>


<h2><a name="Sinputoutputfiles">INPUT/OUTPUT FILES</a></h2>
<h3><a name="Lxyzin">XYZIN</a></h3>
<p>Description of the desired small molecule in one of the valid PRODRG input formats:</p>

<ul>
<li>PDB coordinates</li>
<li>SMILES string</li>
<li>MDL Molfile connection table</li>
<li>SYBYL Mol2 connection table</li>
<li>PRODRG text drawing (see <a href="#Stextdrawings">TEXT DRAWINGS</a>)</li>
</ul>
<p>PRODRG will automatically recognise the format of the input file. Note that for SMILES input to be recognised, it must not contain any line breaks. In general, non-PDB input formats should be preferred if available, as they provide more detailed information about the requested molecule to PRODRG.</p>

<h3><a name="Llibout">LIBOUT</a></h3>
<p>CIF-formatted topology for the given small molecule generated by PRODRG.</p>

<h3><a name="Lxyzout">XYZOUT</a></h3>
<p>Coordinates for the given molecule in PDB format generated by PRODRG. Even if you provided your input to PRODRG as a PDB file and did not request energy minimisation, you should always use this file together with the generated topology, as PRODRG may have had to rename atoms in your input, which would render its topology incompatible with the original coordinate file.</p>

<h3><a name="Lmolout">MOLOUT</a></h3>
<p>Coordinates for the given molecule in MDL Molfile format generated by PRODRG.</p>


<h2><a name="Skeywordedinput">KEYWORDED INPUT</a></h2>
<p>PRODRG's operation can be controlled by keywords given on standard input. There are no compulsory keywords, the defaults for each keyword are indicated below. In all cases only the first four characters of a keyword are significant. Recognised keywords are: <a href="#Kcoords">COORds</a>, <a href="#Kprotonate">PROTonate</a>, <a href="#Kminimise">MINImise</a>, <a href="#Kchirality">CHIRality</a>, <a href="#Kend">END</a>.</p>

<h3><a name="Kcoords">COORds PDB | MOL | BOTH</a></h3>
<p>Write output coordinates in PDB format only (COOR PDB, default), in MDL Molfile format only (COOR MOL) or in both formats (COOR BOTH).</p>

<h3><a name="Kprotonate">PROTonate ALL | POLAR | NONE</a></h3>
<p>By default, PRODRG will write out coordinate files including all hydrogen atoms (PROT ALL). Alternatively, coordinate files containing only polar hydrogens (PROT POLAR) or no hydrogens at all (PROT NONE) can be written. The CIF topology will always include all hydrogen atoms.</p>

<h3><a name="Kminimise">MINImise BUILD | YES | NO | FLAT</a></h3>
<p>This keyword controls PRODRG's coordinate generation feature. If disabled (MINI NO), output atom coordinates will be identical to input coordinates, or random if the input does not contain information about atom positions (SMILES etc.). This option should be chosen when the position/conformation of the input molecule must be conserved, e.g. because it has already been manually placed into a model, as any other minimisation choice may alter the conformation and/or position of the given molecule. Enabling minimisation (MINI YES) will either attempt to improve the input conformation or, if there are no input coordinates, generate a reasonable conformation from scratch. MINI BUILD (the default) is equivalent to MINI NO, unless the input contains building commands (see <a href="#Smodifyingtheinput">MODIFYING THE INPUT</a>), in which case minimisation is enabled. MINI FLAT enables minimisation, but instead of producing 3D coordinates, the output file will contain 'flattened' 2D coordinates.</p>

<h3><a name="Kchirality">CHIRality YES | NO | INPUT</a></h3>
<p>Directs the use of chirality (=improper) restraints. The default is to restrain chiral centres (CHIR YES). CHIR NO disables all chirality restraints, which may be useful when building things like fullerenes starting from a non-coordinate description. CHIR INPUT applies chirality restraints only if the input file specifies stereochemistry (3D coordinates, wedged bonds, etc.), but not otherwise.</p>

<h3><a name="Kend">END</a></h3>
<p>This terminates keyworded input. If an explicit END keyword is not given, PRODRG will stop reading keywords at the end of input.</p>


<h2><a name="Slimitations">LIMITATIONS</a></h2>
<p>PRODRG is designed to be used on <b>small</b> molecules and as such comes with a default size limit of 600 atoms, including hydrogens after processing. The limit can be changed by editing the MA constant in <code>$CSRC/prodrg/params.inc</code> and recompiling, but be aware that memory usage increases quadratically with the number of atoms, which means that e.g. creating a topology for your entire protein will be impossible on current hardware (aside from being a really bad idea).</p>

<p>Furthermore, PRODRG's support for atom types is limited by the underlying force field (a modified version of GROMOS96 43a1), which means, amongst other things, that there is no support for metal ions/atoms, either by themselves or as part of organic compounds.</p>


<h2><a name="Stextdrawings">TEXT DRAWINGS</a></h2>
<p>PRODRG can accept input molecules as text-based 'drawings' of chemical structures, using chemical symbols to place atoms and separators to indicate bonds (- and | for single bonds, = and " for double bonds and # for triple bonds). A few simple examples of PRODRG text drawings are:</p>

<p>Formate</p>

<p><pre>O-C=O</pre></p>

<p>Acetonitrile</p>

<p><pre>C-C#N</pre></p>

<p>Benzene</p>

<p><pre>C-C=C
"   |
C-C=C</pre></p>

<p>Adenine</p>

<p><pre>  N
  |
N=C-C---N
|   "   "
C=N-C-N-C</pre></p>

<p>Lowercase atom names can be used to change the chirality of that atom, for non-chiral centres there is no difference between uppercase and lowercase symbols.</p>

<p>All atoms must be separated by bonds, i.e. <code>C-C</code> describes a two carbons connected by a single bond, while <code>CC</code> is invalid. Bonds can be of arbitrary length (<code>C--C</code> is the same as <code>C-C</code>) and for single and double bonds, choice of either of the two valid bond symbols is purely cosmetic (<code>C|C</code> or even <code>C||-C</code> look strange, but are identical to <code>C-C</code>), as long as different bond types are not mixed (e.g. <code>C-=-C</code> is nonsensical and invalid). Because of the interchangeability of horizontal and vertical bond symbols, all bonds must be separated by at least one space (i.e. <code>||</code> is the same as <code>--</code> and thus part of one bond, while <code>| |</code> shows parts of two separate bonds). Bonds can connect to atoms from above, below, left or right &ndash; diagonal connections are not allowed.</p>

<p>Based on this, another (needlessly complicated but valid) way to depict adenine could be:</p>

<p><pre>N====C-C-N
|    | " "
|--C N " C
   "   " |
   N---C-N</pre></p>


<h2><a name="Smodifyingtheinput">MODIFYING THE INPUT</a></h2>
<p>PRODRG supports a number of commands that allow to modify the input molecule. These commands must be added to the <b>input file</b>. It should be noted that most of these commands refer to atoms by name, which can make their use in conjunction with input formats not using atom names (SMILES, text drawings, ...) awkward. In these cases PRODRG should be run without the modifying command(s) first to see what names the program assigns to atoms of interest, then PRODRG can be run again on the same input as before with the commands in place. The same procedure applies in cases where PRODRG changes atom names while processing a molecule.</p>

<p><h3>1. Changing hybridisation</h3>
</p>

<p>The <code>PATCH</code> command allows to change the hybridisation of an atom. While this is mostly meant to be a means for the user to help PRODRG interpret low-quality input, it can also be used to introduce double bonds etc., as long as care is taken that the result of the  patches applied makes chemical sense.</p>

<p><pre>PATCH &lt;atomname> 1
PATCH &lt;atomname> 2
PATCH &lt;atomname> 3</pre></p>

<p>can be used to force the given atom to sp, sp<sup>2</sup> or sp<sup>3</sup> hybridisation, respectively. In the case of sp hybridisation a further distinction should be made between sp-hybridised atoms as part of triple bonds or sp-hybridised atoms in allene-like systems. For improved results, <code>PATCH &lt;atomname> 10</code> should be used for the latter, and <code>PATCH &lt;atomname> 1</code> should be used for the former only.</p>

<p><h3>2. Inverting chiral centres</h3>
</p>

<p>The chirality of any atom can be inverted with</p>

<p><pre>PATCH &lt;atomname> -1</pre></p>

<p><h3>3. Controlling output hydrogens</h3>
</p>

<p>To generate output in specific 'non-standard' protonation states, the two commands</p>

<p><pre>INSHYD &lt;atomname>
DELHYD &lt;atomname></pre></p>

<p>can be used to add/remove hydrogens. Note that for both commands the specified atom is the one the hydrogen is attached to, i.e. not the hydrogen itself in the case of <code>DELHYD</code>.</p>

<p><h3>4. Substituting individual atoms</h3>
</p>

<p>The chemical identity of an input atom can be altered with</p>

<p><pre>BUILD &lt;atomname> @&lt;type></pre></p>

<p>where &lt;type> is the chemical symbol of the target type. As an example, a standard serine residue could be 'mutated' to a cysteine using</p>

<p><pre>BUILD OG @S</pre></p>

<p><h3>5. Removing parts of the input molecule</h3>
</p>

<p>Bonds in the input molecule can be cut with the command</p>

<p><pre>CHOP &lt;atomname1> &lt;atomname2></pre></p>

<p>where the two given atoms are connected by the bond to be removed. If the cutting produces two separate molecules, the smaller part is deleted. You can use the additional command</p>

<p><pre>KEPSML</pre></p>

<p>to delete the larger part instead. Again using a standard serine residue as an example</p>

<p><pre>CHOP CB OG</pre></p>

<p>could be used to turn it into an alanine.</p>

<p><h3>6. Adding functional groups</h3>
</p>

<p>PRODRG can also be used to add new atoms to existing molecules using the command</p>

<p><pre>BUILD &lt;atomname> &lt;fragmentname></pre></p>

<p>which attaches a new 'fragment' to the specified atom. Examples of fragments are <code>ME</code> for a methyl group, <code>OH</code> for a hydroxyl group or <code>PHI</code> to add a phenyl. A complete list of fragments can be found <a href="cprodrg_fragments.html">here</a>. If the addition of a new group creates a chiral centre at the attachment point, its chirality can be changed by prefixing the atom name with a tilde character (<code>~</code>).</p>

<p>Some default fragments have two attachment points, e.g. the <code>2-EPOXY</code> fragment used to introduce an epoxy bridge between two atoms or the <code>CONECT</code> fragment that does not actually add anything but simply connects two existing atoms. For these fragments, the second attachment point must be specified after the fragment name, i.e.</p>

<p><pre>BUILD &lt;atomname1> &lt;fragmentname> &lt;atomname2></pre></p>

<p><h3>7. Renaming the molecule</h3>
</p>

<p>You can change the residue name with the command</p>

<p><pre>CPNAME &lt;newname></pre></p>

<p>This can be used to avoid the default 'DRG' when creating compounds from scratch or to update the name to something more appropriate during building.</p>


<h2><a name="Sreference">REFERENCE</a></h2>
<p>A. W. Schuettelkopf and D. M. F. van Aalten (2004). PRODRG &ndash; a tool for high-throughput crystallography of protein-ligand complexes. <i>Acta Crystallogr</i> D60, 1355&ndash;1363.</p>


<h2><a name="Sauthor">AUTHOR</a></h2>
<p>Alexander W. Schuettelkopf and Daan M. F. van Aalten, Division of Molecular Microbiology, College of Life Sciences, University of Dundee</p>


<h2><a name="Sexamples">EXAMPLES</a></h2>
<p><h3>Generating a topology for an existing ligand</h3>
</p>

<p><pre>cprodrg XYZIN ligand.pdb XYZOUT ligand_use.pdb LIBOUT ligand_use.cif &lt;&lt;EOF
END
EOF</pre></p>

<p><h3>Toplogy and coordinates from scratch for a simple molecule (propanol in this case)</h3>
</p>

<p><pre>echo C-C-C-O > temp.draw
cprodrg XYZIN temp.draw XYZOUT ligand_use.pdb LIBOUT ligand_use.cif &lt;&lt;EOF
MINI YES
EOF
rm temp.draw</pre></p>

<p><h3>Creating aminolysine from lysine (provided in lys.pdb)</h3>
</p>

<p><pre>echo BUILD NZ ME >> lys.pdb
echo CPNAME MLY >> lys.pdb
cprodrg XYZIN lys.pdb XYZOUT mly.pdb LIBOUT mly.cif &lt;&lt;EOF
END
EOF</pre></p>

<p><h3>Generating 2D coordinates in MDL Molfile format (for plotting) from a given PDB file</h3>
</p>

<p><pre>cprodrg XYZIN ligand.pdb XYZOUT plotme.mol LIBOUT /dev/null &lt;&lt;EOF
COOR MOL
PROT NONE
MINI FLAT
END
EOF</pre></p>

</body>
</html>
