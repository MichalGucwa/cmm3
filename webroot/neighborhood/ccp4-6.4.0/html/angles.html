<html>
<head><title>CCP4 Program Suite: angles</title></head>
<body>

<!-- ::INDEX_INFO::ANGLES::Unsupported::::bond lengths, bond angles and dihedral angles from coordinate files::unsupported:::::: -->

<H1> ANGLES (CCP4: Unsupported Program)</H1>
<H2> NAME</H2>
<b>angles </b>
- bond lengths, bond angles and dihedral angles from coordinate files
<H2> SYNOPSIS </H2>
<b>angles XYZIN</b>
<i>foo_in.pdb</i>
<b>ANGDAT</b>
<i>foo_in.prt</i>
<b>ANGOUT</b>
<i>foo_out.ang</i>
<b>PLOT</b>
<i>foo_out.plt</i>
<br>
 [Input cards]

<H2><a name="description">DESCRIPTION</a></H2>

This program computes bond lengths, bond angles and most usefully
dihedral angles for proteins or other molecules. A Ramachandran plot may also
be produced.
<p>
Warning! At present, the program will give incorrect angles across breaks
in the chain.

<H2><a name="files">INPUT AND OUTPUT FILES</a></H2>

<H3> Input</H3>
<dl>
<dt> XYZIN<dd>
Input coordinates, Brookhaven PDB format.
<dt> ANGDAT<dd>
Library file (defaults to standard protein version $CLIBD/angldat.prt ).
</dl>

<H3> Output</H3>
<dl>
<dt> ANGOUT<dd>
Angles, only written if keyword DIHEdral is present.
<dt> PLOT<dd>
Ramachandran plot file, default extension .PLT
</dl>


<H2><a name="keywords">KEYWORDED INPUT</a></H2>

All commands are introduced by keywords, with free format numbers.
Only the first 4 characters of the keyword are used, and all are optional.


<H3>TITLe &lt;title&gt;</H3>
Title for plot.

<H3>NODI</H3>
Do not calculate dihedral angles (default: do).

<H3>DIHEdral</H3>
Write calculated dihedral angles to a file with logical name ANGOUT
(default: write only to log file).

<H3>ALLOed [NEW|OLD]</H3>
Either the new or old allowed regions of the Ramachandran plot
will be marked. The default is the new region.

<H3>NOPLot</H3>
Do not draw Ramachandran plot (default do).

<H3>LABEL &lt;subkeywords&gt; </H3>
Labelling options for Ramachandran plot. Possible subkeywords:
<dl>
<dt>NOGLycine  <dd>Label all residues with positive phi which are not Gly (default).
<dt>POSItive  <dd>Label all positive phi.
<dt>ALL   <dd>Label all residues.
<dt>NONE   <dd>Label none.
<dt>NUMBer  <dd>Number all residues.
</dl>

<H3>NOTItle</H3>
No labels or text on plot. This may useful for publication plots.

<H3>CHAIn  &lt;IDCH&gt;</H3>
Select all residues in chain with chain label IDCH (1 character).
Default, select all residues or see RESIdue commmand.

<H3>RESIdue  &lt;R1&gt; &lt;R2&gt;</H3>
Select all residues between residue R1 and R2 inclusive.
Default, select all residues or see CHAIn commmand.
&lt;R1&gt;, &lt;R2&gt; are residue names which may be numbers, 
or a 3-digit number  + 1-character chain identifier.

<H3>BOND  &lt;ERRL&gt;</H3>
Compute bond lengths (default if absent, do not compute bond lengths).
&lt;ERRL&gt;  list bonds whose fractional error is greater than &lt;ERRL&gt;
(if ideal bond lengths are given).

<H3>ANGLe &lt;ERRA&gt;</H3>
Compute bond angles (default if absent, do not compute bond angles).
&lt;ERRA&gt; list angles whose fractional error is greater than &lt;ERRA&gt;
(if ideal bond angles are given).

<H2> Library file (ANGDAT)</H2>

This file contains the definition of lengths and angles to be calculated.
It consists of four parts.

<ol>
<li>Three lines defining the three atoms from one residue to be
carried over to the next for calculation of main-chain angles (for
proteins these three would be N,CA,C). Each line consists of the name
of the atom followed by a name representing that atom in the earlier
residue in format 2A4, e.g. "N .N " means that atom ".N " represents atom "N "
in the previous residue. The following specifications can use any atom
names that may appear in the coordinate file, plus these three extra
names.
<p>
<li>Number of bond lengths, followed on separate lines by pairs of atom 
names (2A4) defining bond lengths, with an optional ideal distance (F10.5).
<p>
<li>Number of bond angles, followed on separate lines by groups of three 
atom names (3A4) defining bond angles, with an optional ideal angle (F10.5).
<p>
<li>Number of dihedral angles, followed on separate lines by groups of 
four atom names defining dihedral angles together with the angle name (5A4). 
For proteins, the first two should be "PHI " and "PSI " for the Ramachandran plot.
</ol>


<H2>  EXAMPLES</H2>

<H3>Unix example script found in $CEXAM/unix/runnable/</H3>
    <li><a href="../examples/unix/runnable/angles.exam">angles.exam</a>

<H2> SEE ALSO</H2>
 <A HREF=distang.html>DISTANG</A>,
 PROCHECK

</BODY>
</HTML>
